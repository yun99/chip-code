var e=Object.create,t=Object.defineProperty,o=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,n=Object.prototype.hasOwnProperty,u=e=>t(e,"__esModule",{value:!0}),a=a=>((e,i,u)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let a of r(i))n.call(e,a)||"default"===a||t(e,a,{get:()=>i[a],enumerable:!(u=o(i,a))||u.enumerable});return e})(u(t(null!=a?e(i(a)):{},"default",a&&a.__esModule&&"default"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a),l=(e,t,o)=>new Promise(((r,i)=>{var n=e=>{try{a(o.next(e))}catch(e){i(e)}},u=e=>{try{a(o.throw(e))}catch(e){i(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,u);a((o=o.apply(e,t)).next())}));((e,o)=>{for(var r in u(e),o)t(e,r,{get:o[r],enumerable:!0})})(exports,{default:()=>f});var s=a(require("./ao.js")),c=a(require("./iy.js")),p=a(require("./u8.js")),m=a(require("./u9.js")),d=a(require("./ug.js")),y=a(require("./gg.js")),f={getLocationPromise:()=>new Promise((e=>l(void 0,null,(function*(){var t;const{longitude:o,latitude:r}=(null==(t=c.default.appShowOptions)?void 0:t.query)||{};let i={longitude:o,latitude:r};if(!r||!o)try{const e=(0,d.buildStartPoint)();(yield m.default.getLocationAuth())?(i=yield l(void 0,null,(function*(){return(0,p.isMT)()?new Promise(((e,t)=>{l(void 0,null,(function*(){const t="TIME_OUT",o=[];o.push(new Promise((e=>{setTimeout(e,7e3,t)}))),o.push(m.default.onGetLocationCache());const r=yield Promise.race(o);r!==t?e(r):(c.default.multiPoiModal.showInnerPoiModal({code:s.PoiLocationErrorType.LOCATION_ACCESS_INVALID_MT_TIMEOUT,error:null}),(0,y.poiMainCatReport)(y.PoiFirstTarget.LOCATION_TIMEOUT),(0,y.poiLogger)("门店请求超时"))}))})):m.default.onGetLocationCache()})),e("userLocation"),(0,y.poiLogger)("beforeRequestPoi->onGetLocationCache:ok",`location:${JSON.stringify(i)}`)):(0,y.poiLogger)("beforeRequestPoi 获取定位失败：用户未设置过定位")}catch(t){(0,y.poiLogger)("beforeRequestPoi 获取定位失败：",t),e(t)}e(i)}))))};