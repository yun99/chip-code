var e=Object.create,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,i=Object.getPrototypeOf,n=Object.prototype.hasOwnProperty,o=e=>t(e,"__esModule",{value:!0}),s=s=>((e,i,o)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of a(i))n.call(e,s)||"default"===s||t(e,s,{get:()=>i[s],enumerable:!(o=r(i,s))||o.enumerable});return e})(o(t(null!=s?e(i(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);((e,r)=>{for(var a in o(e),r)t(e,a,{get:r[a],enumerable:!0})})(exports,{TAG_METRICS:()=>d,buildProportion:()=>I,buildStartPoint:()=>S,checkErrorAppShowError:()=>w,clearLaunch2SkuLVCStartTime:()=>M,customReport:()=>v,forceLVCStop:()=>E,forceStop:()=>L,getAppStartTime:()=>D,launchAppStartTime4Sku:()=>g,lvcReport:()=>b,performanceMap:()=>T,reportIndicator:()=>y,reportSize:()=>N,resetPerformce:()=>R,tagCustomTime:()=>f,tagNewStartTime:()=>c,tagTime:()=>A,testStartPoint:()=>O,triggerLVC:()=>P,triggerSkuLVC:()=>U});var p=s(require("./up.js")),l=s(require("./ob.js")),m=Date.now();function c(){Date.now(),0}var u={appLaunch:{init:!1,startTime:NaN},evaluteScript:{init:!1,startTime:NaN},firstWebviewInited:{init:!1,startTime:NaN},evaleteScriptDone:{startTime:NaN},firstRenderDone:{startTime:NaN}};if(wx.canIUse("getPerformance")&&"function"==typeof wx.getPerformance){const e=wx.getPerformance().createObserver((t=>{t.getEntries().forEach((t=>{if("appLaunch"===t.name&&"appLaunch"===t.navigationType&&"navigation"===t.entryType&&"pages/index/index"===t.path&&(u.appLaunch.startTime=t.startTime,u.appLaunch.init=!0),"evaluateScript"===t.name&&"script"===t.entryType&&(u.evaluteScript.startTime=t.startTime,u.evaluteScript.init=!0,u.evaleteScriptDone.startTime=t.startTime+t.duration),"firstRender"===t.name&&"pages/index/index"===t.path&&(u.firstWebviewInited.startTime=t.startTime,u.firstRenderDone.startTime=t.startTime+t.duration,u.firstWebviewInited.init=!0),u.firstWebviewInited.init&&u.evaluteScript.init&&u.appLaunch.init){e.disconnect();try{u.firstWebviewInited.init&&u.evaluteScript.init&&u.appLaunch.init&&(null==(r=p.metrics)||r.addPoint({pageName:"global",key:"t1_main",step:"PAIN_PERFORMANCE",duration:m-u.appLaunch.startTime}),null==(a=p.metrics)||a.addPoint({pageName:"global",key:"prehistoric_stage",step:"PAIN_PERFORMANCE",duration:u.evaluteScript.startTime-u.appLaunch.startTime}),null==(i=p.metrics)||i.addPoint({pageName:"global",key:"pre_implement_stage",step:"PAIN_PERFORMANCE",duration:m-u.evaluteScript.startTime}),null==(n=p.metrics)||n.addPoint({pageName:"global",key:"implement_stage",step:"PAIN_PERFORMANCE",duration:u.evaleteScriptDone.startTime-m}),null==(o=p.metrics)||o.addPoint({pageName:"global",key:"idle_stage",step:"PAIN_PERFORMANCE",duration:u.firstWebviewInited.startTime-u.evaleteScriptDone.startTime}),null==(s=p.metrics)||s.addPoint({pageName:"global",key:"first_render_stage",step:"PAIN_PERFORMANCE",duration:u.firstRenderDone.startTime-u.firstWebviewInited.startTime}))}catch(e){l.log.error(`[performance observer - offense]:${getApp().$version} 错误信息：${e.message}`)}}var r,a,i,n,o,s}))}));e.observe({entryTypes:["navigation","render","script"]})}var d,_,g=Date.now(),T={main:{},stage:{},proportion:{},size:{},custom:{},confirmHasStatus:0,metricIsDone:!1,isReadyDone:!1,onAppShowed:!1},D=()=>m,f=(e="")=>{},A=(e="",t=!1)=>{var r;if(T.metricIsDone)return;const a=Date.now()-m;t&&l.log.error(`[indicator - main]: ${e} 经过${a}ms`),T.main[e]=a,null==(r=p.metrics)||r.addPoint({pageName:"global",key:"main",step:e,duration:a})},N=(e,t)=>{var r;T.size[e]||(T.size[e]=t,null==(r=p.metrics)||r.addPoint({pageName:"global",key:"size",step:e,duration:t}))},S=(e=Date.now(),t="")=>{const r=m;return(a="",i)=>{var n;if(m!==r)return;if(T.metricIsDone)return;const o=Date.now()-e;i&&l.log.error(`[indicator - stage]:${getApp().$version} ${a} 花费${o}ms ${t}`),T.stage[a]=o,null==(n=p.metrics)||n.addPoint({pageName:"global",key:"stage",step:a,duration:o})}},v=(e,t,r)=>{var a;T.custom[`${e}-${t}`]=r,null==(a=p.metrics)||a.addPoint({pageName:"global",key:e,step:t,duration:r})},O=(e=Date.now(),t="")=>{const r=m;return(a="",i)=>{var n;if(m!==r)return;const o=Date.now()-e;i&&l.log.error(`[indicator - stage]:${getApp().$version} ${a} 花费${o}ms ${t}`),T.stage[a]=o,null==(n=p.metrics)||n.addPoint({pageName:"global",key:"stage",step:a,duration:o})}},I=(e="")=>{var t;return T.metricIsDone?()=>{}:(T.proportion[e]||(T.proportion[e]={total:0}),T.proportion[e].total++,null==(t=p.metrics)||t.addRate({url:e,key:"total"}),(t="")=>{var r;T.proportion[e][t]=T.proportion[e][t]?T.proportion[e][t]+1:1,null==(r=p.metrics)||r.addRate({url:e,key:t})})},L=()=>{T.metricIsDone=!0,l.log.warn(`[indicator] 用户本次渲染指标信息：${JSON.stringify(T)}`)},E=()=>{},y=()=>{},R=e=>{if(!e)return;m=e,T.main={},T.stage={},T.size={},T.custom={};const{proportion:t}=T;T.proportion={};for(const e of Object.keys(t))T.proportion[e]={total:0};T.metricIsDone=!1},b=()=>{},P=e=>{},w=()=>{T.onAppShowed&&L(),T.onAppShowed=!0};(_=d||(d={})).SKU_DETAIL_FROM_LAUNCH_INDEX="SKU_DETAIL_FROM_LAUNCH_INDEX",_.SKU_DETAIL_FROM_LAUNCH_SKU="SKU_DETAIL_FROM_LAUNCH_SKU",_.SKU_DETAIL_FROM_LAUNCH="SKU_DETAIL_FROM_LAUNCH",_.SKU_DETAIL_FROM_INDEX="SKU_DETAIL_FROM_INDEX",_.SKU_DETAIL_FROM_LOAD="SKU_DETAIL_FROM_LOAD",_.SKU_DETAIL_FROM_INDEX_TO_PRELOAD="SKU_DETAIL_FROM_INDEX_TO_PRELOAD",_.SKU_DETAIL_FROM_INDEX_TO_TOTALLOAD="SKU_DETAIL_FROM_INDEX_TO_TOTALLOAD";var U=(e,t,r)=>{},M=()=>{g=null};