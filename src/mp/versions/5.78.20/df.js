var t=Object.create,e=Object.defineProperty,s=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,a=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,l=t=>e(t,"__esModule",{value:!0});((t,s)=>{for(var r in l(t),s)e(t,r,{get:s[r],enumerable:!0})})(exports,{default:()=>c});var o,n=(o=require("./j9.js"),((t,a,l)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let o of r(a))i.call(t,o)||"default"===o||e(t,o,{get:()=>a[o],enumerable:!(l=s(a,o))||l.enumerable});return t})(l(e(null!=o?t(a(o)):{},"default",o&&o.__esModule&&"default"in o?{get:()=>o.default,enumerable:!0}:{value:o,enumerable:!0})),o)),c=class{constructor(t){this.cfgManager=t,this.tags={},this.kvs={}}setTags(t){this.tags=Object.assign(this.tags,t)}getTags(t){return t?this.tags[t]:this.tags}clearTags(){this.tags={}}setMetric(t,e){"string"==typeof t&&"number"==typeof e&&(this.kvs[t]||(this.kvs[t]=[]),this.kvs[t].push(e))}getMetric(t){return t?this.kvs[t]:this.kvs}clearMetric(){this.kvs={}}_rollbackTags(t){this.tags=t||{}}_rollbackMetric(t){for(let e in t)t.hasOwnProperty(e)&&(this.kvs[e]=t[e].concat(this.kvs[e]||[]))}report(){try{if(!this.kvs||0===Object.keys(this.kvs).length)return;let t=this.tags,e={kvs:this.kvs,tags:this.tags,ts:parseInt(+new Date/1e3)};this.clearTags(),this.clearMetric();const s=this.cfgManager;let r=s.getApiPath("metric");(0,n.requestQueue)({url:`${r}&p=${s.get("project")}`,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:"data="+encodeURIComponent(JSON.stringify(e)),fail:()=>{this._rollbackTags(t)}})}catch(t){}}};