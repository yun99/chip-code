var e=Object.create,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,o=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,a=e=>t(e,"__esModule",{value:!0}),l=l=>((e,o,a)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let l of n(o))u.call(e,l)||"default"===l||t(e,l,{get:()=>o[l],enumerable:!(a=r(o,l))||a.enumerable});return e})(a(t(null!=l?e(o(l)):{},"default",l&&l.__esModule&&"default"in l?{get:()=>l.default,enumerable:!0}:{value:l,enumerable:!0})),l);((e,r)=>{for(var n in a(e),r)t(e,n,{get:r[n],enumerable:!0})})(exports,{default:()=>p});var s=l(require("./39.js")),i=l(require("./ob.js")),c=l(require("./vw.js")),m=l(require("./ma.js")),p=class extends s.default{constructor(e){super(e),this.use=e=>{return t=this,r=null,n=function*(){const t=getApp(),r=this.uriHandler.name;if(t&&t.$login){if(t.$login.isLogin()){const n=t.$login.userModule.getUserInfo();return i.log.info(c.MOUDULE_NAME,"已登录",n),e.setExtraInfo({uriHandlerName:r,interceptorName:this.name,info:n}),e}const n=e.getUri().getQuery();n.from="router",i.log.info(c.MOUDULE_NAME,"没登录，前去登陆：",e.getUri());const o=yield t.$login.login(n);if(o)return i.log.info(c.MOUDULE_NAME,"登陆后 info:",o),e.setExtraInfo({uriHandlerName:r,interceptorName:this.name,info:o}),yield(0,m.wait)(500),e;throw i.log.info(c.MOUDULE_NAME,"用户取消登录",o),new Error("用户取消登录")}return e},new Promise(((e,o)=>{var u=e=>{try{l(n.next(e))}catch(e){o(e)}},a=e=>{try{l(n.throw(e))}catch(e){o(e)}},l=t=>t.done?e(t.value):Promise.resolve(t.value).then(u,a);l((n=n.apply(t,r)).next())}));var t,r,n},this.name="LoginInterceptor"}};