var t=Object.create,e=Object.defineProperty,a=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,r=Object.getPrototypeOf,n=Object.prototype.hasOwnProperty,s=s=>{return((t,r,s)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let i of o(r))n.call(t,i)||"default"===i||e(t,i,{get:()=>r[i],enumerable:!(s=a(r,i))||s.enumerable});return t})((i=e(null!=s?t(r(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0}),e(i,"__esModule",{value:!0})),s);var i},i=s(require("./la.js")),u=s(require("./zj.js")),p=s(require("./lb.js")),c=getApp();Component(new class{constructor(){this.attached=function(){this.cart=c.page().selectComponent("#cart"),this.setData({nodeId:this.__wxExparserNodeId__||String(this.__$id)})},this.methods={onHeapClick(){var t;if(i.default.onSkuHeapClick((null==(t=this.data.skuHeap)?void 0:t.jumpUrlDesc)||"",this.data.skuHeap.promotionType),!this.data.skuHeap.jumpUrl)return;const e=(0,u.removePromotionName)(this.data.skuHeap.jumpUrl,!0),a=Object.keys(p.PromotionKind).find((t=>~e.indexOf(t)));a?this.onCheapBuyPopupShow({detail:{target:a}}):c.$router.goto(e)},onSkuCountChange(t){var e;if(this.cart||(this.cart=c.page().selectComponent("#cart")),!this.cart.canOperateCart())return;const{skuId:a,delType:o}=(null==(e=null==t?void 0:t.currentTarget)?void 0:e.dataset)||{},{type:r,count:n}=(null==t?void 0:t.detail)||{},s={add:"INCREASE",subtract:"DECREASE",delete:"DELETE"};if("subtract"===r&&1===n||o)i.default.deletePopupShow(),c.page().confirm({message:"确定要删除该商品吗？",textCancel:"再想想",textOK:"删除",zIndex:1510,ok:()=>{i.default.deleteConfirm(),this.triggerEvent("skuStatusChange",{cartOpType:s[r]||s[o],opTarget:{opTargets:[{skuId:a,promotionId:this.data.skuHeap.promotionId,promotionType:this.data.skuHeap.promotionType}]}})},cancel:()=>{i.default.deleteCancel()}});else{const t={bid:"add"===r?"b_youxuan_u6mw9i0v_mc":"b_youxuan_kwwwhgxo_mc",valLab:{sku_id:a}};this.triggerEvent("skuStatusChange",{cartOpType:s[r],opTarget:{opTargets:[{skuId:a,promotionId:this.data.skuHeap.promotionId,promotionType:this.data.skuHeap.promotionType}]},lxData:t})}},onSkuSelectClick(t){var e;if(this.cart||(this.cart=c.page().selectComponent("#cart")),!this.cart.canOperateCart())return;const{skuId:a,selected:o}=(null==(e=null==t?void 0:t.target)?void 0:e.dataset)||{};if(void 0===a||void 0===o)return Promise.reject(`选中商品id为空，或者选中值为空，skuId：${a}，selected：${o}`);this.triggerEvent("skuStatusChange",{cartOpType:o?"INVERT":"SELECT",opTarget:{opTargets:[{skuId:a,promotionId:this.data.skuHeap.promotionId,promotionType:this.data.skuHeap.promotionType}]}})},onSkuTouchStart(t){this.triggerEvent("onSkuTouchStart",t.detail)},onSkuTouchEnd(t){this.triggerEvent("onSkuTouchEnd",t.detail)},onCheapBuyPopupShow(t){var e,a;this.cart||(this.cart=c.page().selectComponent("#cart")),this.cart.canOperateCart()&&this.triggerEvent("cheapBuyPopupShow",{promotionId:(null==(e=this.data.skuHeap)?void 0:e.promotionId)||0,promotionType:(null==(a=this.data.skuHeap)?void 0:a.promotionType)||0,promotionHandel:t.detail.target})},toSkuDetail(t){const{skuId:e}=t.currentTarget.dataset;i.default.onNormalCardClick(e);const a={originalPoiId:c.$poiId,skuId:e},{trafficSource:o}=c.page().options;o&&(a.trafficSource=o),c.$router.goto("/pages/skuDetail/index",a)},onMvReport(){i.default.onSkuHeapShow(this.data.skuHeap.jumpUrlDesc||"",this.data.skuHeap.promotionType)},onSkuStatusChange(t){this.triggerEvent("skuStatusChange",t.detail)}},this.properties={skuHeap:{type:Object,value:{}},valid:{type:Boolean,value:!0},startTouch:Object,currentTouchNodeId:String,skuId:Number},this.data={isSelected:!1,fontRate:c.$cart.getCartFontRate()||1}}});