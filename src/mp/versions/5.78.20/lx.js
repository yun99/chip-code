var e=Object.create,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,a=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(e,r,s)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,n=(e,t)=>{for(var r in t||(t={}))u.call(t,r)&&o(e,r,t[r]);if(i)for(var r of i(t))l.call(t,r)&&o(e,r,t[r]);return e},m=e=>t(e,"__esModule",{value:!0}),c=i=>((e,i,a)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let l of s(i))u.call(e,l)||"default"===l||t(e,l,{get:()=>i[l],enumerable:!(a=r(i,l))||a.enumerable});return e})(m(t(null!=i?e(a(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);((e,r)=>{for(var s in m(e),r)t(e,s,{get:r[s],enumerable:!0})})(exports,{skuDataFormat:()=>T,skuListFormat:()=>E});var d=c(require("./ob.js")),O=c(require("./lz.js")),p=c(require("./kn.js"));function E(e,t,r="",s){const{type:i="",itemKey:a=""}=e;i||d.log.error(`/guessLikeWrapper/utils skuListFormat 榜单类型异常; ${JSON.stringify(e)}`);let u=!1,l=!1,o={itemList:[],moduleTitle:"",subModuleTitle:"",jumperVO:{text:"",iretail:""},rightJumperVO:{text:"",iretail:""},extraParams:{}};switch(i){case O.BOARDENUMTYPES.CBOARD:{const{cboardVO:t={}}=e;if(!Object.keys(t).length)return d.log.warn(`/guessLikeWrapper/utils 榜单数据异常, 请确认 cboardVO 属性是否存在; 异常榜单数据${JSON.stringify(e)}`),o;o.itemList=t.cboardTabVO&&t.cboardTabVO.skuItems||[],o.moduleTitle=t.cboardName&&t.cboardName.text||O.SKU_BOARD_TYPE_MAP[i].defTitle||"",o.subModuleTitle=t.cboardDesc&&t.cboardDesc.text||O.SKU_BOARD_TYPE_MAP[i].defSubTitle||"",o.jumperVO=t.jumpUrl||{},o.rightJumperVO=t.rightJumperVO||{},o.extraParams={list_id:t.boardType||"-999",list_name:o.moduleTitle||"-999"},delete t.cboardTabVO,delete t.cboardName,delete t.cboardDesc,delete t.jumpUrl,o=n(n({},o),t);break}case O.BOARDENUMTYPES.OFTENBUY:case O.BOARDENUMTYPES.SUBJECT:case O.BOARDENUMTYPES.SALEPROMOTION:case O.BOARDENUMTYPES.CMARKET:case O.BOARDENUMTYPES.STANDARDDEPARTMENT:case O.BOARDENUMTYPES.SPECIAL:case O.BOARDENUMTYPES.INSEASON:case O.BOARDENUMTYPES.NETHOTCOLUM:case O.BOARDENUMTYPES.BRAND:case O.BOARDENUMTYPES.HORIZONTALSCROLLCARD:case O.BOARDENUMTYPES.LIVE:case O.BOARDENUMTYPES.RECOMMEND_SIMILAR:if(O.SKU_BOARD_TYPE_MAP[i]){const t=O.SKU_BOARD_TYPE_MAP[i],r=e[t.key];if(!r)return d.log.warn(`/guessLikeWrapper/utils 未匹配到 key, type 匹配不正确, 请确认类型是否存在; 异常榜单数据${JSON.stringify(e)}`),o;o.itemList=r.itemList||[],o.moduleTitle=r.moduleTitle&&r.moduleTitle.text||t.defTitle||"",o.subModuleTitle=r.sndModuleTitle&&r.sndModuleTitle.text||t.defSubTitle||"",o.jumperVO=r.jumperVO||{},o.rightJumperVO=r.rightJumperVO||{},o.extraParams=function(e,t){if(t===O.BOARDENUMTYPES.SUBJECT)return{subject_id:e.bannerId||"-999",subject_name:e.moduleTitle.text||""};if(t===O.BOARDENUMTYPES.SALEPROMOTION)return{activity_type:e.promotionId||""};if(t===O.BOARDENUMTYPES.CMARKET)return{market_name:e.sceneType||""};if(t===O.BOARDENUMTYPES.LIVE)return{live_id:e.liveId||""};if(t===O.BOARDENUMTYPES.BRAND)return{brand_id:e.brandId||"",brand_name:e.brandName||""};if(t===O.BOARDENUMTYPES.RECOMMEND_SIMILAR)return{origin_sku_id:e.topSkuId||"",category_id:e.categoryId||""};return{}}(r,i),delete r.itemList,delete r.moduleTitle,delete r.sndModuleTitle,delete r.jumperVO,o=n(n({},o),r)}}return i===O.BOARDENUMTYPES.RECOMMEND_SIMILAR?(u=!1,l=!0):s&&"b"===s?o.itemList=o.itemList.slice(0,4):(u=!0,l=!0),(0,p.skuListParser)(o.itemList||[],t),n({type:i,itemKey:a,requestid:r,isCustomPicClick:u,isScrollBoard:l},o)}function T(e){const{data:t=[],schemasMap:r=O.SKU_BOARD_TYPE_MAP,requestid:s="",strategy:i="b",renderedListLength:a=0}=e;if(!t||!t.length)return{};let u={},l=[];try{const e=t.length;for(let o=0;o<e;o++){let e=t[o],n={};if(r[e.type])n=r[e.type].schema;else{d.log.warn("/guessLikeWrapper/utils 未匹配到「卡片 schema」, 请确认类型是否存在");n=r[1].schema}1===e.type?((0,p.skuItemParser)(e.skuItem,n),e.skuItem.canRec=!0,e.skuItem.requestid=s,e.itemKey=`${e.skuItem.skuId}_${o}`,l.push(e.skuItem.skuId)):(delete e.skuItem,e.itemKey=`${e.type}_${a+o}`,e=E(e,n,s,i)),u[`list[${a+o}]`]=e}}catch(e){d.log.error("skuDataFormat",e),u={},l=[]}return{excludeSkuIds:l,skuList:u}}