var e=Object.create,t=Object.defineProperty,a=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,n=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,r=e=>t(e,"__esModule",{value:!0}),u=u=>((e,n,r)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let u of s(n))o.call(e,u)||"default"===u||t(e,u,{get:()=>n[u],enumerable:!(r=a(n,u))||r.enumerable});return e})(r(t(null!=u?e(n(u)):{},"default",u&&u.__esModule&&"default"in u?{get:()=>u.default,enumerable:!0}:{value:u,enumerable:!0})),u);((e,a)=>{for(var s in r(e),a)t(e,s,{get:a[s],enumerable:!0})})(exports,{default:()=>y});var l=u(require("./ob.js")),i=u(require("./jc.js")),c=u(require("./u8.js")),p=u(require("./25.js")),d=u(require("./26.js")),m=u(require("./lm.js")),h=getApp(),{convertPxToRpx:g}=require("./p0.js"),P=["pages/index/index","pages/categorySkuList/index","pages/cookbook/index","pages/cart/index","pages/userCenter/index"],y=class{constructor(){var e,t,a,s;this.created=function(){this.resetCommonData()},this.attached=function(){},this.detached=function(){},this.pageLifetimes={hide(){this.closeSpecModal()}},this.observers={showSkuPurchasePanel(e){var t;if(e){this.genTempCartId();const e=null==(t=getCurrentPages().pop())?void 0:t.__route__;-1===P.indexOf(e)||(0,c.isWXMT)()||this.setData({isShowIpxBar:!1})}}},this.methods={popupSkuPurchasePanel(e){return t=this,a=null,s=function*(){try{this.initCommonData(e),this.skuPurchasePanelLxReport=new d.default(this),this.handle=new p.default(this,e.panelType),this.genTempCartId(),yield this.handle.initSkuPurchasePanelData(e.requestParams),this.changeSkuPurchasePanelDisplayStatus(e.popupStatus)}catch(t){l.log.warn(`<skuPurchasePanel popupSkuPurchasePanel> 打开商品购买编辑面板错误 面板类型为：${e.panelType}，打开参数为${JSON.stringify(e)}，error为：${t.message}`)}},new Promise(((e,n)=>{var o=e=>{try{u(s.next(e))}catch(e){n(e)}},r=e=>{try{u(s.throw(e))}catch(e){n(e)}},u=t=>t.done?e(t.value):Promise.resolve(t.value).then(o,r);u((s=s.apply(t,a)).next())}));var t,a,s},onSelectRadio(e){try{const{enabled:t,selected:a,attrId:s,value:n,groupIndex:o,ratioIndex:r}=e.target.dataset;if(!t||1===this.commonData.productPattern)return;this.skuPurchasePanelLxReport.onSelectRadio(n),this.handle.onSelectRadio({selected:a,attrId:s,value:n,groupIndex:o,ratioIndex:r})}catch(e){l.log.warn(`<skuPurchasePanel onSelectRadio> 切换规格错误，error为：${e.message}`)}},onChangeSkuCount(e){try{const{available:t}=e.currentTarget.dataset;if(this.data.isSpuCard||!t)return;this.handle.onChangeSkuCount(e),this.skuPurchasePanelLxReport.onChangeCountClick()}catch(e){l.log.warn(`<skuPurchasePanel onChangeSkuCount> 修改商品加车数量错误，error为：${e.message}`)}},onTapOperatorButton(e){try{const{enable:t,status:a,text:s=""}=e.currentTarget.dataset;if(!t)return;this.skuPurchasePanelLxReport.onTapOperatorButton(a,s),this.handle.onTapOperatorButton(e)}catch(e){l.log.warn(`<skuPurchasePanel onTapOperatorButton> 点击交互按钮错误，error为：${e.message}`)}},closeSpecModal(e){var t,a;try{null==(t=this.skuPurchasePanelLxReport)||t.onCloseClick(),null==(a=this.handle)||a.closeSpecModal()}catch(e){l.log.warn(`<skuPurchasePanel closeSpecModal> 关闭购买面板错误，error为：${e.message}`)}},onAddToCartCompletely(){this.handle.onAddToCartCompletely()},prevents(){},initCommonData(e){var t;this.commonData.originalOptions=e,this.commonData.moduleLxBids=e.moduleLxBids,this.commonData.moduleLxParams=e.moduleLxParams||{},this.commonData.selectedSkuId=e.requestParams.skuId,this.commonData.productPattern=(null==(t=e.requestParams)?void 0:t.productPattern)||1},genTempCartId(){var e;this.commonData.tempCartId=`${(null==(e=h.$user)?void 0:e.userId)||""}_${Date.now()}`},changeSkuPurchasePanelDisplayStatus(e){this.setData({showSkuPurchasePanel:e})},resetCommonData(){this.commonData={buyStep:null,maxNum:null,minNum:null,originalOptions:null,tempCartId:"",selectedSkuId:null,productId:null,moduleLxBids:null,moduleLxParams:null}}},this.properties={},this.data={selectedSkuSpecList:[],isIpx:null==(t=null==(e=h.getModule("systemInfo"))?void 0:e.getSystemInfo())?void 0:t.isIpx,specCountContainerMaxHeight:g(.9*h.$systemInfo.systemInfo.windowHeight)-((null==(s=null==(a=h.getModule("systemInfo"))?void 0:a.getSystemInfo())?void 0:s.isIpx)?406:338),showSkuPurchasePanel:!1,operatorButtonStyle:"",operatorButton:null,spuData:{},isSpuCard:!1,currentSku:{},currentSkuCount:null,currentSkuSchema:(0,m.default)({cardClass:"w_640 h_224 pb_24 bg_fff",cardInfoClass:"ml_20",imgClass:"w_200 h_200 br_8 border_2 bc_EEEEEE flex-no-shrink",promotionTime:"f_22",promotionTag:"f_20 h_l_20",promotionPrice:"f_30 h_l_30",promotionTagClass:"f_16 lh_20 wp_64",needAnimation:!1,topLeftTagHiddenTypes:[1],hiddenNodes:["sku-button","sale-info","seckill-rate"],hiddenNodesBySlug:["recReason"],enbaleBigFont:!1}),skuSpecRadioGroups:[],subTractCountAvailable:!0,addCountAvailable:!0,isShowIpxBar:!0}}};(0,i.defineComponent)(new y);