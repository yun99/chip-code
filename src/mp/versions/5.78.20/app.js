var e=Object.create,t=Object.defineProperty,s=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,o=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,r=r=>{return((e,o,r)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let a of i(o))u.call(e,a)||"default"===a||t(e,a,{get:()=>o[a],enumerable:!(r=s(o,a))||r.enumerable});return e})((a=t(null!=r?e(o(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0}),t(a,"__esModule",{value:!0})),r);var a},a=r(require("./ui.js")),n=(r(require("./uo.js")),r(require("./ua.js"))),l=r(require("./up.js")),d=r(require("./us.js")),p=r(require("./uf.js")),m=(r(require("./ud.js")),r(require("./uk.js"))),c=r(require("./ul.js")),g=r(require("./uh.js")),h=r(require("./ug.js")),y=r(require("./uj.js")),$=r(require("./ux.js")),f=r(require("./uc.js")),x=r(require("./uz.js")),P=r(require("./u1.js")),v=(r(require("./ub.js")),r(require("./uv.js"))),I=r(require("./u2.js")),D=r(require("./un.js")),S=r(require("./um.js")),U=(r(require("./u3.js")),r(require("./u4.js"))),M=r(require("./iw.js")),w=r(require("./u5.js")),T=r(require("./u6.js")),L=r(require("./iq.js")),b=r(require("./u9.js")),E=r(require("./u8.js")),_=r(require("./u7.js")),q=r(require("./ir.js")),C=r(require("./iy.js")),R=r(require("./ie.js")),A=r(require("./u0.js")),O=r(require("./it.js")),j=r(require("./iu.js")),N=r(require("./ip.js")),k=r(require("./ii.js")),F=r(require("./is.js")),H=r(require("./io.js")),X=r(require("./id.js")),G=(r(require("./if.js")),r(require("./ig.js")),r(require("./ia.js"))),{AppShowOptions:V}=require("./ih.js"),W=n.default.appLifeCycleInterceptor();(0,v.startLogger)(),setTimeout((()=>{(0,R.init)({show:!0,interval:5,limit:6,level:R.LogLevel.normal,compShow:""})})),(0,l.app)(W({$store:g.default,$service:$.default,$requestLimit:9,$requestList:[],$poiDisTance:void 0,$get:P.get,$post:P.post,$config:x.default,$getAppStartTime:h.getAppStartTime,$tagTime:h.tagTime,$tagNewStartTime:h.tagNewStartTime,$buildStartPoint:h.buildStartPoint,$testStartPoint:h.testStartPoint,$buildProportion:h.buildProportion,$uuid:null,$user:null,$location:null,$poiId:null,$cityId:null,$scene:null,$sceneCode:null,$subChannel:null,$liveRoomNum:null,$live_id:null,$live_from:null,$live_status:null,$wx_from_live:null,$globalLXParams:null,$loginPromise:null,$updateAuthPromise:null,login:null,owl:null,lx:n.default,$event:U.default,lastShowPage:"",lastPagesLength:1,globalData:{jsguardInstance:null,yodaUrl:f.yodaDomain,yodaVerificationLock:!1},onLaunch(e={}){var t,s,i;try{(0,h.tagTime)("onLaunchStart");const i=(0,h.buildStartPoint)();this.$version="5.78.20",w.default.$version="5.78.20",v.log.warn(I.METRICS_PRE,"「小程序启动 onLaunch」",`「当前版本为：小程序v${this.$version} 」`,`时间：${new Date}`,`options： ${JSON.stringify(e)}`),p.default.init({appName:"meituanyouxuan_dyapp",appId:"tt48f03e4dd7c81b7d01",lx:n.default}),this.isHidden=!1,this.$scene=e&&e.scene||null,w.default.$scene=e&&e.scene||null,this.$appTag="youxuan",this.$module=M.default,this.$env=M.default.getModule("env"),this.$isProd=this.isProd(),w.default.$isProd=this.isProd(),this.$isLxProd=this.isLxProd(),w.default.$isLxProd=this.isLxProd(),this.$router=M.default.getModule("router"),this.$login=M.default.getModule("login"),this.$poi=M.default.getModule("poi"),this.$cat=M.default.getModule("cat"),this.$activity=M.default.getModule("activity"),this.$cart=M.default.getModule("cart"),this.$userModule=M.default.getModule("user"),this.$systemInfo=M.default.getModule("systemInfo"),this.$lxLog=M.default.getModule("lxLog"),this.$relation=M.default.getModule("relation"),this.$forceUpdate=M.default.getModule("forceUpdate"),this.$cat.setAppVersion(this.$version),this.$systemInfo.setSystemInfoSync(),this.genUUid(),this.$lxLog.setStore(g.default),this.$errorCode=M.default.getModule("errorCode"),this.$abTest=M.default.getModule("abTest"),this.$deviceGrade=M.default.getModule("deviceGrade");try{this.$cloud=void 0,(0,E.isWX)()}catch(e){this.$cat.reportError(j.CAT_SEC_CATEGORY.CLOUD_CONTAINER_INIT_FAIL(e))}this.$event.once(U.CONTANTS.FIRST_PAGE_READY,(()=>this.onFirstPageReady())),(0,v.setLoggerEnv)(null,this.$uuid,null,this.$uuid),n.default.init(f.lxUrl,{appnm:I.LX_APP_NAME,category:I.LX_CHANNEL,rtnm:I.LX_RTNM,app:this.$version}),(0,q.default)(),setTimeout((()=>{(0,L.setLxcuid)(n.default.get("lxcuid"))}),0),this.$isLxProd||null==(t=wx.setEnableDebug)||t.call(wx,{enableDebug:!0}),this.globalData.jsguardInstance=(0,O.initJsGuard)({appid:"tt48f03e4dd7c81b7d01",openid:M.default.getModule("user").getOpenId(),unionid:M.default.getModule("user").getUnionId(),mchid:"1399386702",ml:!0}),a.loginSdk.setAppConfig({request:null==(s=this.globalData.jsguardInstance)?void 0:s.request}),this.$login.setConfig({uuid:this.$uuid,isProd:this.$isProd,finger:Promise.resolve(this.globalData.jsguardInstance)}),this.$loginPromise=new Promise((e=>{setTimeout((()=>{v.log.info("[login]","开始时静默登录 tryLogin"),x.default.init(this.$isProd),this.$login.tryLogin().then(((t={})=>{e(t),(0,h.tagTime)("tryLoginOnLaunch");const{userId:s=null,openId:i=null,unionId:o=null}=t||{};i&&this.$lxLog.setLxEnv({userId:s,openId:i,unionId:o}),(0,v.setLoggerEnv)(s,null,i)}),(()=>e(null))),this.initMetrics({version:this.$version,userid:this.$uuid,token:{prod:"6153d15c1c9d4405a5f7966f",test:"615306561c9d440568003e8a"}[this.$isProd?"prod":"test"]||"5c9068371c9d44075eda7c9d",sample:{pageShow:.1,app:1,pageReady:.1,pageSize:.1,customSpeed:.1,request:.1,fmp:.1,data:.1,rate:.1,socket:.1,appfmp:1,applvc:1},enableFstPages:["pages/index/index"],page:c.page})}),300)})),Promise.resolve().then((()=>{wx.onUserCaptureScreen&&wx.onUserCaptureScreen((()=>{try{const e={},t=getApp(),[s,i]=t.$systemInfo.systemInfo.system.split(" ");e.userInfo=t.$userModule.getUserInfo(),e.appInfo={sysName:s,appVersion:i,utm_medium:(0,E.getAppInfo)(),version:t.$version},e.position={city_id:t.$cityId,poiId:t.$poiId,poiIdStr:t.$poiIdStr,userPos:t.$location,poiPos:t.$poiDisTance};const o=t.$cat.getCurrentPagesRoute();[e.route]=o.currentPagesRoute.slice(-1),t.$service.captureScreenPost(e)}catch(e){}})),v.log.warn("预热"),this.$lxLog.openLxDebug(),v.log.info(`<abTest>ab实验sdk初始化,userId:${this.$userModule.getUserId()},uuid:${this.$uuid}`),this.$abTest.init({userId:this.$userModule.getUserId(),uuid:this.$uuid}),(0,v.init)()})),i("onLaunch"),this.login=()=>this.$login.tryLogin(),this.owl=this.$cat.owl,this.$login.event.on(this.$login.event.CONTANTS.LOGIN_SUCCESS,this.initFinancePay.bind(this));const o=(e,t)=>{const{fetchStart:s,fetchEnd:i,getDataStart:o}=t;v.log.info(`[Prefetcher] Path:${e} start prefetching on ${s}, fetching end on ${i} get data on ${o}`);const u=i>o,r=u?o-s:i-s;r>1e4||this.$cat.reportCustomMetrics("prefetchingTiming",r,{path:e,fetchedBeforeOnLoad:u})};d.default.registerHook(((e,t,s)=>{switch(t){case d.HookType.FETCH_START:s.fetchStart=Date.now();break;case d.HookType.GET_DATA_START:s.getDataStart=Date.now(),s.fetchEnd&&o(e,s);break;case d.HookType.FETCH_END:s.fetchEnd=Date.now(),s.getDataStart&&o(e,s)}}))}catch(t){v.log.error(I.METRICS_PRE,"「小程序启动 onLaunch 报错」",`「当前版本为：小程序v${this.$version} 」`,`时间：${new Date}`,`options： ${JSON.stringify(e)}`,`error: ${t}`),(null==(i=this.$cat)?void 0:i.reportCustomMetrics)&&this.$cat.reportCustomMetrics(F.YXReportTarget.ONLAUNCH_ERROR,F.ReportValue.FAILED)}(0,E.isMMP)()||(m.default.register({isWx:(0,E.isInWX)()||(0,E.isTT)(),devMode:!this.$isProd,wxappVersion:this.$version||"1.0.0",catKey:I.CAT_PROJECT_NAME,local:!1,hornKey:"yxuser",hornRequestDelay:1e4,pages:["pages/index/index","pages/skuDetail/index","pages/orderDetail/index","pages/submitOrder/index","pages/orderDetail/index","pages/orderList/index","pages/paySuccess/index"],uuid:this.$uuid,sysInfo:this.$systemInfo&&this.$systemInfo.systemInfo||{},channel:(0,E.isWXMT)()?"wxmtapp":"wxapp"}),this.groupShareQueryCheck(e)),G.globalCustomLXParams.initLXParamsFromURL(e)},onShow(e={}){var t,s;this.currentRoute=e.path;try{this.isHidden=!1,(0,h.tagTime)("onShowStart"),(0,h.checkErrorAppShowError)(),v.log.info("本次分支启动映射：","master",e);const t=(0,h.buildStartPoint)();this.$appShowOptions=new V(this,e),w.default.$appShowOptions=this.$appShowOptions,_.default.init(this.$appShowOptions),this.$router.proxyActivity.init(this),b.default.initApp(this),(0,E.isMMP)()&&(this.$updateAuthPromise=this.$login.updateAuthInfo());const{query:s={}}=e;N.default.checkArgs(s),k.shareReporter.tryReport(this),G.globalCustomLXParams.initLXParamsFromURL(e),(0,E.isMMP)()||X.AdMonitoringReport.handleReport(this.$appShowOptions),this.$ifl_lable||(0,H.addGlobalParams)("ifl_lable",s.ifl_lable),this.$poiControler=C.default,C.default.init(this);const i=this.page();this.$scene=e.scene,w.default.$scene=e.scene;const o=this.$appShowOptions.query;v.log.warn(I.METRICS_PRE,"「小程序显示 onShow」",e,`页面路径: ${i&&i.route}\n            场景值：${this.$scene&&D.default[this.$scene]||"暂无"}`,"处理后的opt是：",o);const u=this.$appShowOptions.getDecodeQuery();this.$lxLog.setLxEnv({opt:u,scene:this.$scene});const r="pages/index/index";e&&e.path!==r&&U.default.emit(U.default.CONTANTS.APP_ON_SHOW,e),this.$cat.setEntryPagePath({path:e&&e.path||"",query:e&&e.query||{}}),t("onShow"),setTimeout((()=>{var e,t;(0,E.packageAndPlatformIsMatch)((null==(e=this.$systemInfo)?void 0:e.systemInfo)||{})||null==(t=this.$cat)||t.reportCustomMetrics(F.YXReportTarget.PACKAGE_PLATFORM_UNMATCH,F.ReportValue.FAILED)}),1e3)}catch(s){v.log.error(I.METRICS_PRE,"「小程序显示 onShow 报错」",e,`场景值：${this.$scene&&D.default[this.$scene]||"暂无"}`,`错误：${s}`),(null==(t=this.$cat)?void 0:t.reportCustomMetrics)&&this.$cat.reportCustomMetrics(F.YXReportTarget.ONSHOW_ERROR,F.ReportValue.FAILED)}null==(s=this.$login)||s.isLogin()},onHide(){(0,E.isMMP)()&&(this.$updateAuthPromise=null),C.default.resetPoiStatus(),(C.default.times>1||C.default.hasConfirmed())&&(0,C.poiTimesCatReport)(C.default.times,C.default.hasConfirmed()),b.default.resetDeniedError(),this.isHidden=!0,this.lastShowPage="";const e=this.page();v.log.warn(I.METRICS_PRE,"「小程序隐藏 onHide」",`页面路径: ${e&&e.route}`),this.clearOutdate();try{U.default.emit(U.default.CONTANTS.APP_ON_HIDE)}catch(e){v.log.error(e)}},groupShareQueryCheck(e,t){},onFirstPageReady(){const e=d.default.getInitFetchPaths().map((e=>({path:e,pageId:e,query:{}})));setTimeout((()=>d.default.fetchParallel(e,this,2)),0)},judgeIfNetWorkErrorFindLogLevel:e=>e instanceof y.NetworkError?v.log.warn.bind(v.log):v.log.error.bind(v.log),pages(){try{return getCurrentPages()}catch(e){return v.log.error(e),[]}},page(e){const t=this.pages();let s=null!=e?e:-1;return s<0&&(s=t.length+s),t[s]},genUUid(){var e;let t="";if(this.$uuid)t=this.$uuid;else if((0,E.isMMP)()&&this.$systemInfo.getSystemInfo().uuid&&(t=this.$systemInfo.getSystemInfo().uuid),t||(t=this.$store.getCacheValue("uuid")),t)this.$uuid=t,w.default.$uuid=t;else{const s=null==(e=this.getModule("systemInfo"))?void 0:e.getSystemInfo();t=(0,S.default)(s?{sc:`${s.screenWidth}*${s.screenHeight}`}:""),this.$uuid=t,w.default.$uuid=t,this.$store.setCache("uuid",t,{expires:Number.MAX_SAFE_INTEGER})}(0,A.default)(this,{uuid:t||""}),this.$lxLog.setLxEnv({uuid:t}),this.$cat.updateUnionId(this.$uuid),v.log.warn(`「getUUid: ${t} 」`,new Date)},getModule(e){return this.$module.getModule(e)},clearOutdate(){try{const e="env",t=this.$store.getCacheValue(e);if(t&&this.$env.getEnv()!==t){const t=this.page();this.getModule("user").removeUserInfo(null==t?void 0:t.__route__),this.$store.setCache(e,this.$env.getEnv())}else this.$store.setCache(e,this.$env.getEnv());const s=this;wx.getStorageInfo({success(e){const{keys:t}=e;Array.isArray(t)&&t.forEach((e=>{-1!==e.indexOf(T.PRE_FIX)&&(e=e.replace(T.PRE_FIX,""),s.$store.getCache(e,{notUpdateCount:!0}))}))}})}catch(e){v.log.error(e)}},isLxProd(){return!(!this.$env||"production"!==this.$env.getEnv())},isProd(){return!(!this.$env||"staging"!==this.$env.getEnv()&&"production"!==this.$env.getEnv())},isLogin(){return this.getModule("login").isLogin()},initFinancePay(){this.globalData=Object.assign(this.globalData,{userId:this.$userModule.getUserId(),openId:this.$userModule.getOpenId(),uuid:this.$uuid,cityId:this.$cityId,token:this.$userModule.getToken(),appid:"tt48f03e4dd7c81b7d01"})}}),c.app);