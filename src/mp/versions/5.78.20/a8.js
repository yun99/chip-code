var e=Object.create,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,s=e=>t(e,"__esModule",{value:!0}),n=n=>((e,a,s)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let n of o(a))p.call(e,n)||"default"===n||t(e,n,{get:()=>a[n],enumerable:!(s=r(a,n))||s.enumerable});return e})(s(t(null!=n?e(a(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);((e,r)=>{for(var o in s(e),r)t(e,o,{get:r[o],enumerable:!0})})(exports,{ListTypes:()=>i.ListTypes,LxData:()=>i.LxData,LxEventTypes:()=>i.LxEventTypes,LxOperator:()=>u,SkuLxOperators:()=>d,default:()=>y,genOperatorKey:()=>h,getCurrentPagePath:()=>c});var i=n(require("./kv.js")),l=n(require("./kb.js")),u=class{constructor(e,t,r,o){this.lxInfoMap=new Map(t),this.father=o,this.type=e,this.commonOperator=r.operator,this.cid=r.cid}setTypeOperator(e,t){const r=this.lxInfoMap.get(e);r.operator=t,this.lxInfoMap.set(e,r)}setOperator(e){this.commonOperator=e}getCid(){return this.cid}getBid(e){var t,r,o,a;return e===i.LxEventTypes.PopupWillSell?(null==(t=this.lxInfoMap.get(e))?void 0:t.bid)||"b_youxuan_kegegpsw_mc":e===i.LxEventTypes.ShareBtnClick?(null==(r=this.lxInfoMap.get(e))?void 0:r.bid)||"b_youxuan_elrcpsba_mc":e===i.LxEventTypes.ShareBtnView?(null==(o=this.lxInfoMap.get(e))?void 0:o.bid)||"b_youxuan_elrcpsba_mv":null==(a=this.lxInfoMap.get(e))?void 0:a.bid}hasTypeOperator(e){var t;return!!(null==(t=this.lxInfoMap.get(e))?void 0:t.operator)}getTypeOperator(e){var t;return(null==(t=this.lxInfoMap.get(e))?void 0:t.operator)||this.commonOperator}getInfo(e){return{bid:this.getBid(e),cid:this.getCid(),operator:this.getTypeOperator(e),isTypeOperator:this.hasTypeOperator(e)}}destory(){this.father.deleteLxOperator(this.type)}},c=()=>{var e;const t=getCurrentPages()||[];return(null==(e=t[t.length-1])?void 0:e.route)||""},h=(e,t)=>(t||(t=c()),`${t}-${e}`),d=class{constructor(){this.operatorMap=new Map,this.pageTypeMap=new Map,this.typeId=0}registerLxOperator(e,t={}){const r=[],{cid:o,operator:a=l.default}=t;Object.keys(t).forEach((e=>{const{length:o}=r;"object"==typeof t[e]?r[o]=[e,t[e]]:r[o]=[e,{bid:t[e]}]}));const p=null===e?""+this.typeId++:e,s=new u(p,r,{operator:a,cid:o},this),n=c()||"default";if(n&&p!==i.ListTypes.default){let e=this.pageTypeMap.get(n);e||(e=[]),e.push(p),this.pageTypeMap.set(n,e)}return this.operatorMap.set(h(p,n),s),p}clearPageOperator(e=""){const t=this.pageTypeMap.get(e);if(t&&Array.isArray(t)&&t.length){for(const r of t){const t=h(r,e);this.deleteLxOperator(t)}this.pageTypeMap.delete(e)}}setLxOperator(e,t){this.operatorMap.set(e,t)}getLxOperator(e){return this.operatorMap.get(e)}deleteLxOperator(e){this.operatorMap.delete(e)}},y=new d;