var e=Object.create,t=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,n=Object.getOwnPropertySymbols,l=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,a=(e,o,s)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,r=(e,t)=>{for(var o in t||(t={}))i.call(t,o)&&a(e,o,t[o]);if(n)for(var o of n(t))u.call(t,o)&&a(e,o,t[o]);return e},c=n=>{return((e,n,l)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let u of s(n))i.call(e,u)||"default"===u||t(e,u,{get:()=>n[u],enumerable:!(l=o(n,u))||l.enumerable});return e})((u=t(null!=n?e(l(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0}),t(u,"__esModule",{value:!0})),n);var u},p=c(require("./ob.js")),h=c(require("./jc.js")),f=getApp();(0,h.defineComponent)(new class{constructor(){this.data={bestCouponList:[],otherUsefullCouponList:[],unUsefullCouponList:[],couponSelect:[],showModal:!1,skuBlack:[],limitDetailTitle:"",empty:!1},this.methods={close(e){p.log.debug("==".repeat(10),"<submitOrderCouponPopComponent close>关闭券包详情");let t={};"confirm"===e.currentTarget.dataset.key&&(t={couponIds:this.data.couponSelect.length?this.data.couponSelect.map((e=>e.couponCode)):[]}),this.triggerEvent("closeCouponList",t)},ifCouponCanSelect(e,t){const o=t||this.data[e];o&&o.length&&o.forEach((e=>{e.couponSelected=!!this.data.couponSelect.find((t=>t.couponCode===e.couponCode))})),this.setData({[e]:o})},closeModal(){this.setData({showModal:!1})},couponSelect(e){const{item:t}=e.target.dataset;let{couponSelect:o}=this.data;if(e.detail.couponSelected)o=[t];else{const e=o.findIndex((e=>e.couponCode===t.couponCode));e>-1&&o.splice(e,1)}this.setData({couponSelect:o}),this.ifCouponCanSelect("bestCouponList"),this.ifCouponCanSelect("otherUsefullCouponList"),this.ifCouponCanSelect("unUsefullCouponList")},gotoRuleDetail(){this.data.couponData.couponDesc.url&&(this.triggerEvent("redirectTo"),f.$router.goto(this.data.couponData.couponDesc.url))},gotoInCouponList(){this.triggerEvent("redirectTo"),f.$router.goto("igrocery://www.grocery.com/coupon_list?tab=3")},showLimitDetail(e){const{index:t}=e.currentTarget.dataset;f.$lxLog.mc("b_chaoshi_5bazuuaf_mc");const o=this.getInvalidSku(t);this.setData({showModal:!0,skuBlack:o,limitDetailTitle:this.data.unUsefullCouponList[t].limitDetailTitle})},getInvalidSku(e){const{skuBlackList:t}=this.data.unUsefullCouponList[e],o=[],s=f.$store.getCacheValue("skuProductInfo");return t.forEach((e=>{e=+e;for(let t=0;t<s.length;t++)if(+s[t].skuId!==e);else{const e=r({},s[t]);e.sellUnitViewPrice=e.sellUnitViewPrice?(e.sellUnitViewPrice/100).toFixed(2):"0",e.promotionViewPrice&&(e.promotionViewPrice=(e.promotionViewPrice/100).toFixed(2)),o.push(e)}})),o}},this.properties={couponData:{type:Object,observer(e){e&&(this.setData({couponSelect:[...e.bestCouponList||[],...e.otherUsefullCouponList||[],...e.unUsefullCouponList||[]].filter((e=>e.couponSelected))}),e.bestCouponList&&e.bestCouponList.length||e.otherUsefullCouponList&&e.otherUsefullCouponList.length||e.unUsefullCouponList&&e.unUsefullCouponList.length?this.setData({empty:!1}):this.setData({empty:!0}),this.ifCouponCanSelect("bestCouponList",e.bestCouponList||[]),this.ifCouponCanSelect("otherUsefullCouponList",e.otherUsefullCouponList||[]),this.ifCouponCanSelect("unUsefullCouponList",e.unUsefullCouponList||[]))}},show:Boolean}}});