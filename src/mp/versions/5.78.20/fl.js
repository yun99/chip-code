var e=Object.create,t=Object.defineProperty,r=Object.defineProperties,o=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,i=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,p=(e,r,o)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,c=(e,t)=>{for(var r in t||(t={}))u.call(t,r)&&p(e,r,t[r]);if(a)for(var r of a(t))l.call(t,r)&&p(e,r,t[r]);return e},d=e=>t(e,"__esModule",{value:!0}),g=r=>((e,r,n)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let a of s(r))u.call(e,a)||"default"===a||t(e,a,{get:()=>r[a],enumerable:!(n=o(r,a))||n.enumerable});return e})(d(t(null!=r?e(i(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),m=(e,t,r)=>(p(e,"symbol"!=typeof t?t+"":t,r),r);((e,r)=>{for(var o in d(e),r)t(e,o,{get:r[o],enumerable:!0})})(exports,{default:()=>x});var y=g(require("./ul.js")),h=g(require("./pi.js")),f=g(require("./un.js")),w=g(require("./kw.js")),v=g(require("./iu.js")),P=g(require("./ob.js")),S=g(require("./u8.js")),E=g(require("./po.js")),R=g(require("./p0.js")),_=g(require("./is.js")),A=g(require("./o7.js")),x=class extends w.default{constructor(e,t){super(e,t),m(this,"setNetworkType",(e=>{this.networkType=e})),m(this,"onErrorPush",(e=>{if(e){const{level:o=e.level,sec_category:s=e.sec_category}=this.handleErrorCategoery(e);e.level=o,e.sec_category=s;const a=-1!==["warn","warning","error"].indexOf(e.level||""),i=this.getReportInfo(a,Date.now(),!a),u=i.timestamp,l=new Date(e.timestamp);e.timestamp=u,e.dynamicMetric=(t=c(c({},i),e.dynamicMetric),r(t,n({reportErrorTime:l})))}var t;return e})),m(this,"handleErrorCategoery",(e=>{const{content:t,level:r,type:o=""}=e;if("error"!==r||o===A.default.BUSINESS)return{};let n;const s=this.findText(t),a=s("null"),i=s("undefined"),u=s("TypeError"),l=s("SyntaxError"),p=s("存在渲染异常"),c=s("module"),d=s("is not defined");n=a||i?v.CAT_SEC_CATEGORY.JS_ERROR_NULL_UNDEFINED:!u||a||i?l?v.CAT_SEC_CATEGORY.JS_ERROR_SYNTAX:p?v.CAT_SEC_CATEGORY.JS_ERROR_RENDER:c&&d?v.CAT_SEC_CATEGORY.JS_ERROR_MODULE:v.CAT_SEC_CATEGORY.JS_ERROR_OTHERS:v.CAT_SEC_CATEGORY.JS_ERROR_TYPE;return n({content:t})})),m(this,"findText",(e=>t=>e&&t&&e.indexOf(t)>-1));const o=t.getModule("env");this.isProd="production"===o.getEnv(),this.owl=y.owl,this.entryPagePath="",this._version="1.0.0",this._wxApiInfos=[],this.networkType="init",y.owl.start({project:(0,S.getAppKey)(),devMode:!this.isProd,version:{appVersion:"4.4.0"},logan:{enable:!1},page:{sample:.1},metric:{combo:!0,delay:1500,trigger:20},error:{sample:1},resource:{sample:1,defaultNetworkCode:412},autoCatch:{pv:!0,pagePv:!0},pageId:this.getPageId(),onErrorPush:this.onErrorPush}),this.onPageNotFound()}static register(e){const t=new x("cat",e);return e.addModule(t),t}destory(){}updateUnionId(e){this.owl.cfgManager.update("unionId",e)}getPageId(e=6){const t="12345689ABCDEGHJKLMNPQRSTUVWXYZ";return new Array(e).fill("").map((()=>t[Math.round(Math.random()*(t.length-1))])).join("")}setAppVersion(e){this._version=e,this.owl.cfgManager.config.version.appVersion=e}setEnv({isDevMode:e=!1}={}){this.owl.cfgManager.setApiDomain(e),this.isProd=!e}setEntryPagePath({path:e="",query:t={}}={}){this.entryPagePath=`${e}?query=${JSON.stringify(t)}`}getCurrentPagesRoute(){const e=getApp(),t=e&&e.pages()||[];return{page:e&&e.page()||{},prePage:t[t.length-2],currentPagesRoute:t.map(((e,t)=>({pIdx:t,route:e.route,onLoadArgs:e.onLoadArgs||"",onShowArgs:e.onShowArgs||""})))}}getReportInfo(e=!0,t=Date.now(),r=!1){var o,n,s;try{if(r)return{timestamp:t};const a=getApp(),i=a&&a.getModule("user");let u={};const l=c({},a&&(null==(o=a.$systemInfo)?void 0:o.getSystemInfo())||"");e&&(u={pixelRatio:l.pixelRatio,system:l.system,version:l.version,SDKVersion:l.SDKVersion,brand:l.brand,model:l.model,fontSizeSetting:l.fontSizeSetting});const{page:p,prePage:d,currentPagesRoute:g}=this.getCurrentPagesRoute();return{systemInfo:u,wxappVersion:a&&a.$version,appVersion:l.appVersion||"0.0.0:0",mmpVersion:l.mmpVersion||"",SCENE:f.default[a&&a.$scene]||(this.app.$scene?"no Scene":"new Scenne"),wxnickname:(null==i?void 0:i.getWxNickName())||"no data",mtnickname:(null==(n=null==i?void 0:i.getMtUserInfo())?void 0:n.nickname)||"no data",poi_id:a&&a.$poiId,poiIdStr:a&&a.$poi.getPoiIdStr(),wechat_name:(null==i?void 0:i.getWxNickName())||-999,wechat_profile_url:(null==i?void 0:i.getWxAvatarUrl())||-999,stockPois:a&&a.$stockPois,userId:null==i?void 0:i.getUserId(),openId:null==i?void 0:i.getOpenId(),mobile:null==(s=null==i?void 0:i.getMtUserInfo())?void 0:s.mobile,uuid:a&&a.$uuid,appName:"youxuan",mpId:"",platform:(0,E.isMMP)()?(0,S.isDP)()?"dp":"mmp":"wx",entryPagePath:this.entryPagePath,currentPagePath:null==p?void 0:p.route,prePagePath:null==d?void 0:d.route,timestamp:t,currentPagesRoute:g,currentPageArgs:{onLoadArgs:null==p?void 0:p.onLoadArgs,onShowArgs:null==p?void 0:p.onShowArgs},networkType:this.networkType}}catch(e){return{}}}reportError(e,t=!1){try{const r=e||v.CAT_SEC_CATEGORY.WRONG_FORMAT(this.getReportInfo(!1));this&&this.owl&&this.owl.error.pushError(r,t)}catch(e){P.log.error("【CAT】cat error",e)}}customMetricsSysInfo(){var e;const t=getApp();let r={};const o=c({},t&&(null==(e=t.$systemInfo)?void 0:e.getSystemInfo())||"");return r={system:o.system,version:o.version,SDKVersion:o.SDKVersion,brand:o.brand,model:o.model,mmpVersion:o.mmpVersion||"",appVersion:o.appVersion||"not_app"},r}customMetricsBaseInfo(){var e;const t=getApp();return{wxappVersion:t&&t.$version,SCENE:f.default[t&&t.$scene]||((null==(e=this.app)?void 0:e.$scene)?"no Scene":"new Scenne"),platform:(0,E.isMMP)()?"mmp":"wx",networkType:this.networkType}}reportCustomMetrics(e="",t=_.ReportValue.SUCCESS,r={},o=!0){if(!e||!(null==e?void 0:e.length))return;let n=r;const s=this.customMetricsBaseInfo();if(n=c(c({},s),n),o){const e=this.customMetricsSysInfo();n=c(c({},e),n)}y.owl.setMetric(e,t,n)}reportAllErrorRightNow(){try{this.owl.error.report()}catch(e){P.log.error("【CAT】cat error",e)}}reportAllRightNow(){try{this.owl.error.report(),this.owl.pageSpeed.report()}catch(e){P.log.error(e)}}pageNotFound(e){const{path:t="",query:r={}}=e||{};if(t&&t[0]&&"/"!==t[0]){const o=this.revertPageRouter(t,r);let n;P.log.warn("page  not found",`错误信息：${JSON.stringify(e)}`,"绝对路径出现报错，使用相对路径再跳转一次");const s=getApp().page(),a=s&&s.route;n=a&&(0,R.tabBarIndex)(a)>-1?`../../${o}`:`../../../../${o}`;getApp().$router.goto(n,{need_type:"navigateTo"}).then((e=>{P.log.warn("page  not found",`成功，当前在：${a}`,e,n)})).catch((t=>{P.log.warn("page  not found","失败，当前在：",t,n),this.switchToIndex(e)}))}else this.switchToIndex(e)}switchToIndex(e){P.log.error("page  not found",`错误页面信息：${JSON.stringify(e)}`);getApp().$router.goto("/pages/index/index?need_type=switchTab"),setTimeout((()=>{h.default.showToast({title:"没有找到该页面，看看其他商品吧~",icon:"none"})}),100)}revertPageRouter(e,t){return Object.keys(t).reduce(((e,r)=>(null!=r&&void 0!==t[r]&&null!==t[r]&&(e=`${e}${r}=${t[r]}&`),e)),`${e}?`).slice(0,-1)}onPageNotFound(){h.default.use("onPageNotFound",(e=>{e.onPageNotFound((e=>{this.pageNotFound(e)}))}))}};