var e=Object.create,t=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,a=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,n=e=>t(e,"__esModule",{value:!0}),c=c=>((e,a,n)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let c of i(a))s.call(e,c)||"default"===c||t(e,c,{get:()=>a[c],enumerable:!(n=o(a,c))||n.enumerable});return e})(n(t(null!=c?e(a(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);((e,o)=>{for(var i in n(e),o)t(e,i,{get:o[i],enumerable:!0})})(exports,{default:()=>u});var l=c(require("./dt.js")),r=c(require("./kq.js")),d=new l.default,u={data:{voiceInfo:{}},initVoiceSDK({data:e,success:t,fail:o}={}){r.rohr.i(r.rohrConfig.i),this.callBackSuccess=t,this.callBackFail=o;const i=e.riskLevel.split("|");this.setData({voiceInfo:{data:e,isMobile:e.mobile,isSend:!1,show:!0,voicecode:"",opacity:.5,sendVoiceDisa:!e.mobile,verifyDisa:!0,switchText:i.length>1,mobileLable:e.mobileLable||"手机号",verifyCodeLable:e.verifyCodeLable||"验证码",smscode:"",sendSmsDisa:!e.mobile,buttonValue:e.buttonValue||"验证"}})},tapSeedVoice(){const e=this,{voiceInfo:t,voiceInfo:{isMobile:o,data:{action:i,request_code:a,type:s,options:n}}}=this.data;let c=t.mobile;o&&(c="");const l={title:"提示",content:"您现在方便接电话么",cancelText:"不方便",cancelButtonText:"不方便",cancelColor:"#333",confirmText:"方便",confirmButtonText:"方便",confirmColor:"#000",success:o=>{o.confirm&&(tt.showLoading({title:"发送中...",mask:!0}),d.sendInfo({request_code:a,type:s,action:i,options:{mobile:c,moduleEnable:!0}}).then((o=>{tt.hideLoading();const{status:i,error:a}=o;1===i?(e.showWaitModal(),t.isSend=!0):e.handleError(a),e.setData({voiceInfo:t})})).catch((()=>{d.catchCallback("打电话异常了",0,"请求打电话异常",n,this)})))}};tt.showModal?tt.showModal(l):tt.confirm&&tt.confirm(l)},bindVerify(){const e=this,{voiceInfo:t,voiceInfo:{isMobile:o,voicecode:i,data:{action:a,request_code:s,type:n,options:c,listIndex:l}}}=this.data;let r=t.mobile;o&&(r=""),tt.showLoading({title:"验证中...",mask:!0}),d.verify({request_code:s,type:n,action:a,options:{voicecode:i,mobile:r,listIndex:l}}).then((o=>{tt.hideLoading();const{status:i,data:a,error:n}=o;if(1===i){if(d.nextVerify(t.data,a.nextVerifyMethodId))return;d.successCallback(s,a.response_code,c,this)}else e.handleError(n)})).catch((()=>{d.catchCallback("验证异常",0,"请求验证异常",c,this)}))},handleError(e){const{voiceInfo:{data:{options:t}}}=this.data;d.errorCallback(e,t,this.errorExit,this)},errorExit(){const{voiceInfo:e}=this.data;e.voicecode="",e.opacity=.5,e.verifyDisa=!0,this.setData({voiceInfo:e})},showWaitModal(){const e=this;let t=0,{voiceInfo:{codeButText:o,sendSmsDisa:i}}=e.data;const a=o,s=setInterval((()=>{const{voiceInfo:n}=e.data;t+=1,o=60-t+"s后请重试",i=!0,60===t&&(clearInterval(s),o=a,i=!1),n.sendSmsDisa=i,n.codeButText=o,e.setData({voiceInfo:n})}),1e3)},bindMobileInput(e){const t=e.detail.value,{voiceInfo:o}=this.data;o.mobile=t,o.sendVoiceDisa=11===t.length,this.setData({voiceInfo:o})},bindVoiceCodeInput(e){const t=e.detail.value,{voiceInfo:o}=this.data;o.voicecode=t,o.opacity=t.length>1&&o.isSend?1:.5,this.setData({voiceInfo:o})},changeVerify(){const{voiceInfo:{data:e}}=this.data;d.changeVerify(e)},onTapPage(e){r.rohr.t(e)},onTouchMovePage(e){r.rohr.m(e)}};