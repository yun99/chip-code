var e=Object.create,t=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,o=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,n=e=>t(e,"__esModule",{value:!0}),l=l=>((e,o,n)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let l of a(o))i.call(e,l)||"default"===l||t(e,l,{get:()=>o[l],enumerable:!(n=s(o,l))||n.enumerable});return e})(n(t(null!=l?e(o(l)):{},"default",l&&l.__esModule&&"default"in l?{get:()=>l.default,enumerable:!0}:{value:l,enumerable:!0})),l);((e,s)=>{for(var a in n(e),s)t(e,a,{get:s[a],enumerable:!0})})(exports,{default:()=>m});var r=l(require("./dt.js")),d=l(require("./kq.js")),c=new r.default,m={data:{smsInfo:{}},initSmsSDK({data:e,success:t,fail:s}={}){d.rohr.i(d.rohrConfig.i),this.callBackSuccess=t,this.callBackFail=s,this.setData({smsInfo:{data:e,isMobile:e.mobile,isSend:!1,show:!0,mobileLable:e.mobileLable||"手机号",verifyCodeLable:e.verifyCodeLable||"验证码",smscode:"",opacity:.5,sendSmsDisa:!e.mobile,verifyDisa:!0,buttonValue:e.buttonValue||"验证"}}),"true"===e.autoSend&&this.tapSeedSmS()},tapSeedSmS(){const e=this,{smsInfo:t,smsInfo:{isMobile:s,data:{action:a,request_code:o,type:i,options:n}}}=this.data;let l=t.mobile;s&&(l=""),tt.showLoading({title:"发送中...",mask:!0}),c.sendInfo({request_code:o,type:i,action:a,options:{mobile:l,moduleEnable:!0}}).then((s=>{tt.hideLoading();const{status:a,error:o}=s;1===a?(tt.showToast({title:"已发送短信",content:"已发送短信"}),e.showWaitModal(),t.isSend=!0):e.smsHandleError(o),e.setData({smsInfo:t})})).catch((()=>{c.catchCallback("发送短信异常",0,"请求发送短信异常",n,this)}))},bindSmsVerify(){const e=this,{smsInfo:t,smsInfo:{isMobile:s,isSend:a,smscode:o,opacity:i,data:{action:n,request_code:l,type:r,options:d,listIndex:m}}}=this.data,u=s?"":t.mobile;a&&1===i&&(tt.showLoading({title:"验证中...",mask:!0}),c.verify({request_code:l,type:r,action:n,options:{smscode:o,mobile:u,listIndex:m}}).then((s=>{tt.hideLoading();const{status:a,data:o,error:i}=s;if(1===a){if(t.show=!1,c.nextVerify(t.data,s.data.nextVerifyMethodId))return;c.successCallback(l,o.response_code,d,this)}else e.smsHandleError(i)})).catch((()=>{c.catchCallback("验证异常",0,"请求验证异常",d,this)})))},smsHandleError(e){const{smsInfo:{data:{options:t}}}=this.data;c.errorCallback(e,t,this.errorExit,this)},errorExit(){const{smsInfo:e}=this.data;e.smscode="",e.opacity=.5,e.verifyDisa=!0,this.setData({smsInfo:e})},showWaitModal(){const e=this;let t=0,{smsInfo:{codeButText:s,sendSmsDisa:a}}=e.data;const o=s,i=setInterval((()=>{const{smsInfo:n}=e.data;t+=1,s=60-t+"s后请重试",a=!0,60===t&&(clearInterval(i),s=o,a=!1),n.sendSmsDisa=a,n.codeButText=s,e.setData({smsInfo:n})}),1e3)},myverifyEvent(e){const{status:t}=e.detail;1===t&&this.tapSeedSmS()},bindMobileInput(e){const t=e.detail.value.trim(),{smsInfo:s}=this.data;s.mobile=t,s.sendSmsDisa=11===t.length,this.setData({smsInfo:s})},bindSmsCodeInput(e){const t=e.detail.value,{smsInfo:s}=this.data;s.smscode=t,s.opacity=t.length>1&&s.isSend?1:.5,this.setData({smsInfo:s})},changeVerify(){const{smsInfo:{data:e}}=this.data;c.changeVerify(e)},onTapPage(e){d.rohr.t(e)},onTouchMovePage(e){d.rohr.m(e)}};