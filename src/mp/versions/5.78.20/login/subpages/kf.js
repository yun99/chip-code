var e=Object.create,t=Object.defineProperty,a=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,s=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,n=e=>t(e,"__esModule",{value:!0}),r=r=>((e,s,n)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let r of o(s))i.call(e,r)||"default"===r||t(e,r,{get:()=>s[r],enumerable:!(n=a(s,r))||n.enumerable});return e})(n(t(null!=r?e(s(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),c=(e,a,o)=>(((e,a,o)=>{a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o})(e,"symbol"!=typeof a?a+"":a,o),o);((e,a)=>{for(var o in n(e),a)t(e,o,{get:a[o],enumerable:!0})})(exports,{default:()=>d});var u=r(require("./dt.js")),l=r(require("./kq.js")),g=new u.default,d=class{constructor(){c(this,"initImage",((e,t)=>{this.requestCode=e,g.getPageData(e,"image").then((a=>{const{status:o,data:s,error:i}=a;0===o&&tt.showToast({title:"请求异常",content:"请求异常",complete:()=>{t.triggerEvent?t.triggerEvent("imageEvent",{status:0,code:i.code},{bubbles:!0,composed:!0}):t.props.imageEvent({status:0,code:i.code}),t.setData({isShow:!1})}}),t.setData({data:s,imgsrc:`${this.baseUrl}/v2/captcha?request_code=${e}&action=${s.action}&captchaHash=${Number(new Date)}`,opacity:.5,animationData:{},plain:!0,isShow:!0})})).catch((()=>{t.triggerEvent?t.triggerEvent("imageEvent",{status:0,code:99999},{bubbles:!0,composed:!0}):t.props.imageEvent({status:0,code:99999}),t.setData({isShow:!1})}));const a=tt.createAnimation({transformOrigin:"50% 50%",duration:500,timingFunction:"ease",delay:0});t.animation=a})),c(this,"bindImgVerify",((e,t)=>{const{value:a,data:{action:o,request_code:s,type:i,listIndex:n},opacity:r}=e;1===r&&(tt.showLoading({title:"验证中...",mask:!0}),g.verify({request_code:s,type:i,action:o,options:{captchacode:a,listIndex:n}}).then((e=>{tt.hideLoading();const{status:a,data:o,error:i}=e;if(1===a){const e={status:1,requestCode:s,responseCode:o.response_code};t.triggerEvent?t.triggerEvent("imageEvent",e,{bubbles:!0,composed:!0}):t.props.imageEvent(e),t.setData({value:"",opacity:.5,isShow:!1})}else{const e=i.code;121020===e?(tt.showToast({title:"验证码错误",content:"验证码错误",mask:!0,icon:"loading",type:"fail",complete:t.bingUpdateImg()}),t.setData({value:"",opacity:.5})):(t.triggerEvent?t.triggerEvent("imageEvent",{status:0,code:e},{bubbles:!0,composed:!0}):t.props.imageEvent({status:0,code:e}),t.setData({value:"",opacity:.5,isShow:!1}))}})).catch((()=>{t.triggerEvent?t.triggerEvent("imageEvent",{status:0,code:99999},{bubbles:!0,composed:!0}):t.props.imageEvent({status:0,code:99999}),t.setData({isShow:!1})})))})),c(this,"changeImage",(e=>{let{imgsrc:t}=e.data;const a=e.data.data;t=`${this.baseUrl}/v2/captcha?request_code=${a.request_code}&action=${a.action}&captchaHash=${Number(new Date)}`,e.setData({imgsrc:t})})),c(this,"bindImgCodeInput",((e,t)=>{let{opacity:a}=t.data;a=e&&4===e.length?1:.5,t.setData({value:e,opacity:a})})),this.baseUrl=l.YodaServer.getYodaServer().getServer()}};