var e=Object.create,t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,o=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,r=e=>t(e,"__esModule",{value:!0}),a=a=>((e,o,r)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let a of n(o))s.call(e,a)||"default"===a||t(e,a,{get:()=>o[a],enumerable:!(r=i(o,a))||r.enumerable});return e})(r(t(null!=a?e(o(a)):{},"default",a&&a.__esModule&&"default"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);((e,i)=>{for(var n in r(e),i)t(e,n,{get:i[n],enumerable:!0})})(exports,{default:()=>g});var c=a(require("./k5.js")),u=a(require("./j0.js")),p=a(require("./j9.js")),l=a(require("./dl.js")),d="https://catfront.dianping.com",f=["region","operator","network","container","os","unionId"],g=class{constructor(e){if(this._config={devMode:!1,project:"",pageUrl:"",autoCatch:{pv:!0,pagePv:!1,promiseRejection:!1},page:{sample:.5},resource:{sample:.1,errSample:.2,defaultNetworkCode:500,sendTriggerThreshold:10,delay:1500},enableLogTrace:!1,error:{sample:1,maxSize:10240,maxNum:100,maxTime:6e4},metric:{sample:1,trigger:15,delay:1500},version:{},logan:{enable:!1},hasRecordApp:!1,pageId:"owl-"+(0,l.default)()},this.config={},this.userConfig={},this.url=d,e?this.set(e):this.config=this._config,this.baseQuery={v:1,sdk:c.VERSION},this.apiPaths={error:"/api/log",page:"/api/speed",resource:"/batch",metric:"/api/metric",pv:"/api/pv",log:"/api/log"},this.extensions={},!e||!e.unionId)try{let e=u.context.getStorageSync(`${c.STOREKEY}-unionId`);e?this.config.unionId=e:(this.config.unionId=(0,p.MSID)(),this.cacheUnionId(this.config.unionId))}catch(e){this.config.unionId=""}}_update(){this.config=this._config;try{for(let e in this.userConfig){let t=this.userConfig[e];"object"!=typeof t||t instanceof RegExp||t instanceof Array?this.config[e]=t:this.config[e]=(0,p.extend)(this.config[e],this.userConfig[e])}}catch(e){}}update(e,t){try{if(!e||void 0===t)return;this.config[e]=t,"unionId"===e?this.cacheUnionId(t):"devMode"===e&&this.setApiDomain(t)}catch(e){}}get(e){return e?this.config[e]:this.config}set(e){try{if(!e||"object"!=typeof e)return;for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];"devMode"===t&&this.setApiDomain(i),"object"!=typeof i||i instanceof RegExp||i instanceof Array?this.userConfig[t]=i:this.userConfig[t]=(0,p.extend)(this.userConfig[t],i)}this._update()}catch(e){}}getApiPath(e,t=1){let i=Object.assign({},this.baseQuery,{v:t});return(0,p.stringify)(this.url+this.apiPaths[e],i)}setApiDomain(e){this.url=e?"https://catfront.51ping.com":d}getExtension(e){return e?this.extensions[e]:this.extensions}setExtension(e){try{if(!e||"object"!=typeof e)return;for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];f.indexOf(t)>-1?this.extensions[t]="unionId"!==t?i:this.config.unionId:t.indexOf("Version")>-1&&(this.config.version[t]=i)}}catch(e){}}cacheUnionId(e){u.context.setStorage({key:`${c.STOREKEY}-unionId`,data:e})}};