module.exports=function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var a;n.r(e),n.d(e,"app",(function(){return O})),n.d(e,"page",(function(){return R})),n.d(e,"component",(function(){return M})),n.d(e,"request",(function(){return j})),n.d(e,"metrics",(function(){return T})),n.d(e,"r2xapp",(function(){return L})),n.d(e,"r2xpage",(function(){return z}));var o="wx";"undefined"!=typeof tt&&tt.getSystemInfo?(a=tt,o="tt"):"undefined"!=typeof swan&&swan.getSystemInfo?(a=swan,o="swan"):"undefined"!=typeof my?(a=my,o="my"):"undefined"!=typeof mmp?(a=wx,o="mmp"):a=wx,a.metrics_vendor=o;var i=a,r={};function s(){var t=getCurrentPages()||[];if(t.length){var e=t[t.length-1]||{route:"other"};return e.route||e.__route__}return"app"}var u=[];function p(t,e){if(t.get("dev"))return!0;var n=t.get("sample")[e];return void 0!==n&&n>Math.random()}function c(){for(var t,e={},n=arguments.length,a=0;a<n;a++)for(var o in t=arguments[a])void 0!==t[o]&&(e[o]=t[o]);return e}function f(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))}function h(t,e){t=t.split("."),e=e.split(".");for(var n=Math.max(t.length,e.length);t.length<n;)t.push("0");for(;e.length<n;)e.push("0");for(var a=0;a<n;a++){var o=parseInt(t[a]),i=parseInt(e[a]);if(o>i)return 1;if(o<i)return-1}return 0}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config={},this.useConfig={},this.set(this.getDefault())}var e,n;return e=t,(n=[{key:"getDefault",value:function(){return{project:"metrics_wxapp",version:"1.0.0",token:"",dev:!1,userid:"",whitescreen:1e3,autotest:!1,localtest:!1,autoreport:!1,autoreportime:5e3,localtestnum:100,sample:this.setSample(1),hooks:{},suffix:{from:!0}}}},{key:"hooks",value:function(t,e,n){try{var a=this.get("hooks")[t];a&&a(e,n)}catch(t){}}},{key:"setSample",value:function(t){return{app:t,appload:t,appready:t,pageShow:t,pageReady:t,fmp:t,data:t,customSpeed:t,request:t,rate:t,socket:t,pageSize:t,webview:t,appfmp:t,applvc:t}}},{key:"get",value:function(t){return t?this.useConfig[t]:this.useConfig}},{key:"init",value:function(t){this.set(this.getDefault()),this.set(t)}},{key:"set",value:function(t){if(t)for(var e in t)e&&this.update(e,t[e],!0)}},{key:"update",value:function(t,e,n){void 0!==e&&("sample"===t&&"number"==typeof e&&(e=this.setSample(e)),this.isObj(e)?(this.useConfig[t]=c(this.useConfig[t],e),n&&(this.config[t]=c(this.config[t],e))):(this.useConfig[t]=e,n&&(this.config[t]=e)))}},{key:"isObj",value:function(t){return!("object"!==l(t)||t instanceof RegExp||t instanceof Array)}},{key:"reset",value:function(){this.set(this.config)}}])&&m(e.prototype,n),t}(),g={onLaunch:"onLaunch",onHide:"onHide"},y=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:App,a=arguments.length>3?arguments[3]:void 0,o=e[(a=a||g).onLaunch],i=e[a.onHide],r=t.speed,s=t.config;e[a.onLaunch]=function(t){try{r.appLaunch(),s.hooks("app:launch")}catch(t){}o&&o.call(this,t);try{r.wxPerformStatics()}catch(t){}},e[a.onHide]=function(){try{s.hooks("app:hide")}catch(t){}i&&i.call(this)},e.initMetrics=function(e){try{t.init(e),s.hooks("app:init",e)}catch(t){}},n(e)},v={onLoad:"onLoad",onShow:"onShow",onReady:"onReady",onHide:"onHide",onUnload:"onUnload"},w=function(t,e,n,a){a=a||v;var o=t.config,i=t.speed;if(n){var r=e[a.onLoad],u=e[a.onShow],p=e[a.onReady],f=e[a.onHide],h=e[a.onUnload],l=e.onTabItemTap,m=e.onPullDownRefresh,d=function(){i.preprocess(this.metricsPageSuffix),i.pageSize(this.data,{pageName:this._metricsPageName}),i.report(),o.reset()};e[a.onLoad]=function(t){this._metricsStartTime=Date.now();try{this._metricsPageName=s();var e={ts:Date.now(),pageName:this._metricsPageName,start:this._metricsStartTime};i.pageLoad(e),o.hooks("load",e,t)}catch(t){}r&&r.call(this,t)},e[a.onShow]=function(t){try{var e={ts:Date.now(),value:Date.now()-this._metricsStartTime,pageName:this._metricsPageName};i.pageShow(e),o.update("sample",this.metricsSample),o.update("token",this.metricsToken),o.hooks("show",e)}catch(t){}u&&u.call(this,t)},e[a.onReady]=function(t){try{var e={ts:Date.now(),value:Date.now()-this._metricsStartTime,pageName:this._metricsPageName};i.pageReady(e),o.hooks("ready",e)}catch(t){}p&&p.call(this,t)},e[a.onHide]=function(t){try{d.call(this),o.hooks("hide")}catch(t){}f&&f.call(this,t)},e[a.onUnload]=function(t){try{d.call(this),i.pageUnload(this._metricsPageName),o.hooks("unload")}catch(t){}h&&h.call(this,t)},e.onTabItemTap=function(t){try{i.tabItemTap(t)}catch(t){}l&&l.call(this,t)},e.onPullDownRefresh=function(t){try{i.pullRefresh()}catch(t){}m&&m.call(this,t)}}return e.setMetricsSample=function(t){try{o.update("sample",t)}catch(t){}},e.setMetricsParams=function(t,e){try{o.update(t,e)}catch(t){}},e.metricsFMP=function(t){var e=this,n="function"==typeof arguments[1]?1:2,a=arguments[3-n]||{},o=arguments[n],r=Date.now();this.setData(t,(function(){if(!0!==a.ignore)try{var n=Date.now();a.pageName=e._metricsPageName;var s={ts:n,time:n-r,duration:a.duration||n-e._metricsStartTime,size:!1!==a.needSize?JSON.stringify(t).length:0};i.firstMeaningfulPaint(s,a)}catch(t){}"function"==typeof o&&o()}))},e.startMetricsPoint=function(t,e){var n=i.startPoint(t,e),a=this._metricsPageName;return e&&e.global&&(e.pageName=e.pageName||a),o.hooks("custom:start",{pointId:n,key:t,options:e}),{pointId:n,add:function(e){try{i.addPoint(this.pointId,a,e),o.hooks("custom:add",{pointId:n,key:t,options:e})}catch(t){}return this},end:function(){try{this.pointId=null,i.endPoint(this.pointId),o.hooks("custom:end",{pointId:n})}catch(t){}}}},e.metricsSetData=function(t){var e=this,n="function"==typeof arguments[1]?1:2,a=arguments[3-n]||{},r=arguments[n],s=Date.now(),u=function(){try{var n=Date.now();if(!0!==a.ignore&&i.startData()){a.pageName=e._metricsPageName;var u={ts:n,duration:a.duration||n-s,size:a.needSize?JSON.stringify(t).length:0};i.endData(u,a),o.hooks("data",u)}}catch(t){}"function"==typeof r&&r()};if(a.fmp)try{var p=a.fmpParams||{};p.ignore=p.ignore||!1,this.metricsFMP(t,c(a,p),u)}catch(e){this.setData(t,u)}else this.setData(t,u)},e},k=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Page,a=arguments.length>3?arguments[3]:void 0;n(w(t,e||{},!0,a))};function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.logs=[],this._recordPage=0,this.fmp={},this.show={},this.hide={},this.custompoints={},this.customparams={}}var e,n;return e=t,(n=[{key:"appLaunch",value:function(){this._appStart=Date.now(),this.push("wxapp.app.launch",1),this.memoryWarning()}},{key:"memoryWarning",value:function(){var t=this;i.onMemoryWarning&&i.onMemoryWarning((function(e){var n={5:"TRIM_MEMORY_RUNNING_MODERATE",10:"TRIM_MEMORY_RUNNING_LOW",15:"TRIM_MEMORY_RUNNING_CRITICAL"}[e.level],a=getCurrentPages().map((function(t){return t&&t.route||"other"}))||[],o={currPageNum:a.length,pages:a.join(",")};n&&(o.key=n),t.push("wxapp.memory.warning",1,o),t.report(),t.config.hooks("memory",o)}))}},{key:"pageLoad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._recordPage++,this._start=t.start||Date.now(),this._pageName=t.pageName,this.appLoad(t.pageName||s())}},{key:"tabItemTap",value:function(){this._recordPage++}},{key:"appLoad",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_hasAppLoad",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"load";if(!this[e]&&this._appStart){var a=getCurrentPages()||[];if(!(this._recordPage>1||a.length>1)){var o=Date.now()-this._appStart;p(this.config,"app")&&p(this.config,"app".concat(n))&&this.push("wxapp.app.".concat(n),o,{pageName:t}),this[e]=!0}}}},{key:"pageShow",value:function(t){var e=t.value,n=t.pageName;!this.show[n]&&p(this.config,"pageShow")&&this.push("wxapp.page.show",e,{pageName:n}),this.show[n]=!0}},{key:"pageReady",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.pageName||s();if(p(this.config,"pageReady")){var n=t.value||Date.now()-this._start;this.push("wxapp.page.ready",n,{pageName:e})}this.appLoad(e,"_hasAppReady","ready")}},{key:"addAppFmp",value:function(t){this.addFirstAppFmp(t)}},{key:"addAppLvc",value:function(t){this.addFirstAppFmp(t,"lvc")}},{key:"addFirstAppFmp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fmp";return this._pageLeave||this["_app".concat(e)]?-1:(this["_app".concat(e)]=!0,p(this.config,"app".concat(e))?((t=t||{}).key||(t.key="success"),this.appLaunchStartTime&&this.push("wxapp.app.api.".concat(e),Date.now()-this.appLaunchStartTime,t),void this.push("wxapp.app.".concat(e),Date.now()-this._appStart,t)):-1)}},{key:"firstMeaningfulPaint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.ts||Date.now(),a=e.key||"page",o=e.pageName;if(o&&(!this.fmp[o]||!this.fmp[o][a])&&(this.fmp[o]||(this.fmp[o]={}),this.fmp[o][a]=!0,p(this.config,"fmp"))){var i={key:a,pageName:o};e.extra&&(i.extra=e.extra);var r=t.duration||n-this._start;this.push("wxapp.page.fmp.time",r,i),t.size&&this.push("wxapp.page.fmp.dataSize",t.size,i),this.config.hooks("fmp",t)}}},{key:"pullRefresh",value:function(){}},{key:"pageUnload",value:function(t){delete this.fmp[t],delete this.show[t],delete this.hide[t]}},{key:"startPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=f();this.custompoints[n]||(this.custompoints[n]=[]),this.custompoints[n].length>0&&(this.pushPoint(n),this.custompoints[n]=[]),this.custompoints[n].push({ts:Date.now(),index:0,need:!0});var a=8,o=1;return"number"==typeof e.num&&e.num>0&&e.num<8&&(a=e.num,o=e.num),this.customparams[n]={key:t,maxNum:a,minNum:o,scope:e.global?"app":"page"},n}},{key:"addPoint",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t){var a=this.custompoints[t]||[];if(a.length<1);else{var o=a.filter((function(t){return t.need})).length,i=this.customparams[t],r=i.maxNum;i.key;o>r||this.custompoints[t].push({index:a.length,ts:Date.now(),pageName:n.pageName||e,step:n.step,duration:n.duration,need:!1!==n.need})}}}},{key:"endPoint",value:function(){}},{key:"pushPoint",value:function(t){if(p(this.config,"customSpeed")){var e=this.custompoints[t]||[],n=this.customparams[t]||{},a=n.key,o=n.minNum,i=void 0===o?1:o;if(!(e.length<i+1)){for(var r=0,s=1;s<e.length;s++){var u=e[s],c=u.need,f=u.step,h=u.duration,l=u.ts,m=u.pageName;if(c){var d="number"==typeof h?h:l-e[s-1].ts;this.push("wxapp.speed.custom",d,{pageName:m,key:a,step:f||"".concat(s)},l),r=s}}r>1&&this.push("wxapp.speed.custom",e[r].ts-e[0].ts,{key:a,pageName:e[r].pageName,step:"total"},e[r].ts),delete this.custompoints[t],delete this.customparams[t]}}}},{key:"pushPoints",value:function(){for(var t in this.custompoints)t&&this.pushPoint(t);this.custompoints={}}},{key:"addRequest",value:function(t){if(this._requestNum=this._requestNum||0,this._requestNum<50&&p(this.config,"request")){var e=t.key,n=t.url,a=t.time,o=t.connectType,i=t.extra;this.pushRequest("wxapp.request",a,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({url:n,key:e,connectType:o},i)),this._requestNum++}}},{key:"pushRequest",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now();this.push(t,e,n,a),this.autoReport()}},{key:"startData",value:function(){return p(this.config,"data")}},{key:"endData",value:function(t,e){var n={pageName:e.pageName};e.key&&(n.key=e.key),this.push("wxapp.data.time",t.duration,n),t.size&&this.push("wxapp.data.dataSize",t.size,n)}},{key:"pushType",value:function(t,e,n){var a=e.url,o=e.key,i=e.value;t&&a&&o&&p(this.config,n)&&(this.push(t,i||0,{url:a,key:o}),this.config.hooks(t,{url:a,key:o,value:i}))}},{key:"pushIndex",value:function(t,e,n,a){p(this.config,a)&&(this.push(t,e||0,n),this.config.hooks(t,e,n))}},{key:"pageSize",value:function(t,e){if(this._pageLeave=!0,t){var n=e.pageName;if((!this.hide[n]||this.logs.length>0)&&p(this.config,"pageSize")){var a=JSON.stringify(t).length;a&&this.push("wxapp.page.dataSize",a,{pageName:n})}this.hide[n]=!0}}},{key:"push",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now();n.pageName=n.pageName||s(),this.logs.push({type:t,ts:a,tags:c(n),value:e||0})}},{key:"preprocess",value:function(t){this.pushPoints();try{var e=this.config.get("suffix")||{};this.logs=function(t,e,n){if(!t||0===t.length)return[];var a=getCurrentPages().map((function(t){return t&&t.route||"other"})),o=a.length-1;if(o>0||e){var i=a[o],r=a[o-1],s=!!e||t.some((function(t){var e=t.tags.pageName;return e&&e!==i&&"app"!==e})),u=e||r;if(s&&u!==i){var p=e?"__at__":n&&n.from?"__from__":"";t=t.filter((function(t){var e=t.tags.pageName;return!(e&&e!==i||(e&&"app"!==e&&(t.tags.pageName="".concat(e+p+u)),0))}))}}return t}(this.logs,t,e)}catch(t){}}},{key:"autoReport",value:function(){var t=this,e=this.config.get(),n=e.autoreport,a=e.autoreportime;n&&setTimeout((function(){t.report()}),a||5e3)}},{key:"report",value:function(){if(!this.config.get("dev")){var t=this.config.get(),e=t.project,n=t.version,a=t.token,o=t.userid,s=t.whitescreen,p=[].concat(this.logs),c=p.findIndex((function(t){return"wxapp.page.tti"===t.type}));c>-1&&p[c].value>s&&p.push(Object.assign({},p[c],{type:"wxapp.page.whitescreen"}));var f=this.config.get("report");"function"==typeof f&&f(p),function(t,e,n){var a=t||{},o=a.project,s=a.version,p=a.token,c=a.userid;e&&0!==e.length&&o&&p&&s&&new Promise((function(t,e){r.networkType&&r.os?t(r):Promise.all([(i.onNetworkStatusChange&&i.onNetworkStatusChange((function(t){t&&(r.networkType=t.networkType)})),new Promise((function(t){i.getNetworkType({success:function(e){var n=e.networkType;t(n)},fail:function(){t("unknown network")}}),setTimeout((function(){t("unknown network")}),2e3)}))),new Promise((function(t,e){i.getSystemInfo({success:function(e){var n=e.SDKVersion,a=e.system,o=e.model,i=e.platform,r=e.version,s=e.appVersion,u=e.pixelRatio,p=e.screenHeight,c=e.screenWidth,f=n?n.split("."):[1,0];"devtools"!==i&&(i=a.toLowerCase().match(/ios/)?"iOS":"Android"),t({os:i,nativeVersion:s||r||"",libVersion:"".concat(f[0],".").concat(f[1]),osVersion:a.replace(/[^0-9|.]/gi,""),deviceType:o.replace(/\s/g,"_"),pixelRatio:u,screenHeight:p,screenWidth:c})},fail:function(){e("unknown system")}})}))]).then((function(e){(r=e[1]).networkType=e[0],t(r)})).catch(e)})).then((function(t){t.ts=Date.now(),t.token="string"==typeof p?p:p[i.metrics_vendor],t.appVersion=s,t.userid=c||"",t.mpPlatform=i.metrics_vendor,function t(e){if(e&&u.push(e),u.length<2){var n=u[0],a=n.complete;n.complete=function(e){u.shift(),u.length&&t(),a&&a.call(this,e)},i.request(n)}}({url:"https://dreport.meituan.net",method:"POST",data:[{category:o,env:t,logs:e}],success:function(){n&&n()}})}))}({project:e,version:n,token:a,userid:o},p)}this.logs=[],this._requestNum=0}},{key:"wxPerformStatics",value:function(){var t=this;if(!this.observed){this.observed=!0;try{var e=i.getSystemInfoSync().SDKVersion;"wx"===i.metrics_vendor&h(e,"2.11.0")>=0&&i.getPerformance&&i.getPerformance().createObserver((function(e){var n=e.getEntries()||[],a={};if(n.forEach((function(t){a[t.name]=t})),a.appLaunch&&a.firstRender){var o=a.evaluateScript,i=a.appLaunch,r=a.firstRender,s=r.startTime+r.duration-i.startTime;t.appLaunchStartTime=i.startTime,t.push("wxapp.app.tti",s,{pageName:r.path}),o&&o.duration&&t.push("wxapp.app.eval",o.duration)}else if(a.firstRender){var u=a.firstRender,p=a.route,c=p&&p.startTime||0,f=u.startTime+u.duration-c;t.push("wxapp.page.tti",f,{pageName:u.path})}})).observe({entryTypes:["render","script","navigation"]})}catch(t){}}}}])&&P(e.prototype,n),t}();function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var T=new(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=new d(e);this.config=n,this.speed=new _(n)}var e,n;return e=t,(n=[{key:"init",value:function(t){try{this.config.init(t),this.config.hooks("init")}catch(t){}}},{key:"update",value:function(t,e){this.config.update(t,e,!0)}},{key:"addRate",value:function(t){try{t=t||{},this.speed.pushType("wxapp.rate",t,"rate")}catch(t){}}},{key:"addSocket",value:function(t){try{this.speed.pushType("wxapp.socket",t||{},"socket")}catch(t){}}},{key:"addSocketOverview",value:function(t){try{this.speed.pushType("wxapp.socket.overview",t||{},"socket")}catch(t){}}},{key:"report",value:function(){}},{key:"add",value:function(t,e){try{e=e||{},"wxapp.page.fmp.time"===t?this.speed.firstMeaningfulPaint({},e):this.speed.push(t,e.value||0,e)}catch(t){}}},{key:"appFmp",value:function(t){try{this.speed.addAppFmp(t||{})}catch(t){}}},{key:"appLvc",value:function(t){try{this.speed.addAppLvc(t||{})}catch(t){}}},{key:"addPoint",value:function(t){try{var e=t||{},n=e.pageName,a=e.key,o=e.step,i=e.duration;a&&this.speed.pushIndex("wxapp.speed.custom",i,{pageName:n,key:a,step:o||"1"},"customSpeed")}catch(t){}}},{key:"addWebview",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!this.speed._start)return;e.key=t||"load";var n=e||{},a=n.value;delete e.value,"number"!=typeof a&&(a=Date.now()-this.speed._start),this.speed.pushIndex("wxapp.webview",a,e,"webview")}catch(t){}}},{key:"addHooks",value:function(t){this.config.update("hooks",t)}}])&&D(e.prototype,n),t}())({});function O(t,e){y(T,t,e)}function R(t,e){var n=e||T.config.get("page");k(T,t,n)}function M(t,e){var n=e||T.config.get("component");!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Component;if(!e.isPage){var a=e.lifetimes||e,o=a.attached,r=function(t){try{this._metricsPageName=s()}catch(t){}o&&o.call(this,t)};if(e.lifetimes&&e.lifetimes.attached)if("wx"===i.metrics_vendor){var u=i.getSystemInfoSync().SDKVersion;u&&h(u,"2.2.3")>0?e.lifetimes.attached=r:e.attached=r}else e.lifetimes.attached=r;else e.attached=r}w(t,e.methods||{},e.isPage),n(e)}(T,t,n)}function j(t,e){var n=e||T.config.get("request");return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.request;return new Promise((function(a,o){var i=e.url,r=e.metricsError,s=e.connectType,u=e.extra,p=Date.now(),c=e.complete;void 0===e.isRequest&&(e.isRequest=!0),e.complete=function(e){try{if("request:fail "!==e.errMsg){var n="success";r&&r(e)&&(n="error"),u=u&&"object"===x(u)?u:{},t.speed.addRequest({url:i,key:n,connectType:s,extra:u,time:Date.now()-p}),a(e)}else o(e)}finally{c&&c.apply(this,arguments)}},n(e)}))}(T,t,n)}function L(t){return"object"===N(t.prototype)&&y(T,t.prototype,(function(t){return t}),{onLaunch:"componentWillMount",onHide:"componentDidHide"}),t}var I=function(){};function z(t){if("object"===N(t.prototype)){var e=T.speed;k(T,t.prototype,(function(t){return t}),{onLoad:"componentWillMount",onShow:"componentDidShow",onReady:"componentDidMount",onHide:"componentDidHide",onUnload:"componentWillUnmount"});var n=t.prototype.setState;t.prototype.setState=function(t){var a=this,o="function"==typeof arguments[1]?1:2,i=arguments[3-o]||{},r=arguments[o],s=Date.now();n.call(this,t,(function(){i.needSize&&(i.fmp||i.data)&&(i.size=JSON.stringify(t).length);try{var n=Date.now();if(i.pageName=a._metricsPageName,i.fmp){var o={ts:n,time:n-s,duration:n-a._metricsStartTime,size:i.size};e.firstMeaningfulPaint(o,i)}i.data&&!0!==i.ignore&&e.startData()&&e.endData({ts:n,duration:n-s,size:i.size},i)}catch(t){}"function"==typeof r&&r()}))},delete t.prototype.metricsSetData,delete t.prototype.metricsFMP,t.prototype.metricsSetData=function(t){var e="function"==typeof arguments[1]?1:2,n=arguments[3-e]||{},a=arguments[e]||I;n.data=!0,this.setState(t,a,n)},t.prototype.metricsFMP=function(t){var e="function"==typeof arguments[1]?1:2,n=arguments[3-e]||{},a=arguments[e]||I;n.fmp=!0,this.setState(t,a,n)}}return t}}]);