var e=Object.create,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,o=Object.getOwnPropertySymbols,s=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,d=(e,r,a)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,u=o=>{return((e,o,s)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let n of a(o))i.call(e,n)||"default"===n||t(e,n,{get:()=>o[n],enumerable:!(s=r(o,n))||s.enumerable});return e})((n=t(null!=o?e(s(o)):{},"default",o&&o.__esModule&&"default"in o?{get:()=>o.default,enumerable:!0}:{value:o,enumerable:!0}),t(n,"__esModule",{value:!0})),o);var n},l=u(require("../../../../p0.js")),c=u(require("../../../../u8.js")),m=u(require("../../../../sn.js")),p=u(require("../../../../ob.js")),y=u(require("../../../../sm.js")),g=u(require("../../../../u5.js")),b=u(require("../../s1.js")),h=u(require("../../p9.js")),I=require("../../../../er.js"),{isDP:P}=require("../../../../u8.js"),_=getApp();b.default.register(_.$module),I({data:{hasContentGoodComment:!1,orderId:null,orderPoiId:null,poiIdStr_orderPoiId:null,isDP:P(),orderList:[],bottomText:"没有更多订单了",isTT:(0,c.isTT)()},onLoad(e){this.data.orderId=e.orderId,this.data.orderPoiId=e.orderPoiId,this.data.poiIdStr_orderPoiId=e.poiIdStr_orderPoiId;const t="true"===e.hasContentGoodComment;this.getOrderList(),this.setData({hasContentGoodComment:t})},gotoHomePage(){g.$lxLog.mc("b_youxuan_ny23hr79_mc"),_.$router.goto("/pages/index/index")},gotoShareSku(){g.$lxLog.mc("b_youxuan_4bqjab6g_mc"),_.$router.goto("/subPackages/orderComment/pages/share/index",{orderId:this.data.orderId,orderPoiId:this.data.orderPoiId,poiIdStr_orderPoiId:this.data.poiIdStr_orderPoiId})},getOrderList(){this.loading({loadingType:"two_dot"}),h.getOrderList({offset:0,limit:20,type:5}).then((e=>{this.loading(!1),this.setData({orderList:this.renderData(e.orderList)})})).catch((e=>{this.loading(!1),this.toast({message:e.message||"获取订单列表失败，请稍后重试"})}))},renderData(e){const t=e;return t.forEach((e=>{const t=new Date(e.orderTime);e.orderTime=(0,l.formatTime)(t),e.statusText=e.listStatusView.listTitle,e.spuCount=e.orderItemList.length,e.cashPay=(0,m.formatMoney)(e.cashPay).replace("￥",""),e.listButton=this.renderButton(e.listStatusView&&e.listStatusView.listButton),e.isGroup=1===e.type,e.tags=(e.tags||[]).map((e=>e)),e.currentSku={actPrice:e.cashPay,skuName:e.orderItemList[0].skuName,orderId:e.orderId,poiId:e.poiId,imageUrl:e.orderItemList[0].pic,skuId:e.orderItemList[0].skuId||""},e.listButton=e.listButton.filter((({type:e})=>12===e))})),t},renderButton(e){return e&&e.length?e.reduce(((e,t,r)=>{const a=((e,t)=>{for(var r in t||(t={}))i.call(t,r)&&d(e,r,t[r]);if(o)for(var r of o(t))n.call(t,r)&&d(e,r,t[r]);return e})({},t);let s={};switch(a.type){case 1:a.btnStyle="cancel";break;case 2:case 7:a.btnStyle="danger";break;case 12:a.btnStyle="warn",a.isPlain=!0;break;case 21:try{s=JSON.parse((null==a?void 0:a.extractInfo)||"{}")}catch(e){p.log.error("支付成功页面 renderButton",e)}"1"===(null==s?void 0:s.status)?(a.btnStyle="danger",a.isPlain=!0):"-1"===(null==s?void 0:s.status)&&(a.link=""),a.cashBackStatus=null==s?void 0:s.status;break;case 22:a.btnStyle="warn",a.isPlain=0!==r,a.isPlain||(a.customClass="btn-type-22-noPlain");break;default:a.btnStyle=""}return(this.canShowQrcodeBtn||!this.canShowQrcodeBtn&&16!==a.type)&&e.unshift(a),e}),[]):[]},operateOrder(e){var t,r;const{orderId:a,type:o,link:s}=e.currentTarget.dataset,i=this.data.orderList.find((e=>+e.orderId==+a));switch(o){case 12:_.$lxLog.mc("b_youxuan_i85gdr1l_mc",{order_id:a}),_.$order.gotoEvaluation("submit",a,i.poiId,i.poiIdStr,y.SUBMIT_PAGE_SOURCE.ORDER_COMMENT_SUCCESS);break;case 21:_.$lxLog.mc("b_chaoshi_7e55vfld_mc",{title:null==(t=e.currentTarget.dataset)?void 0:t.name,status:null==(r=e.currentTarget.dataset)?void 0:r.cashBackStatus}),s&&_.$router.goto(s)}},goDetail(e){const{id:t}=e.currentTarget.dataset;_.$router.goto("/pages/orderDetail/index",{orderId:t})},orderItemMvHandler(e){const{item:t}=e.currentTarget.dataset;t.listButton.some((({type:e})=>12===e))&&_.$lxLog.mv("b_youxuan_i85gdr1l_mv",{order_id:t.orderId})}});