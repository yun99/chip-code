var t=getApp();Component({properties:{initialValue:{type:Number,observer(t){this.setData({count:+t}),this.initialValue=+t}},source:{type:String,value:"cart"},showPos:{type:String,value:""},size:{type:String,value:"small"},focus:{type:Boolean,value:!1,observer(t){t&&this.setData({selectionStart:0,selectionEnd:-1})}},changeStep:{type:Number,value:1,observer(t){this.setData({changeStep:+t})}},changeUnit:{type:String,value:""},useInput:{type:Boolean,value:!1},isProcess:{type:Boolean,value:!1},showPopUp:{type:Boolean,value:!1},canReduce:{type:Boolean,value:!0},minNum:{type:Number,value:1,observer(t){this.setData({minNum:+t||1})}},maxNum:{type:Number,value:-1,observer(t){this.setData({maxNum:+t})}},displaySpecialText:{type:String,value:"",observer(t){this.setData({displaySpecialText:t||""})}},skuSellOut:{type:Boolean,value:!1},displayType:{type:String,value:"sync"},numStyle:{type:String,value:""},lxParams:{type:Object,value:{}},customStyle:{type:String,value:""}},data:{count:1,selectionStart:0,selectionEnd:-1},methods:{tapNumberUnit(){"popup"!==this.data.source&&"PURCHASE_NOW"!==this.data.source&&"refundApply"!==this.data.source&&(t.$lxLog.mc("b_chaoshi_d85wktfl_mc"),this.data.showPopUp?this.triggerEvent("togglePopUp"):t.page().toast("请点击加减号修改散装商品数量"))},tapAddBtn(){const{count:e,changeStep:a,showPopUp:s,isProcess:i,maxNum:o,showPos:u,skuSellOut:l,displayType:r,source:p,displaySpecialText:n}=this.data;if(l)return;this.lxReport(u,"add");let c=parseFloat((e+a).toFixed(3));c>9999999&&t.page().toast("已达到最大可购买数量"),~o&&c>=o&&(c=o),s&&i?this.triggerEvent("togglePopUp"):("sync"===r&&this.setData({count:c,initialValue:c}),this.triggerEvent("change",{count:c,type:"add",isButtonDisable:("popup"===p||"PURCHASE_NOW"===p)&&-1!==o&&e>=o||n||l}))},tapSubtractBtn(){const{count:e,changeStep:a,showPopUp:s,isProcess:i,canReduce:o,minNum:u,showPos:l,skuSellOut:r,displayType:p,source:n,displaySpecialText:c}=this.data;if(r)return;this.lxReport(l,"subtract");let h=parseFloat((e-a).toFixed(3));o&&(u&&h<=u?h=u:h<0&&"sync"===p&&(t.page().toast("商品数量最小为0"),h=0)),s&&i?this.triggerEvent("togglePopUp"):("sync"===p&&this.setData({count:h,initialValue:h}),this.triggerEvent("change",{count:h,type:"subtract",isButtonDisable:"PURCHASE_NOW"===n&&e<=a||u&&e<=u||c}))},onInput(e){let{value:a}=e.detail;a&&Number.isNaN(+a)&&(t.page().toast("输入内容必须为数字"),a=""),this.setData({count:a?+a:0}),this.triggerEvent("change",{count:a?+a:0})},onBlur(t){this.triggerEvent("blur",{count:t.detail.value?+t.detail.value:0})},onFocus(e){if("refundApply"===this.data.source){const e={order_id:this.data.lxParams.order_id,sku_id:this.data.lxParams.sku_id};t.$lxLog.mc("b_youxuan_yjdjz9wp_mc",e)}},reset(){this.setData({count:this.initialValue})},lxReport(e,a){const s={order_id:this.data.lxParams&&this.data.lxParams.order_id,sku_id:this.data.lxParams&&this.data.lxParams.sku_id};switch(a){case"add":"sku"===e?t.$lxLog.mc("b_chaoshi_g8nwrrfd_mc"):"process"===e?t.$lxLog.mc("b_chaoshi_lnq89jvn_mc"):"refundApply"===e&&t.$lxLog.mc("b_youxuan_k4a6xs6s_mc",s);break;case"subtract":"sku"===e?t.$lxLog.mc("b_chaoshi_z9zpwplc_mc"):"process"===e?t.$lxLog.mc("b_chaoshi_6uceftm1_mc"):"refundApply"===e&&t.$lxLog.mc("b_youxuan_7tsaecaz_mc",s);break;case"input":"refundApply"===e&&t.$lxLog.mc("b_youxuan_yjdjz9wp_mc",s)}}}});