var e=Object.create,t=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertyNames,n=Object.getOwnPropertySymbols,a=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,c=(e,r,s)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,u=r=>{return((e,r,i)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let n of o(r))d.call(e,n)||"default"===n||t(e,n,{get:()=>r[n],enumerable:!(i=s(r,n))||i.enumerable});return e})((i=t(null!=r?e(a(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0}),t(i,"__esModule",{value:!0})),r);var i},p=(e,t,r)=>new Promise(((s,i)=>{var o=e=>{try{a(r.next(e))}catch(e){i(e)}},n=e=>{try{a(r.throw(e))}catch(e){i(e)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,n);a((r=r.apply(e,t)).next())})),g=u(require("../../../../ob.js")),y=u(require("../../../../ad.js")),h=u(require("../../../../u9.js")),m=u(require("../../ak.js")),f=u(require("../../aj.js")),v=getApp(),I=require("../../../../er.js");I(new class{constructor(){var e,t;this.onLoad=function(e){return p(this,null,(function*(){wx.hideShareMenu({});const{pageFrom:t="",pickerId:r,deliveryAddress:s,poiId:i="",poiIdStr:o=""}=e;"setting"===t?this.setData({title:"提货人管理"}):t===f.fromDeliveryAddress?(this.handleDeliveryAddress(s),this.setData({title:"收货地址",nobodyTitle:"一个收货地址都没有",nobodySubTitle:"快去添加收货地址，便宜好货买买买～",nobodyBtn:"添加收货地址",poiId:i,poiIdStr:o})):this.setData({title:"提货人"}),this.setData({pageFrom:t,pickerId:r})}))},this.handleDeliveryAddress=function(e){if(e)try{const t=JSON.parse(decodeURIComponent(e));this.setData({deliveryAddress:t,onLoadDeliveryAdressIdCache:t.addressId})}catch(e){g.log.warn("JSON.parse deliveryAddress error",e)}},this.onReady=function(){},this.onShow=function(){const{pickerId:e,pageFrom:t,deliveryAddress:r}=this.data;this.initData(e,t,r),t===f.fromDeliveryAddress?v.$lxLog.pv("c_youxuan_oejxe0gt"):v.$lxLog.pv("c_youxuan_tdq5q80z"),this.setData({canGo:!1})},this.initData=function(e,t,r){return p(this,null,(function*(){var s;if(t===f.fromDeliveryAddress){const t=yield this.getDeliveryAddressList(),{userAddressInfoList:s,notInRangeAddressList:i}=t,{onLoadDeliveryAdressIdCache:o}=this.data;if(this.setData({notInRangeAddressList:i}),Array.isArray(s))this.setData({selectID:o,receiverInfoList:s,receiverInfoListLength:s.length});else{g.log.warn("<接口数据异常 getDeliveryAddressList>");const t=[],s={name:r.name,phone:r.phone,address:r.address,houseNumber:r.houseNumber};t.push(s),this.setData({selectID:e,receiverInfoList:t,receiverInfoListLength:t.length})}}else{const t=yield this.getReceiverInfo();e?this.setData({selectID:e,receiverInfoList:t,receiverInfoListLength:t.length}):this.setData({selectID:(null==(s=t[0])?void 0:s.pickerId)||"",receiverInfoList:t,receiverInfoListLength:t.length}),v.$lxLog.mv("b_youxuan_w4wreck5_mv",{num:t.length||0})}}))},this.getReceiverInfo=function(){return p(this,null,(function*(){try{const{userPickerInfoList:e}=yield(0,m.getReceiverList)();return e}catch(e){g.log.error("<接口报错 getReceiverList>",e)}}))},this.getDeliveryAddressList=function(){return p(this,null,(function*(){const{poiId:e,poiIdStr:t}=this.data;let s={sourcePoi:e,poiIdStr_sourcePoi:t};try{const e=yield h.default.getWxLocation({refresh:!0}),{latitude:t,longitude:a}=e;t&&a&&(o=((e,t)=>{for(var r in t||(t={}))d.call(t,r)&&c(e,r,t[r]);if(n)for(var r of n(t))l.call(t,r)&&c(e,r,t[r]);return e})({},s),s=r(o,i({latitude:t,longitude:a})))}catch(e){g.log.error("<getDeliveryAddressList> 获取经纬度报错",JSON.stringify(e))}var o;try{const{userAddressInfoList:e=[],notInRangeAddressList:t=[]}=yield(0,m.getDeliveryAddressList)(s);return{userAddressInfoList:e,notInRangeAddressList:t}}catch(e){return g.log.error("<接口报错 getDeliveryAddressList>",e),null}}))},this.resetClick=function(e){const{detail:t}=e,{pageFrom:r}=this.data,s={opType:f.OpType.Update,userPicker:JSON.stringify(t),pageFrom:r};r!==f.fromDeliveryAddress?v.$lxLog.mc("b_youxuan_j54mjdp0_mc"):v.$lxLog.mc("b_youxuan_ecdwwgqw_mc"),v.$router.goto("subPackages/receiverList/pages/edit/index",s)},this.changeConsignee=function(e){const{selectID:t="",pageFrom:r=""}=this.data,s=null==e?void 0:e.detail,i=+t==+s?1:0;"setting"!==r&&r!==f.fromDeliveryAddress&&v.$lxLog.mc("b_youxuan_rgrjexx7_mc",{status:i}),r!==f.fromDeliveryAddress?v.$store.setCache("pickerId",s,{isOnlyCache:!0}):(v.$lxLog.mc("b_youxuan_9mu4ibzf_mc"),v.$store.setCache("selectedAddress",s,{isOnlyCache:!0})),v.$router.triggerBack("list-changeConsignee")},this.addReceiverBtnClick=function(){if(this.data.receiverInfoListLength>=30&&this.data.pageFrom!==f.fromDeliveryAddress)return void v.page().toast("提货人数量最多30个");if(this.data.canGo)return;this.data.canGo=!0;const{pageFrom:e}=this.data,t={opType:f.OpType.Add,pageFrom:e};e!==f.fromDeliveryAddress&&v.$lxLog.mc("b_youxuan_rwv9azxy_mc"),v.$router.goto("subPackages/receiverList/pages/edit/index",t)},this.goBack=function(){v.$router.triggerBack("list-goback")},this.data={receiverInfoListLength:null,title:"",canGo:!1,selectID:null,pickerId:null,pickerType:null,pickerName:"",pickerPhone:"",label:"",pageFrom:"",isIpx:(null==(t=null==(e=v.getModule("systemInfo"))?void 0:e.getSystemInfo())?void 0:t.isIpx)||!1,isNotSupportNavigationStyle:y.isNotSupportNavigationStyle,deliveryAddress:null,onLoadDeliveryAdressIdCache:null,nobodyTitle:"一个提货人都没有",nobodySubTitle:"快去添加提货人，便宜好货买买买～",nobodyBtn:"添加提货人",poiId:"",poiIdStr:""}}});