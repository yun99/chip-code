var e,t,o=Object.create,r=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,i=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,u=(e,t,o)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,p=(e,t)=>{for(var o in t||(t={}))c.call(t,o)&&u(e,o,t[o]);if(s)for(var o of s(t))n.call(t,o)&&u(e,o,t[o]);return e},d=(e=require("../../../../er.js"),((e,t,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of l(t))c.call(e,s)||"default"===s||r(e,s,{get:()=>t[s],enumerable:!(o=a(t,s))||o.enumerable});return e})((t=r(null!=e?o(i(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0}),r(t,"__esModule",{value:!0})),e)),g=getApp();(0,d.default)({$service:getApp().$service,data:{showModal:!1,canUseCouponList:[],inCouponList:[],pageType:"select",skuBlack:[],limitDetailTitle:""},onLoad(e){this.getCouponList(e)},getCouponList(e){const t=g.$store.getCacheValue("couponList"),o=[],r=[];this.error({show:!t.length,type:"no_coupon"}),t&&t.length&&t.forEach((t=>{e.couponId&&t.id===+e.couponId?t.selected=!0:t.selected=!1,t.valid?o.push(t):r.push(t)})),this.setData({canUseCouponList:o,inCouponList:r})},changeSelected(e){g.$store.setCache("selectedCouponId",e&&e.currentTarget&&e.currentTarget.dataset&&e.currentTarget.dataset.id,{isOnlyCache:!0}),g.$router.triggerBack("coupon-couponSelect-changeSelected")},goBack(){g.$store.setCache("selectedCouponId",-1,{isOnlyCache:!0}),g.$router.triggerBack("coupon-couponSelect-goBack")},goInvalid(){g.$router.goto("igrocery://www.grocery.com/coupon_list?tab=3")},closeModal(){this.setData({showModal:!1})},showLimitDetail(e){const{index:t}=e.currentTarget.dataset,o=this.getInvalidSku(t);this.setData({showModal:!0,skuBlack:o,limitDetailTitle:this.data.inCouponList[t].limitDetailTitle})},getInvalidSku(e){const{skuBlackList:t}=this.data.inCouponList[e],o=[],r=g.$store.getCacheValue("skuProductInfo");return t.forEach((e=>{e=+e;for(let t=0;t<r.length;t++)if(+r[t].skuId!==e);else{const e=p({},r[t]);e.sellPrice=e.sellPrice?(e.sellPrice/100).toFixed(2):"0",e.promotionPrice&&(e.promotionPrice=(e.promotionPrice/100).toFixed(2)),o.push(e)}})),o}});