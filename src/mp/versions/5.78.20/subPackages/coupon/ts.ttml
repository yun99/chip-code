<import src="./ow.ttml" /><view class="coupon-container external-class" tt:if="{{processed}}"><view class="coupon-item"><image src="https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/coupon_new.0d1e155.png" class="new-coupon" tt:if="{{pageType !== 'take' && pageType !== 'submitOrder' && fresh}}"></image><image src="https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/selected_new.aaa1656.png" class="coupon-selected" tt:if="{{(valid || status === 1) && selected}}"></image><view class="cancel-tips" tt:if="{{isCancelled}}">已收回</view><view class="coupon-body" bindtap="tapCoupon"><view class="coupon-left"><view class="money {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}"><view class="money-unit" tt:if="{{reducePriceUnit&&reducePriceType!==1}}">{{reducePriceUnit}}</view><view class="money-num {{reducePriceType>=2?'mini-font':''}}">{{reducePriceNumber}}</view><text class="money-unit" tt:if="{{reducePriceUnit&&reducePriceType===1}}">{{reducePriceUnit}}</text></view><text class="limit {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}" tt:if="{{priceLimit}}">{{priceLimit}}</text></view><view class="split-line-v"></view><view class="coupon-right"><view class="name {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}">{{title}}</view><view class="rule-channel {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}" style="width: {{useRadio ? '380rpx' : 'inherit'}};">{{ruleChannel}} {{canUse}}</view><view class="coupon-bottom"><view class="valid-time-cntr"><view class="countDownTime" tt:if="{{countDownTime}}"><ie scene="daily-reward" end-time="{{countDownTime}}" is-use-end-seconds="{{false}}" />后失效</view><view class="valid-time expired {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}" tt:elif="{{expiredNoticeMsg || expiredNotice}}">{{expiredNoticeMsg || expiredNotice}}</view><view class="valid-time {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}" tt:else>{{validTime}}</view></view><block tt:if="{{!useRadio}}"><view class="coupon-right-btn use-btn" tt:if="{{btnLabel && !notLink && valid && (pageType === 'list' || pageType === 'payShareLanding')}}">{{btnLabel}}</view><view class="coupon-right-btn {{isCanUseInCart? '':'use-btn'}}" tt:if="{{btnLabel && valid && pageType==='cart'}}">{{btnLabel}}</view><view class="coupon-right-btn use-btn" tt:if="{{pageType === 'take' && !issued}}">{{ENUM.TAKE_COUPON}}</view><view class="coupon-right-btn use-btn issued" tt:if="{{pageType === 'take' && issued}}">{{ENUM.COUPON_IS_TAKED}}</view><view class="coupon-right-btn" tt:if="{{btnLabel && !valid}}">{{btnLabel}}</view></block></view><view class="coupon-select" tt:if="{{useRadio}}"><image src="https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/coupon-disable.28b1159.png" class="coupon-select-img" tt:if="{{couponDisable}}" /><block tt:else><image src="https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/coupon-selected.a63b176.png" class="coupon-select-img" tt:if="{{couponSelected}}" /><image src="https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/coupon-normal.eddb172.png" class="coupon-select-img" tt:else /></block></view></view></view></view><view class="coupon-desc"><view class="coupon-desc-cont {{pageType==='cart' && expanded ? 'desc-light' : ''}}"><view class="coupon-type {{!!expanded?'more-limit':''}}" catchtap="toggleFolding"><view class="coupon-type-left"><slot name="valid-coupon"></slot><view class="reason-cntr {{!!expanded ? '': 'reason-ellipse'}}" tt:if="{{pageType === 'cart'}}"><template is="wxParse" data="{{wxParseData: gatherTip}}"></template></view><block tt:else><view class="reason-cntr" tt:if="{{!!expanded}}"><text class="reason-text {{(valid || status === 1) && (valid || usable) ? '' : 'invalid-text'}}">{{cancelledReason}}</text><view class="reason-item" tt:for="{{ruleDetails}}" tt:key="{{index}}"><text class="reason-text {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}">{{item.ruleDetail}}</text><text class="invalid-link" data-link="{{item.validPoiBtnLink}}" catchtap="jumpToRuleLink" tt:if="{{item.validPoiBtnLabel && item.validPoiBtnLink}}">{{item.validPoiBtnLabel}}</text></view></view><view class="reason-cntr reason-ellipse" tt:else><text class="reason-text {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}" decode="{{true}}"><block>{{cancelledReason}}&nbsp;&nbsp;&nbsp;&nbsp;</block><block tt:for="{{ruleDetails}}" tt:key="index">{{item.ruleDetail}}&nbsp;&nbsp;&nbsp;&nbsp;</block></text><text class="invalid-link" data-link="{{ruleDetails[0].validPoiBtnLink}}" catchtap="lookResson" tt:if="{{ruleDetails[0].validPoiBtnLabel && ruleDetails[0].validPoiBtnLink}}">{{ruleDetails[0].validPoiBtnLabel}}</text></view></block></view><image class="image" src="https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/arrow-down.700a32.png" tt:if="{{needFolding && pageType !== 'cart' || needFolding && pageType === 'cart' && skuList && skuList.length}}"></image></view><slot name="desc-static"></slot><view class="desc-dynamic-cont {{!!expanded ? '':'hide'}}"><slot name="desc-dynamic"></slot></view></view></view><view class="coupon-disable-desc {{(valid || status === 1) && (valid || usable) || pageType === 'submitOrder' ? '' : 'invalid-text'}}" tt:if="{{useRadio && couponDisable}}">不可与已勾选的{{couponTypeName}}叠加使用</view></view>