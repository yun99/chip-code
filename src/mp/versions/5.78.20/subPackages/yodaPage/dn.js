Object.defineProperty(exports,"__esModule",{value:!0});var e,o=require("./d8.js"),t=new((e=o)&&e.__esModule?e:{default:e}).default,i={data:{voiceInfo:{}},initVoiceSDK:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.data,t=e.success,i=e.fail;this.callBackSuccess=t,this.callBackFail=i;var a=o.riskLevel.split("|");this.setData({voiceInfo:{data:o,isMobile:o.mobile,isSend:!1,show:!0,voicecode:"",opacity:.5,sendVoiceDisa:!o.mobile,verifyDisa:!0,switchText:a.length>1,mobileLable:o.mobileLable||"手机号",verifyCodeLable:o.verifyCodeLable||"验证码",smscode:"",sendSmsDisa:!o.mobile,buttonValue:o.buttonValue||"验证"}})},tapSeedVoice:function(){var e=this,o=this,i=this.data,a=i.voiceInfo,n=i.voiceInfo,c=n.isMobile,s=n.data,d=s.action,r=s.request_code,l=s.type,f=s.options,u=a.mobile;c&&(u="");var v={title:"提示",content:"您现在方便接电话么",cancelText:"不方便",cancelButtonText:"不方便",cancelColor:"#333",confirmText:"方便",confirmButtonText:"方便",confirmColor:"#000",success:function(i){i.confirm&&(wx.showLoading({title:"发送中...",mask:!0}),t.sendInfo({request_code:r,type:l,action:d,options:{mobile:u,moduleEnable:!0}}).then((function(e){wx.hideLoading();var t=e.status,i=e.error;1===t?(o.showWaitModal(),a.isSend=!0):o.handleError(i),o.setData({voiceInfo:a})})).catch((function(){t.catchCallback("打电话异常了",0,"请求打电话异常",f,e)})))}};wx.showModal?wx.showModal(v):wx.confirm&&wx.confirm(v)},bindVerify:function(){var e=this,o=this,i=this.data,a=i.voiceInfo,n=i.voiceInfo,c=n.isMobile,s=n.voicecode,d=n.data,r=d.action,l=d.request_code,f=d.type,u=d.options,v=d.listIndex,h=a.mobile;c&&(h=""),wx.showLoading({title:"验证中...",mask:!0}),t.verify({request_code:l,type:f,action:r,options:{voicecode:s,mobile:h,listIndex:v}}).then((function(i){wx.hideLoading();var a=i.status,n=i.data,c=i.error;if(1===a){if(t.nextVerify(v,n.nextVerifyMethodId))return;t.successCallback(n.request_code,n.response_code,u,e)}else o.handleError(c)})).catch((function(){t.catchCallback("验证异常",0,"请求验证异常",u,e)}))},handleError:function(e){var o=this.data.voiceInfo.data.options;t.errorCallback(e,o,this.errorExit,this)},errorExit:function(){var e=this.data.voiceInfo;e.voicecode="",e.opacity=.5,e.verifyDisa=!0,this.setData({voiceInfo:e})},showWaitModal:function(){var e=this,o=0,t=e.data.voiceInfo,i=t.codeButText,a=t.sendVoiceDisa,n=setInterval((function(){var t=e.data.voiceInfo;i=60-(o+=1)+"s后请重试",a=!0,t.sendVoiceDisa=a,t.codeButText=i,e.setData({voiceInfo:t}),60===o&&(t.codeButText="发送验证码",t.sendVoiceDisa=!1,e.setData({voiceInfo:t}),clearInterval(n))}),1e3)},bindMobileInput:function(e){var o=e.detail.value,t=this.data.voiceInfo;t.mobile=o,t.sendVoiceDisa=11!==o.length,this.setData({voiceInfo:t})},bindVoiceCodeInput:function(e){var o=e.detail.value,t=this.data.voiceInfo;t.voicecode=o,t.opacity=o.length>1&&t.isSend?1:.5,this.setData({voiceInfo:t})},yodaEvent:function(e){var o=e.detail,i=o.status,a=o.code,n=o.msg;if(1===i)this.tapSeedVoice();else{var c=this.data.voiceInfo.data.options,s={code:a,message:n};t.errorCallback(s,c,this.errorExit,this)}},changeVerify:function(){var e=this.data.voiceInfo.data;t.changeVerify(e)}};exports.default=i;