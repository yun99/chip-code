Object.defineProperty(exports,"__esModule",{value:!0});var e,t=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),a=require("./d8.js"),n=new((e=a)&&e.__esModule?e:{default:e}).default,o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.yodaUrl=getApp().globalData.yodaUrl||"https://verify.meituan.com"}return t(e,[{key:"bindImgVerify",value:function(e,t){var a=this,o=e.value,i=e.data,r=i.action,c=i.request_code,s=i.type,u=i.listIndex,l=e.opacity,d=e.fp,p=e.appletsfp,f=e.d;if(1===l){var g={captchacode:o};(u||0===u)&&(g.listIndex=u),d&&(g.fingerprint=d),p&&(g.appletsfp=p),f&&(g.d=f),wx.showLoading({title:"验证中...",mask:!0}),n.verify({request_code:c,type:s,action:r,options:g}).then((function(e){wx.hideLoading();var n=e.status,o=e.data,i=e.error;if(1===n){var r={status:1,requestCode:o&&o.origin_request_code?o.origin_request_code:c,responseCode:o&&o.response_code||"",nextVerifyMethodId:o&&o.nextVerifyMethodId||""};a.callback(r,t)}else if(121020===i.code)wx.showToast({title:"验证码错误",mask:!0,icon:"none",complete:t.bingUpdateImg()}),t.setData({value:"",opacity:.5});else{var s={status:0,code:i.code,msg:i.message,requestCode:i.request_code};a.callback(s,t)}})).catch((function(){wx.hideLoading(),a.callback({status:0,code:99999,msg:"verify请求异常"},t)}))}}},{key:"callback",value:function(e,t){t.setData({value:"",opacity:.5,isShow:"none"}),t.triggerEvent?t.triggerEvent("imageevent",e,{bubbles:!0,composed:!0}):t.props.imageevent(e)}},{key:"changeImage",value:function(e){var t=e.data.data,a=this.yodaUrl+"/v2/captcha?request_code="+t.request_code+"&action="+t.action+"&captchaHash="+Number(new Date);e.setData({imgsrc:a})}},{key:"bindImgCodeInput",value:function(e,t){var a=t.data.opacity;a=e&&e.length>1?1:.5,t.setData({value:e,opacity:a})}},{key:"changeVerify",value:function(){n.changeVerify({})}}]),e}();exports.default=o;