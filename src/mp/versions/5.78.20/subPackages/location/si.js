var e=Object.create,t=Object.defineProperty,o=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(e,o,n)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,c=(e,t)=>{for(var o in t||(t={}))a.call(t,o)&&s(e,o,t[o]);if(l)for(var o of l(t))r.call(t,o)&&s(e,o,t[o]);return e},u=e=>t(e,"__esModule",{value:!0}),p=l=>((e,l,i)=>{if(l&&"object"==typeof l||"function"==typeof l)for(let r of n(l))a.call(e,r)||"default"===r||t(e,r,{get:()=>l[r],enumerable:!(i=o(l,r))||i.enumerable});return e})(u(t(null!=l?e(i(l)):{},"default",l&&l.__esModule&&"default"in l?{get:()=>l.default,enumerable:!0}:{value:l,enumerable:!0})),l);((e,o)=>{for(var n in u(e),o)t(e,n,{get:o[n],enumerable:!0})})(exports,{default:()=>h});var m=p(require("../../ob.js")),f=p(require("./sp.js")),{convertPxToRpx:g}=require("../../p0.js"),y=getApp(),h=class{constructor(){var e,t;this.isIpx=null==(t=null==(e=y.getModule("systemInfo"))?void 0:e.getSystemInfo())?void 0:t.isIpx,this.mapHeight=0,this.windowHeight=0}genInitLayoutModel(e){return t=this,o=null,n=function*(){let t=null;try{t=yield this._caclayout(e)}catch(e){m.log.info("genInitLayoutModel e",e)}return c({isIpx:this.isIpx,contentState:0},t)},new Promise(((e,l)=>{var i=e=>{try{r(n.next(e))}catch(e){l(e)}},a=e=>{try{r(n.throw(e))}catch(e){l(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,a);r((n=n.apply(t,o)).next())}));var t,o,n}_caclayout(e){return new Promise((t=>{var o,n;let l=null==(n=null==(o=y.getModule("systemInfo"))?void 0:o.getSystemInfo())?void 0:n.windowHeight;this.windowHeight=l;const i=g(92);let a={};try{wx.createSelectorQuery().in(e).select("#map-container").boundingClientRect().exec((e=>{const o=e[0];m.log.info("_caclayout mapRes",o);const{height:n}=o,l=g(n);this.mapHeight=l;const a=.65*l,r=l-a;t({contnetTop:r,contnetHeight:a,scrollHeight:a-i,minOffsetTop:r,maxOffsetTop:.6*l,mapHeight:.73*l})}))}catch(e){m.log.info("_caclayout e",e),l=g(l);const o=.65*l,n=l-o;a={contnetTop:n,contnetHeight:o,scrollHeight:o-i,minOffsetTop:n,maxOffsetTop:.6*l,mapHeight:.73*o},t(a)}}))}updateUpState(e,t){const o=c({},e),{maxOffsetTop:n,minOffsetTop:l}=e;return t===f.UPDATE_STATE.DOWN?(o.contnetTop=n,o.contentState=1):(o.contnetTop=l,o.contentState=0),o}updateLayoutWithModel(e){var t,o;const n=g(92);let l=0,i=0;if(e&&e.type===f.MAP_TYPE.LIST)l=this.mapHeight;else{let e=this.windowHeight?this.windowHeight:null==(o=null==(t=y.getModule("systemInfo"))?void 0:t.getSystemInfo())?void 0:o.windowHeight;e=g(e),l=e,i=g(50)}const a=.65*l,r=l-a;return{contnetTop:r,contnetHeight:a,scrollHeight:a-n-i,minOffsetTop:r,maxOffsetTop:.6*l,mapHeight:.73*l,isIpx:this.isIpx,contentState:0}}};