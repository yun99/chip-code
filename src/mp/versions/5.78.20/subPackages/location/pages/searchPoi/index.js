var t=Object.create,e=Object.defineProperty,i=Object.defineProperties,s=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertyNames,r=Object.getOwnPropertySymbols,n=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s,l=(t,e)=>{for(var i in e||(e={}))c.call(e,i)&&u(t,i,e[i]);if(r)for(var i of r(e))d.call(e,i)&&u(t,i,e[i]);return t},h=i=>{return((t,i,o)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let r of a(i))c.call(t,r)||"default"===r||e(t,r,{get:()=>i[r],enumerable:!(o=s(i,r))||o.enumerable});return t})((o=e(null!=i?t(n(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0}),e(o,"__esModule",{value:!0})),i);var o},p=h(require("../../so.js")),y=h(require("../../sf.js")),m=h(require("../../sd.js")),f=h(require("../../sg.js")),g=h(require("../../../../ob.js")),S=h(require("../../as.js")),w=h(require("../../sa.js")),x=require("../../../../er.js"),_=getApp(),L="selfliftPoiMap";x(new class{constructor(){var t,e;this.onLoad=function(t){const{from:e=L,showCityListView:i}=t||{};this.options=t,g.log.info("serchPoi ---\x3e options ",t),e===L&&this.handleSelfLiftMapFrom(t),this.refreshData()},this.handleSelfLiftMapFrom=function(t){const{cityAddress:e}=t||{},i=e?decodeURIComponent(e):null;if(i)try{const t=JSON.parse(i);g.log.info("handleSelfLiftMapFrom ",t),this.setData({cityAddress:t})}catch(t){}},this.onShow=function(){},this.onReady=function(){var t;this.refreshData(),(null==(t=this.options)?void 0:t.showCityListView)&&this.setShowCityListView(!0)},this.needGetPoiModal=function(){return!1},this.setSearchList=function(t){const{poiList:e=[],addrList:s=[]}=this.data.searchResult,{show:a=this.data.showSearchList,poiList:r=e,addrList:n=s}=t.detail,c=r.map((t=>{return e=l({},t),i(e,o({imageBid:"b_youxuan_ef1fvd20_mc"}));var e}));this.setData({showSearchList:a,searchResult:{poiList:c,addrList:n}}),this.setShowCityListView(!1)},this.showCityList=function(t){this.setShowCityListView(t.detail.showCityListView)},this.onCitySelect=function(t){const e=t.detail;this.setData({focusin:!0,cityAddress:e}),this.setShowCityListView(!1)},this.onCitySelectorClose=function(){this.setShowCityListView(!1)},this.setShowCityListView=function(t=!1){return this.showCitySelector(t)},this.showCitySelector=function(t=!1){return this.setData({showCityListView:t})},this.refreshData=function(){this.data.historyAddress=[],this.data.historyPoi=[];const t=(0,p.getSearchChoiceStore)();if(t){const e=t[y.Type.ADDRESS]||[],i=t[y.Type.POI]||[];(e.length||i.length)&&this.setData({historyAddress:e,historyPoi:i})}},this.searchResultCheckPoi=function(t){var e;const{index:i,value:s}=t.currentTarget.dataset||{};_.$lxLog.mc("b_youxuan_udbkvav7_mc",{click_poiid:(null==s?void 0:s.poiId)||_.$poiId,poiIdStr_click_poiid:(null==s?void 0:s.poiIdStr)||(null==(e=null==_?void 0:_.$poi)?void 0:e.getPoiIdStr())||"",index:i},{cid:"c_youxuan_sdqnq297"}),this.onPoiCardSelect(s)},this.searchResultCheckAddress=function(t){const{index:e,value:i}=t.currentTarget.dataset||{};_.$lxLog.mc("b_youxuan_zmhsqzf6_mc",{index_id:e},{cid:"c_youxuan_sdqnq297"}),this.onSearchAddrTap({detail:i})},this.searchPoiCardTap=function(t){const e=t.detail;e&&(e.poiIdStr||e.poiId>0)&&(_.$lxLog.mc("b_youxuan_unv5ygpz_mc",{click_poiid:e.poiId||"",poiIdStr_click_poiid:e.poiIdStr||"",index_id:e._index,label_name:e.label_name,page_from:"searchPoi"}),this.onPoiCardSelect(e))},this.onSearchAddrTap=function(t){var e;const{address:i,longitude:s,latitude:o,addressLoc:a,_index:r}=t.detail;_.$lxLog.mc("b_youxuan_sp4hfxj6_mc",{index_id:r}),(0,p.setHistoryAddress)(i,t.detail);const n={address:i,addressLoc:a,longitude:s,latitude:o,source:`${this.data.source}_onSearchAddrTap`};this.setData({showSearchList:!1}),(0,m.setAddrCache)(n),(0,p.setSerchPoiAdress)(n),(null==(e=this.options)?void 0:e.showCityListView)?w.default.chooseOtherSelfLift(!0,{}):_.$router.triggerBack("SearchPage")},this.switchPoiConfirm=function(t,e,i=this.data.poi){const{poiName:s="",distanceText:o="",address:a="",picUrl:r=""}=i;return this.confirmModal({title:"请确认切换自提点",message:"确认切换后，您需要前往该自提点提货",textCancel:"取消",textOK:"确认",customContentStyle:"text-align: center",poi:{poiName:s,distanceText:o,address:a,picUrl:r},cancel:()=>{_.$lxLog.mc("b_youxuan_43x3nnpd_mc"),e&&e()},ok:()=>{_.$lxLog.mc("b_youxuan_7ertq2jj_mc"),t&&t()}})},this.onPoiCardSelect=function(t){if(1!==t.poiBusinessStatus)return void _.page().toast("当前门店已经下线了～");const{from:e}=this.data;if(this.setData({poi:l({},t),selectedPoi:t}),(0,f.isFromNative)(e))return this.switchPoiConfirm((()=>{(0,S.navigateBackNative)(l({},this.tranfromPoiforNative(t)))}));w.default.exitSelfLift({poi:t,success:()=>{_.page().toast("切换自提点成功")}})},this.data={showSearchList:!1,searchResult:{poiList:[],addrList:[]},showStoreList:!1,storeListData:[],cityAddress:{},currentCityAddress:{},showCityListView:!1,reloadMyAddress:"",focusin:!1,from:L,skuId:"",errorViewType:"",myPoiErrorViewType:"",position:void 0,chooseAddress:"",backToSumbitOrderWhenGoodsInvalid:!1,selectLocation:{},isSearchPage:!0,isIpx:null==(e=null==(t=_.getModule("systemInfo"))?void 0:t.getSystemInfo())?void 0:e.isIpx,isInitSelector:!1}}});