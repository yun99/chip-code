var e,a,t=Object.create,r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,l=e=>{return((e,a,t)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let s of n(a))u.call(e,s)||"default"===s||r(e,s,{get:()=>a[s],enumerable:!(t=o(a,s))||t.enumerable});return e})((a=r(null!=e?t(s(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0}),r(a,"__esModule",{value:!0})),e);var a},c=l(require("../../../../ob.js")),i=l(require("../../ps.js")),m=require("../../../../er.js"),g=getApp(),{$event:p}=g,{UPDATE_USER_NAME_SUCCESS:d,BACK_FROM_USER_INFO:y}=p.CONTANTS;(a=e||(e={}))[a.NO_TOKEN=1]="NO_TOKEN",a[a.BAD_RESP=2]="BAD_RESP",a[a.BAD_REQ=3]="BAD_REQ",a[a.BACKEND_ERR=4]="BACKEND_ERR",a[a.BAD_NAME=5]="BAD_NAME",m({data:{originUserName:"",originAvatarUrl:"",userName:"",avatarUrl:"",canvasWidth:0,canvasHeight:0},onLoad(e){const{userName:a="",avatarUrl:t=""}=e;this.setData({originUserName:decodeURIComponent(a),originAvatarUrl:decodeURIComponent(t),userName:decodeURIComponent(a),avatarUrl:decodeURIComponent(t)}),p.on(d,(e=>{this.setData({userName:e}),setTimeout((()=>{g.page().toast("昵称已设置")}),500)}))},onShow(){g.$lxLog.pv("c_youxuan_svuqjajj")},onUnload(){const{userName:e,avatarUrl:a,originUserName:t,originAvatarUrl:r}=this.data;e===t&&a===r||p.emit(y,{userName:e,avatarUrl:a})},handleChangeAvatar(){return e=this,a=null,t=function*(){g.$lxLog.mc("b_youxuan_oym25q0j_mc");try{const e=yield(0,i.changeAvatar)(),{avatarurl:a=""}=e;this.setData({avatarUrl:a}),(0,i.updateMTUserInfo)({avatarurl:a})}catch(e){const{tip:a}=e;a?g.page().toast(a):e.errMsg&&"chooseImage:fail cancel"===e.errMsg?c.log.warn("用户取消选择头像图片",e.errMsg):g.page().toast("更新头像失败"),c.log.warn("更新头像失败",JSON.stringify(e)),c.log.warn("更新头像失败->",JSON.stringify(e.message))}},new Promise(((r,o)=>{var n=e=>{try{u(t.next(e))}catch(e){o(e)}},s=e=>{try{u(t.throw(e))}catch(e){o(e)}},u=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,s);u((t=t.apply(e,a)).next())}));var e,a,t},changeUserName(){g.$lxLog.mc("b_youxuan_eb09b2gu_mc");const{userName:e}=this.data;g.$router.goto("/subPackages/userInfo/pages/edit/index",{userName:e})}});