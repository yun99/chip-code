var e=require("./zc.js");function t(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)}))}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function f(e){var t="function"==typeof Map?new Map:void 0;return f=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return p(e,arguments,g(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)},f(e)}function p(){return(p=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&d(i,n.prototype),i}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t){for(var n in t)e[n]=t[n];t.__esModule&&Object.defineProperty(e,"__esModule",{value:!0})}(exports,function(){var i={52:function(i,o,a){a.r(o),a.d(o,{API_TYPE:function(){return C},CardComponent:function(){return mn},EntryPage:function(){return hn},SDKError:function(){return m},SessionEvent:function(){return Oe},SessionState:function(){return xe},WxAPIError:function(){return b},WxRequestError:function(){return w},_internal_API_TYPE:function(){return C},_internal_MtAPIError:function(){return y},_internal_SDKError:function(){return m},_internal_SessionEvent:function(){return Oe},_internal__getAuthInfo:function(){return Ft},_internal_appConfig:function(){return O},_internal_authState:function(){return We},_internal_bindPageOption:function(){return D},_internal_changeBindPageOption:function(){return N},_internal_changeBindPhoneState:function(){return Ke},_internal_checkSession:function(){return ne},_internal_clearVerifyState:function(){return Me},_internal_composedErrorHandler:function(){return At},_internal_customLoginCheck:function(){return tn},_internal_destroySession:function(){return qe},_internal_getCfrmPageRej:function(){return jn},_internal_getCfrmPageRes:function(){return Sn},_internal_getExtInfo:function(){return Fr},_internal_getLoginCode:function(){return X},_internal_getNewCode:function(){return qr},_internal_getPageData:function(){return Br},_internal_getStorage:function(){return z},_internal_getUUID:function(){return je},_internal_getVerifyInfo:function(){return Kr},_internal_getWaitYodaRej:function(){return Un},_internal_getWaitYodaRes:function(){return Ln},_internal_gotoPhoneConfirm:function(){return Pn},_internal_mobileLoginApply:function(){return jt},_internal_mobileLoginV3:function(){return Pt},_internal_navBack:function(){return Z},_internal_navBackAll:function(){return Zt},_internal_navigate:function(){return ie},_internal_onPageErr:function(){return Qt},_internal_parse:function(){return Mr.parse},_internal_processProtocolConfig:function(){return rn},_internal_protocolConfig:function(){return H},_internal_routeConfig:function(){return I},_internal_saveAuthInfoAndGoBack:function(){return en},_internal_setAuthInfo:function(){return Dt},_internal_showTip:function(){return ee},_internal_showToast:function(){return te},_internal_smartCheck:function(){return Wr},_internal_ticketLogin:function(){return vt},_internal_tips:function(){return W},_internal_verifyNewPhone:function(){return Vr},_internal_verifyState:function(){return Fe},_internal_verifylogin:function(){return mt},_internal_version:function(){return se},_internal_wxMobileBindApplyV2:function(){return _t},_internal_wxMobileBindLoginV2:function(){return Ct},_internal_wxTicketLoginV2:function(){return St},_internal_yodaVfyRej:function(){return Bn},_internal_yodaVfyRes:function(){return Dn},authState:function(){return We},changeBindPhone:function(){return Hn},cleanLogin:function(){return Cn},cleanLoginSP:function(){return nr},config:function(){return k},destroySession:function(){return qe},finger:function(){return Te()},getAuthInfo:function(){return Kt},getAuthInfoSync:function(){return Bt},getEnv:function(){return pe},getMtInfo:function(){return Sr},getMtInfoSync:function(){return Cr},getSdkEnv:function(){return ce},getWxIds:function(){return gr},getWxIdsSync:function(){return dr},getWxInfo:function(){return mr},getWxInfoSync:function(){return yr},getWxUserInfo:function(){return Hr},isLogout:function(){return Qn},login:function(){return xn},loginSP:function(){return er},logout:function(){return $n},mobileLogin:function(){return fn},removeAuthInfo:function(){return zt},routeConfig:function(){return I},setAppConfig:function(){return E},setAuthRoute:function(){return P},setAuthrizePageOption:function(){return K},setBindPageOption:function(){return B},setChangeBindPageOption:function(){return A},setEnv:function(){return fe},setLoginCheck:function(){return M},setLoginPageOption:function(){return U},setSdkRoute:function(){return R},setYodaRoute:function(){return T},unlockAccount:function(){return Zn},updateMtInfo:function(){return Dr},updateWxInfo:function(){return vr},updateWxUserInfo:function(){return Gr},utils:function(){return on},version:function(){return se},webViewPage:function(){return rr},wxLogin:function(){return Jn},wxMobileLogin:function(){return qn},yodaConfig:function(){return p}});var p={};a.r(p),a.d(p,{baseUrl:function(){return ar},getInfoUrl:function(){return cr},getPageDataUrl:function(){return ur},getVerifyUrl:function(){return fr},getYodaBaseUrl:function(){return sr},setYodaUrl:function(){return pr}}),a(778);var l,d,g=require("./zv.js");(d=l||(l={})).WXAPIError="WXAPIError",d.WXRequestError="WXRequestError",d.MTAPIError="MTAPIError",d.SDKError="SDKError",d.UnExpected="Unexpected";var h=function(e){return e.errType===l.MTAPIError},b=function(e){function t(n,r){var i,o="Wechat API "+n+" get error result: [msg]: "+r;return(i=e.call(this,o)||this).errType=l.WXAPIError,i.api=n,i.desc=o,i.msg="内部错误，请重试",Object.setPrototypeOf(u(i),t.prototype),i}return c(t,e),t}(f(Error)),w=function(e){function t(n,r){var i,o="Request "+r+" failed: "+n;return(i=e.call(this,o)||this).errType=l.WXRequestError,i.desc=o,i.msg="网络故障，请稍后再试",Object.setPrototypeOf(u(i),t.prototype),i}return c(t,e),t}(f(Error)),y=function(e){function t(n,r,i){var o,a=r.code,s=r.message,c="API "+n+" return code: "+a+" with message: "+s;return(o=e.call(this,c)||this).code=a,o.errType=l.MTAPIError,o.desc=c,o.tip=s,o.msg=s||"服务器出错，请稍后重试",o.trace=i,Object.setPrototypeOf(u(o),t.prototype),o}return c(t,e),t}(f(Error)),m=function(e){function t(n,r,i,o){var a;void 0===o&&(o=!1);var s="登陆无法完成: "+n;return(a=e.call(this,s)||this).errType=l.SDKError,a.desc=s,a.tip=n,a.trace=r,a.errCode=i,a.show=o,Object.setPrototypeOf(u(a),t.prototype),a}return c(t,e),t}(f(Error)),v=a(769),x=a.n(v)()||{},k=x,O=k.appConfig,I={loginRoute:"",waitYodaRoute:"",bindRoute:"",smsVerifyRoute:"",authRoute:"",changeBindPhoneRoute:"",webviewRoute:"",phoneRoute:"",yodaRoute:"",_route:"",set sdkRoute(e){this._route=e,this.loginRoute=e+"/entry/index",this.bindRoute=e+"/bind/index",this.changeBindPhoneRoute=e+"/change-bind-phone/index",this.webviewRoute=e+"/webview/index",this.yodaRoute=e+"/yoda-verify/index",this.phoneRoute=e+"/confirm-phone/index",this.waitYodaRoute=e+"/wait-yoda/index"},get sdkRoute(){return this._route}};I.sdkRoute=k.route,I.authRoute=k.authRoute;var _,C,S,j,P=function(e){I.authRoute=e},T=function(e){I.smsVerifyRoute=e},E=function(e){Object.assign(O,e)},R=function(e){e.startsWith("/")||(e="/"+e),I.sdkRoute=e},L=k.entryPageOption,U=function(e){Object.assign(L,e)},N=k.changeBindPageOption,A=function(e){Object.assign(N,e)},D=k.bindPageOption,B=function(e){Object.assign(D,e)},F=k.authrizePageOption,K=function(e){Object.assign(F,e)},M=function(e){_=e},W=k.tips,q=k.showModal;(S=C||(C={})).WX_MOBILE="wxMobileLogin",S.WXV2="wxLogin",S.MOBILE="mobileLogin",S.LOGIN="login",S.CHANGE_BIND="changeBind",(j||(j={})).create="createSession";var V,J,G,H=k.protocolConfig,Y=function(e,t){return void 0===t&&(t={}),new Promise((function(n,r){var i=t,o=i.header,a=void 0===o?{}:o,s=i.query,u=i.type,c=(i.success,i.fail,i.complete,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["header","query","type","success","fail","complete"]));"form"===u&&(a["content-type"]="application/x-www-form-urlencoded"),s&&(e+=(e.includes("?")?"&":"?")+(0,g.stringify)(s));var f=Object.assign({url:e,header:a,unforced:!0,success:function(t){t&&t.data?n(t.data):r(new w("No data in response: "+JSON.stringify(t),e))},fail:function(t){r(new w("fail to request: "+JSON.stringify(t),e))}},c),p=O.wxReq||wx.request;O.finger?O.finger.then((function(e){p(e.sign(f))})):p(f)}))},X=(V=s(e.mark((function t(n){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n){e.next=5;break}return e.next=4,new Promise((function(e,t){wx.login({success:function(n){n&&n.code?e(n.code):t(new b("wx.login","null login result: "+JSON.stringify(n)))},fail:function(e){t(new b("wx.login",JSON.stringify(e)))}})}));case 4:return e.abrupt("return",e.sent);case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),t)}))),function(){return V.apply(this,arguments)}),z=function(e){return new Promise((function(t,n){wx.getStorage({key:e,success:function(e){e&&e.data?t(e.data):n(new b("getStorage","null result: "+JSON.stringify(e)))},fail:function(e){n(new b("getStorage",JSON.stringify(e)))}})}))},$=function(e,t){return new Promise((function(n,r){wx.setStorage({key:e,data:t,success:function(){n()},fail:function(e){r(new b("setStorage",JSON.stringify(e)))}})}))},Q=function(e){return new Promise((function(t,n){wx.removeStorage({key:e,success:function(){t()},fail:function(e){n(new b("removeStorage",JSON.stringify(e)))}})}))},Z=function(e){return void 0===e&&(e=1),new Promise((function(t){wx.navigateBack({delta:e,success:function(){t()},fail:function(e){t()}})}))},ee=function(e,t){var n=void 0===t?{}:t,r=n.title,i=void 0===r?"提示":r,o=n.showCancel,a=void 0!==o&&o,s=n.cancelText,u=void 0===s?"取消":s,c=n.confirmText,f=void 0===c?q.confirmText||"确定":c;return new Promise((function(t,n){wx.showModal(Object.assign(Object.assign({title:i,content:e||"",showCancel:a},a&&{cancelText:u}),{confirmText:f,success:function(e){t(!a||e&&e.confirm)},fail:function(e){n(new b("wx.showModal",JSON.stringify(e)))}}))}))},te=(J=s(e.mark((function t(n,r,i){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r="success"),void 0===i&&(i=2e3),!n||!n.length){e.next=4;break}return e.abrupt("return",new Promise((function(e){wx.showToast({title:n,mask:!0,icon:r,duration:i,success:function(){e()},fail:function(t){e()}})})));case 4:case"end":return e.stop()}}),t)}))),function(){return J.apply(this,arguments)}),ne=function(){return new Promise((function(e){wx.checkSession({success:function(){e(!0)},fail:function(){e(!1)}})}))},re=!1,ie=(G=s(e.mark((function t(n,r,i,o){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=n.replace(/^\/|\?.*$/g,"")),void 0===i&&(i=!1),void 0===o&&(o=!1),re){e.next=5;break}return e.abrupt("return",new Promise((function(e,t){re=!0,setTimeout((function(){re=!1}),200);var r="navigateTo";r=o?"reLaunch":i?"redirectTo":"navigateTo",wx[r]({url:n,success:e,fail:function(e){t(new b("wx."+r,JSON.stringify(e)))}})})));case 5:case"end":return e.stop()}}),t)}))),function(){return G.apply(this,arguments)}),oe=function(){return new Promise((function(e){wx.getSetting({success:function(t){e(t)},fail:function(t){e({})}})}))},ae=function(e){return new Promise((function(t){wx.getUserInfo(Object.assign(Object.assign({},e),{success:function(e){t(e)},fail:function(e){t({})}}))}))},se="3.7.3",ue={env:x?x.env:""},ce=function(){return ue.env},fe=function(e){ue.env=e},pe=ce,le="https://portal-portm.meituan.com/weapp/loginsdk/api/",de=function(){return le+(ce()?ce()+"/":"")};de(),de();var ge,he,be,we,ye,me,ve,xe,ke,Oe,Ie,_e=function(e){return e&&"string"==typeof e&&e.length>=40&&e.length<=80},Ce=(he=s(e.mark((function t(n){var r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le((t=void 0,"portm"===x.api?le+"uuid":"https://i.meituan.com/uuid/register?f="+t)).catch((function(e){}));case 2:if(r=e.sent,_e(r)){e.next=8;break}if(!(n>0)){e.next=8;break}return e.next=7,Ce(n-1);case 7:return e.abrupt("return",e.sent);case 8:return e.abrupt("return",r||"");case 9:case"end":return e.stop()}var t}),t)}))),function(){return he.apply(this,arguments)}),Se=(be=s(e.mark((function t(){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.persistKey){e.next=2;break}return e.abrupt("return",z(O.persistKey).then((function(e){return e&&e.uuid})).catch((function(){return""})));case 2:return e.abrupt("return","");case 3:case"end":return e.stop()}}),t)}))),function(){return be.apply(this,arguments)}),je=(we=s(e.mark((function t(n,r){var i,o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=1),i=O.uuid,!_e(o=void 0===i?"":i)){e.next=4;break}return e.abrupt("return",o);case 4:if(!_e(ge)){e.next=6;break}return e.abrupt("return",ge);case 6:return e.next=8,Se();case 8:if(a=e.sent,!_e(a)){e.next=11;break}return e.abrupt("return",ge=a);case 11:return e.next=13,Ce(r);case 13:return s=e.sent,e.abrupt("return",ge=s);case 15:case"end":return e.stop()}}),t)}))),function(){return we.apply(this,arguments)}),Pe=require("./zn.js"),Te=a.n(Pe),Ee=function(){return ye||new Promise((function(e){Te().g(e)})).then((function(e){return ye=e,e})).catch((function(e){throw new m("获取指纹信息失败："+(e&&e.message),void 0,127)}))},Re=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Le=(me=s(e.mark((function t(n,r){var i,o,a,s,u,c,f,p,l,d,g,h,b,w,y,m,v,x,k,I,_,C,S,j,P,T,E,R;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r={}),o=(i=r).query,a=i.data,s=i.bypass,u=void 0!==s&&s,c=Re(r,["query","data","bypass"]),!u){e.next=6;break}return e.next=5,Y(n,Object.assign(Object.assign({},c),{data:a,query:o}));case 5:case 11:return e.abrupt("return",e.sent);case 6:return f=O.passThroughData,p=O.appName,l=void 0===p?"":p,d=O.risk_app,g=void 0===d?"":d,h=O.risk_partner,b=void 0===h?"":h,w=O.risk_platform,y=void 0===w?"":w,m=O.risk_smsPrefixId,v=void 0===m?"":m,x=O.risk_smsTemplateId,k=void 0===x?"":x,I=O.version_name,_=void 0===I?"":I,C=O.token_id,S=void 0===C?"":C,j=wx.getSystemInfoSync(),P=j.platform,T=j.version,E=j.model,R=void 0===E?"":E,P="ios"===P.toLowerCase()?"iphone":P.toLowerCase(),e.next=11,Y(n,Object.assign(Object.assign({},c),{query:Object.assign(Object.assign(Object.assign({},o),{sdkVersion:T,utm_medium:P,sdkType:"wxmp",login_sdk_version:"3.7.3"}),{appName:l,risk_app:g,risk_partner:b,risk_platform:y,risk_smsPrefixId:v,risk_smsTemplateId:k,version_name:_,token_id:S}),data:Object.assign(Object.assign(Object.assign({},a),f&&{passThroughData:"string"==typeof f?f:JSON.stringify(f)}),{device_type:R,device_os:"微信小程序"})}));case 12:case"end":return e.stop()}}),t)}))),function(){return me.apply(this,arguments)}),Ue=(ve=s(e.mark((function t(n){var i,o,a,s,u,c,f,p,l,d,h,b,y,m,v,x,k,I,_,C,S,j,P,T,E,R,L,U,N,A,D,B;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.url,n.success,n.fail,o=n.filePath,a=n.formData,n.method,s=n.header,n.complete,u=Re(n,["url","success","fail","filePath","formData","method","header","complete"]),o){e.next=5;break}return e.next=4,Le(i,Object.assign({data:a,type:"form",method:"POST"},u));case 4:return e.abrupt("return",e.sent);case 5:return c=O.passThroughData,f=O.appName,p=void 0===f?"":f,l=O.risk_app,d=void 0===l?"":l,h=O.risk_partner,b=void 0===h?"":h,y=O.risk_platform,m=void 0===y?"":y,v=O.risk_smsPrefixId,x=void 0===v?"":v,k=O.risk_smsTemplateId,I=void 0===k?"":k,_=O.version_name,C=void 0===_?"":_,S=O.token_id,j=void 0===S?"":S,P=wx.getSystemInfoSync(),T=P.platform,E=P.version,R=P.model,L=void 0===R?"":R,T="ios"===T.toLowerCase()?"iphone":T.toLowerCase(),e.next=10,Promise.all([je(),Ee()]);case 10:return U=e.sent,N=r(U,2),A=N[0],D=N[1],(B=Object.assign({sdkVersion:E,utm_medium:T,sdkType:"wxmp",login_sdk_version:"3.7.3"},{appName:p,risk_app:d,risk_partner:b,risk_platform:m,risk_smsPrefixId:x,risk_smsTemplateId:I,version_name:C,token_id:j}))&&(i+=(~i.indexOf("?")?"&":"?")+(0,g.stringify)(B)),e.abrupt("return",new Promise((function(e,t){return(O.wxUploadFile||wx.uploadFile)(Object.assign({url:i,success:function(n){n&&n.data&&e(JSON.parse(n.data)),t(new w("wx.uploadFile 返回的data为null："+JSON.stringify(n),i))},name:"newAvatar",filePath:o,fail:function(e){t(new w("wx.uploadFile crash: "+JSON.stringify(e),i))},header:s,formData:Object.assign(Object.assign(Object.assign({},a),{uuid:A,wechatFingerprint:D,device_type:L,device_os:"微信小程序"}),c&&{passThroughData:"string"==typeof c?c:JSON.stringify(c)})},u))})));case 17:case"end":return e.stop()}}),t)}))),function(){return ve.apply(this,arguments)}),Ne=require("./zx.js");(ke=xe||(xe={})).AUTH="auth",ke.BINDING="bind",ke.DESTORY="destory",ke.ABORT="abort",(Ie=Oe||(Oe={})).CLICK="click",Ie.SMSCLICK="smsclick",Ie.LOGINCLICK="loginclick",Ie.BINDPAGEONSHOW="bindpageonshow",Ie.NAVIBACK="naviback",Ie.CLOSECARD="closecard",Ie.ENTRYPAGEONSHOW="entrypageonshow",Ie.CHANGEPHONEPAGEONSHOW="changebindpageonshow",Ie.ALLOWPHONE="allowphone",Ie.REFUSEPHONE="refusephone",Ie.CHANGEPHONEGETNEWCODE="changephonegetnewcode",Ie.CHANGEPHONECHNAGEBTN="changephonechnagebtn",Ie.AUTHPAGEONSHOW="authpageonshow",Ie.ALLOWUSERINFO="allowuserinfo",Ie.REFUSEUSERINFO="refuseuserinfo",Ie.USERINFOCLICK="userinfoclick",Ie.ENTRYPAGEREFUSEUSERINFO="entrypagerefuseuserinfo",Ie.ENTRYPAGEALLOWUSERINFO="entrypageallowuserinfo";var Ae,De,Be=function(){function e(e,t,n){void 0===t&&(t=xe.AUTH),this._callbacks={},this.type=e,this.state=t,n&&(this.expire=(new Date).getTime()+n)}var t,r,i,o=e.prototype;return o._state=function(e,t){this.state=e,t&&(this.data=t),this._emit(e,t)},o._emit=function(e,t){var n=this,r=this._callbacks[e];r&&r.forEach((function(e){e.call(n,t),n.destroyAfterCb&&qe()}))},o.on=function(e,t){(this._callbacks[e]=this._callbacks[e]||[]).push(t)},o.clean=function(){this._callbacks={},this.resolve=null,this.sF=void 0},o.abort=function(){this._state(xe.ABORT)},t=e,(r=[{key:"expired",get:function(){return!!this.expire&&this.expire<(new Date).getTime()}}])&&n(t.prototype,r),i&&n(t,i),e}(),Fe={},Ke={},Me=function(){Fe.userTicket="",Fe.mobile="",Fe.baseInfo=null},We={get session(){return Ae},set session(e){Ae&&Ae._state(xe.DESTORY),Ae=e}},qe=function(){We.session=null},Ve={pageOnshow:function(){We.session&&We.session._emit(Oe.AUTHPAGEONSHOW,We.session)},allowAuth:function(){We.session&&We.session._emit(Oe.ALLOWUSERINFO,We.session)},refuseAuth:function(){We.session&&We.session._emit(Oe.REFUSEUSERINFO,We.session)},userInfoClick:function(){We.session&&We.session._emit(Oe.USERINFOCLICK,We.session)}},Je=(De=s(e.mark((function t(n){var r,i,o;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),wx.getUserProfile){e.next=11;break}return e.next=4,oe();case 4:if(r=e.sent,!(i=r.authSetting)||!i["scope.userInfo"]){e.next=11;break}return e.next=9,ae({withCredentials:!1});case 9:return o=e.sent,e.abrupt("return",o);case 11:return wx.hideToast(),Ne.config.dirname=""+I.authRoute,Ne.config.pageConfig=Object.assign(Ne.config.pageConfig,{tipText:F.tipText||Ne.config.pageConfig.tipText,btn:{style:F.btn.style||Ne.config.pageConfig.btn.style,text:F.btn.text||Ne.config.pageConfig.btn.text},image:{src:F.imageSrc||Ne.config.pageConfig.image.src,mode:F.imageMode||Ne.config.pageConfig.image.mode}}),e.next=16,(0,Ne.authrize)(Ne.AUTH_TYPE.userInfo,Object.assign(Object.assign({},Ve),n)).catch((function(e){throw new m("getUserInfo失败： "+e.message,void 0,e.errCode)}));case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),t)}))),function(){return De.apply(this,arguments)});function Ge(){}var He,Ye=a(0),Xe=a.n(Ye),ze=function(e){return Xe()[ce()||"prod"][e]},$e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Qe=(He=s(e.mark((function t(n,i,o,a){var s,u,c,f,p,l,d,g,h,b,w,y,m,v,x;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===o&&(o={}),void 0===a&&(a={}),u=(s=o).loginCode,c=s.noCode,f=void 0!==c&&c,p=s.useUserInfo,l=void 0===p||p,d=s.userInfo,g=$e(o,["loginCode","noCode","useUserInfo","userInfo"]),e.next=5,Promise.all([je(),f?"":X(u),Ee()]);case 5:if(h=e.sent,b=r(h,3),w=b[0],y=b[1],m=b[2],(f||d)&&(l=!1),e.t0=l,!e.t0){e.next=16;break}return e.next=15,Je({withCredentials:!0});case 15:e.t0=e.sent;case 16:return v=e.t0,x=v.userInfo,e.next=20,Le(n,{method:"POST",query:g,type:"form",data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(l||d)&&{bind:!0}),a),{uuid:w}),l&&{userInfo:JSON.stringify(x)}),d&&{userInfo:JSON.stringify(d)}),y&&{code:y}),{wechatFingerprint:m})});case 20:return e.t1=e.sent,e.t2=w,e.t3=y,e.t4=d||(l?x:null),e.abrupt("return",{resp:e.t1,uuid:e.t2,code:e.t3,userInfo:e.t4});case 25:case"end":return e.stop()}}),t)}))),function(){return He.apply(this,arguments)});function Ze(e){return null!=e.error}var et,tt,nt,rt,it,ot,at,st,ut,ct,ft,pt,lt,dt,gt,ht,bt,wt,yt,mt=(et=s(e.mark((function t(n){var r,i,o;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(ze("verifylogin"),"",Object.assign(Object.assign({},n),{useUserInfo:!1,noCode:!0}));case 2:if(r=e.sent,i=r.resp,o=r.uuid,!Ze(i)){e.next=7;break}return e.abrupt("return",{isErr:!0,error:i.error,uuid:o});case 7:return e.abrupt("return",{isErr:!1,uuid:o,user:Object.assign(Object.assign({},i.user),{userId:i.user.id})});case 8:case"end":return e.stop()}}),t)}))),function(){return et.apply(this,arguments)}),vt=(tt=s(e.mark((function t(n){var r,i,o;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(ze("ticketlogin"),"",Object.assign(Object.assign({},n),{noCode:!0,useUserInfo:!1}));case 2:if(r=e.sent,i=r.resp,o=r.uuid,!Ze(i)){e.next=7;break}return e.abrupt("return",{isErr:!0,error:i.error,uuid:o});case 7:return e.abrupt("return",{isErr:!1,uuid:o,user:Object.assign(Object.assign({},i.user),{userId:i.user.id})});case 8:case"end":return e.stop()}}),t)}))),function(){return tt.apply(this,arguments)}),xt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},kt=(nt=s(e.mark((function t(n){var r,i,o,a,s,u,c,f,p,l;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.encryptedData,i=n.verify,o=n.checkMobile,a=n.iv,s=xt(n,["encryptedData","verify","checkMobile","iv"]),e.next=3,Qe(ze("wxmobilelogin"),"",Object.assign(Object.assign(Object.assign({},i),o),s),{encryptedData:r,iv:a});case 3:if(u=e.sent,c=u.resp,f=u.code,p=u.uuid,l=u.userInfo,!Ze(c)){e.next=10;break}return e.abrupt("return",{isErr:!0,error:c.error,code:f,uuid:p,userInfo:l});case 10:return e.abrupt("return",{isErr:!1,loginInfo:c.data,uuid:p,code:f,userInfo:l});case 11:case"end":return e.stop()}}),t)}))),function(){return nt.apply(this,arguments)}),Ot=(rt=s(e.mark((function t(n){var r,i,o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(ze("wxlogin"),"",n,{admitLogout:!0});case 2:if(r=e.sent,i=r.resp,o=r.uuid,a=r.code,s=r.userInfo,!Ze(i)){e.next=9;break}return e.abrupt("return",{isErr:!0,uuid:o,code:a,userInfo:s,error:Object.assign(Object.assign({},i.error),{openId:i.openId,unionId:i.unionId,openIdCipher:i.openIdCipher})});case 9:return e.abrupt("return",{isErr:!1,loginInfo:Object.assign(Object.assign({},i.data),{openId:i.openId,openIdCipher:i.openIdCipher,unionId:i.unionId}),userInfo:s,code:a,uuid:o});case 10:case"end":return e.stop()}}),t)}))),function(){return rt.apply(this,arguments)}),It=(it=s(e.mark((function t(n){var r,i,o,a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(ze("wxslientlogin"),"",Object.assign(Object.assign({},n),{useUserInfo:!1}));case 2:if(r=e.sent,i=r.resp,o=r.uuid,a=r.code,!Ze(i)){e.next=8;break}return e.abrupt("return",{isErr:!0,uuid:o,code:a,error:Object.assign(Object.assign({},i.error),{openId:i.openId,unionId:i.unionId,openIdCipher:i.openIdCipher})});case 8:return e.abrupt("return",{isErr:!1,loginInfo:Object.assign(Object.assign({},i.data),{openId:i.openId,openIdCipher:i.openIdCipher,unionId:i.unionId}),code:a,uuid:o});case 9:case"end":return e.stop()}}),t)}))),function(){return it.apply(this,arguments)}),_t=(ot=s(e.mark((function t(n){var r,i,o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.mobile,i=n.openId,o=xt(n,["mobile","openId"]),e.next=3,Qe(ze("wxbindapply"),"",Object.assign(Object.assign({},o),{useUserInfo:!1}),{openId:i,mobile:r});case 3:if(a=e.sent,!Ze(s=a.resp)){e.next=7;break}return e.abrupt("return",{isErr:!0,error:s.error});case 7:if(!s.data){e.next=9;break}return e.abrupt("return",s.data.requestCode);case 9:case"end":return e.stop()}}),t)}))),function(){return ot.apply(this,arguments)}),Ct=(at=s(e.mark((function t(n){var r,i,o,a,s,u,c,f,p;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.checkMobile,i=n.loginCode,o=xt(n,["checkMobile","loginCode"]),a=Object.assign({loginCode:i},r),e.next=4,Qe(ze("wxbind"),"",Object.assign(Object.assign({},a),{useUserInfo:!1}),o);case 4:if(s=e.sent,u=s.resp,c=s.uuid,f=s.code,p=s.userInfo,!Ze(u)){e.next=11;break}return e.abrupt("return",{isErr:!0,error:u.error,userInfo:p,uuid:c,code:f});case 11:return e.abrupt("return",{isErr:!1,loginInfo:u.data,userInfo:p,code:f,uuid:c});case 12:case"end":return e.stop()}}),t)}))),function(){return at.apply(this,arguments)}),St=(st=s(e.mark((function t(n){var r,i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(ze("wxticketlogin"),"",Object.assign(Object.assign({},n),{noCode:!0}));case 2:if(r=e.sent,!Ze(i=r.resp)){e.next=6;break}return e.abrupt("return",{isErr:!0,error:i.error});case 6:if(!i.data){e.next=8;break}return e.abrupt("return",i.data);case 8:throw new y(ze("wxticketlogin"));case 9:case"end":return e.stop()}}),t)}))),function(){return st.apply(this,arguments)}),jt=(ut=s(e.mark((function t(n){var r,i,o,a,s,u,c;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.mobile,i=n.verifyLevel,o=void 0===i?2:i,a=n.specialRiskCode,s=void 0===a?0:a,e.next=3,Qe(ze("mobileloginapply"),"",{noCode:!0},{mobile:r,verifyLevel:o,specialRiskCode:s});case 3:if(u=e.sent,Ze(c=u.resp)){e.next=7;break}throw new y(ze("mobileloginapply"));case 7:if(!c.error.data){e.next=9;break}return e.abrupt("return",c.error.data.requestCode);case 9:case"end":return e.stop()}}),t)}))),function(){return ut.apply(this,arguments)}),Pt=(ct=s(e.mark((function t(n,r){var i,o,a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(ze("mobilelogin"),"",Object.assign({useUserInfo:!1,noCode:!0},n),r);case 2:if(i=e.sent,o=i.resp,a=i.uuid,!Ze(o)){e.next=7;break}return e.abrupt("return",{isErr:!0,error:o.error,uuid:a});case 7:return e.abrupt("return",{isErr:!1,uuid:a,loginInfo:o.user});case 8:case"end":return e.stop()}}),t)}))),function(){return ct.apply(this,arguments)}),Tt=(ft=s(e.mark((function t(){var n,r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:return n=e.sent,e.next=5,Le(ze("getwxinfo"),{method:"POST",type:"form",data:{code:n}});case 5:if(!(r=e.sent).code){e.next=8;break}throw new y(ze("getwxinfo"),r);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),t)}))),function(){return ft.apply(this,arguments)}),Et=(pt=s(e.mark((function t(n){var r,i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:return r=e.sent,e.next=5,Le(ze("updatewxinfo"),{method:"POST",type:"form",data:{code:r,userinfo:JSON.stringify(n)}});case 5:if(!(i=e.sent).code){e.next=8;break}throw new y(ze("updatewxuserinfo"),i);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),t)}))),function(){return pt.apply(this,arguments)}),Rt=["id","username","avatartype","avatarurl","nickname","email","city","cityid","mobile","isBindedMobile"],Lt=(lt=s(e.mark((function t(n,r){var i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}throw new m("getMtInfo 必须传token",void 0,103);case 2:return e.next=4,Le(ze("getmtuserinfo"),Object.assign({query:{fields:Rt.join(","),token:n}},r));case 4:if(!(i=e.sent).error){e.next=7;break}throw new y("getMtInfo: "+ze("getmtuserinfo"),i.error);case 7:return e.abrupt("return",i.user);case 8:case"end":return e.stop()}}),t)}))),function(){return lt.apply(this,arguments)}),Ut=(dt=s(e.mark((function t(n,r){var i,o,a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.username,o=r.avatar,e.next=3,Ue({url:ze("updatemtuserinfo")+"/"+n,timeout:5e3,filePath:o,formData:Object.assign(Object.assign({},i?{username:i}:{}),o?{avatartype:255}:{})});case 3:if(!(a=e.sent).error){e.next=6;break}throw new y(ze("updatemtuserinfo"),a.error);case 6:return e.abrupt("return",a.user);case 7:case"end":return e.stop()}}),t)}))),function(){return dt.apply(this,arguments)}),Nt=[(gt=s(e.mark((function t(n,r){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=!1),!h(n)){e.next=3;break}return e.abrupt("return",r?n:ee(n.msg));case 3:case"end":return e.stop()}}),t)}))),function(){return gt.apply(this,arguments)}),function(e,t){if(void 0===t&&(t=!1),function(e){return e.errType===l.WXRequestError}(e))return t?e:ee(e.msg)},function(e,t){if(void 0===t&&(t=!1),function(e){return e.errType===l.WXAPIError}(e))return t?e:ee(e.msg)},function(e,t){if(void 0===t&&(t=!1),function(e){return e.errType===l.SDKError}(e))return!0}],At=(ht=s(e.mark((function n(r,i){var o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=!1),wx.hideToast(),r){e.next=4;break}return e.abrupt("return");case 4:O.errorReport,o=t(Nt);case 6:if((a=o()).done){e.next=14;break}return s=a.value,e.next=10,s(r,i);case 10:if(!e.sent){e.next=12;break}return e.abrupt("return",O.errorReport?r:void 0);case 12:e.next=6;break;case 14:return e.abrupt("return",O.errorReport?(r.errType=l.UnExpected,r._message=r.message,r._stack=r.stack,r):void 0);case 15:case"end":return e.stop()}}),n)}))),function(){return ht.apply(this,arguments)}),Dt=(bt=s(e.mark((function t(n){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.token&&n.userId)){e.next=11;break}if(We.authInfo=n,n.creatTime=Date.now()-6e4,!O.persistKey){e.next=6;break}return e.next=6,$(O.persistKey,n).catch((function(e){}));case 6:return e.next=8,$t();case 8:return e.abrupt("return",n);case 11:throw new m(W.illegalAuthInfo,"setAuthInfo出错："+JSON.stringify(n),113);case 12:case"end":return e.stop()}}),t)}))),function(){return bt.apply(this,arguments)}),Bt=function(){try{return We.authInfo||O.persistKey&&wx.getStorageSync(O.persistKey)||null}catch(e){return null}},Ft=(wt=s(e.mark((function t(){var n,r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=We.authInfo)){e.next=3;break}return e.abrupt("return",{authInfo:n,fromStorage:!1});case 3:if(!O.persistKey){e.next=8;break}return e.next=6,z(O.persistKey).catch((function(){return null}));case 6:return r=e.sent,e.abrupt("return",{authInfo:r,fromStorage:!0});case 8:return e.abrupt("return",{authInfo:null,fromStorage:!1});case 9:case"end":return e.stop()}}),t)}))),function(){return wt.apply(this,arguments)}),Kt=(yt=s(e.mark((function t(n,r,i){var o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=!1),void 0===r&&(r=!0),e.next=4,Ft();case 4:if(o=e.sent,a=o.authInfo,o.fromStorage&&a){e.next=9;break}return e.abrupt("return",a);case 9:if(!n){e.next=13;break}if((s=a.creatTime)&&!(Date.now()-s>15552e6)){e.next=13;break}return e.abrupt("return",null);case 13:if(!r){e.next=19;break}return e.next=16,Mt(a.token,null==i?void 0:i.timeout);case 16:if(!e.sent){e.next=18;break}return e.abrupt("return",null);case 18:We.authInfo||(We.authInfo=a);case 19:return e.abrupt("return",a);case 20:case"end":return e.stop()}}),t)}))),function(){return yt.apply(this,arguments)});function Mt(){return Wt.apply(this,arguments)}function Wt(){return(Wt=s(e.mark((function t(n,r){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=5e3),e.prev=1,e.next=4,Lt(n,Object.assign({},r<=0?{}:{timeout:r}));case 4:return e.abrupt("return",!1);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}var qt,Vt,Jt,Gt,Ht,Yt,Xt,zt=(qt=s(e.mark((function t(){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(We.authInfo=null,!O.persistKey){e.next=4;break}return e.next=4,Q(O.persistKey).catch(Ge);case 4:case"end":return e.stop()}}),t)}))),function(){return qt.apply(this,arguments)}),$t=(Vt=s(e.mark((function t(n){var r,i,o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=We.session)){e.next=12;break}if(i=r.resolve,o=r.redirectUrl,a=r.waitBack,(s=r.sF)&&s(!1),We.session=null,!a){e.next=10;break}return e.next=8,Zt(o);case 8:e.next=11;break;case 10:Zt(o);case 11:"function"==typeof i&&i(n||Kt());case 12:case"end":return e.stop()}}),t)}))),function(){return Vt.apply(this,arguments)}),Qt=function(e,t,n){if(O.onPageErr)try{O.onPageErr(e,t,n)}catch(e){}},Zt=(Jt=s(e.mark((function t(n){var r,i,o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=getCurrentPages(),i=I.sdkRoute.replace(/^\//,""),o=r&&r[0]&&r[0].route?"route":"__route__",a=r.findIndex((function(e){return e&&e[o].startsWith(i)})),!n){e.next=8;break}if(!(a>0&&a===r.length-1)){e.next=7;break}return e.abrupt("return",ie(n,"",!0));case 7:return e.abrupt("return",ie(n));case 8:if(-1!==a){e.next=10;break}return e.abrupt("return");case 10:if(!((s=a>0?r.length-a:r.length-a-1)>0)){e.next=13;break}return e.abrupt("return",new Promise((function(e){wx.navigateBack({delta:s});var t=r.length-s;!function n(){setTimeout((function(){getCurrentPages().length===t?e():n()}),100)}()})));case 13:case"end":return e.stop()}}),t)}))),function(){return Jt.apply(this,arguments)}),en=(Gt=s(e.mark((function t(n,r){var i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dt(Object.assign(n,r));case 2:return i=e.sent,te(W.loginSuccess),e.abrupt("return",i);case 5:case"end":return e.stop()}}),t)}))),function(){return Gt.apply(this,arguments)}),tn=(Ht=s(e.mark((function t(n,r){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_){e.next=6;break}return e.next=3,_(n,r);case 3:if(e.sent){e.next=6;break}throw new m("loginCheck failed",void 0,114);case 6:case"end":return e.stop()}}),t)}))),function(){return Ht.apply(this,arguments)}),nn=function(e,t){var n=We.session;return n&&!n.expired?(n.clean(),n):We.session=new Be(e,xe.AUTH,t)},rn=function(e){return e&&e.protocolList&&e.protocolList.map((function(e){e.encodedUrl||(e.encodedUrl=encodeURIComponent(e.url))})),e},on={getLoginCode:X,getUserProfile:function(e,t){if(!wx.getUserProfile){var n=new Error("没有wx.getUserProfile");return n.errCode=100,Promise.reject(new m(n.message,void 0,n.errCode))}return new Promise((function(n,r){wx.getUserProfile({desc:e,lang:t,success:function(e){if(e&&e.userInfo)n(e);else{var t=new Error("wx.getUserProfile的返回值格式不对："+JSON.stringify(e));t.errCode=101,r(new m(t.message,void 0,t.errCode))}},fail:function(e){e.errCode=102,r(new m("wx.getUserProfile失败："+JSON.stringify(e),void 0,e.errCode))}})}))},getUserInfo:Je,getUUID:je,getStorage:z,setStorage:$,showTip:ee,showToast:te,request:Le,stringify:g.stringify,navigate:ie};(Xt=Yt||(Yt={})).navigateTo="navigateTo",Xt.redirectTo="redirectTo",Xt.reLaunch="reLaunch";var an,sn,un=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},cn=(an=s(e.mark((function t(n,r,i){var o,a,s,u;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n||fn[j.create](),a=""+I.bindRoute,s=r===Yt.redirectTo,u=r===Yt.reLaunch,i&&(a=a+"?"+(0,g.stringify)(i)),e.next=7,ie(a,I.bindRoute.substr(1),s,u);case 7:return e.abrupt("return",o);case 8:case"end":return e.stop()}}),t)}))),function(){return an.apply(this,arguments)}),fn=(sn=s(e.mark((function t(n){var r,i,o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),i=(r=n).session,o=r.navType,a=un(n,["session","navType"]),e.next=4,cn(i,o,a);case 4:return s=e.sent,e.next=7,new Promise((function(e,t){s.resolve=e,s.reject=t}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),t)}))),function(){return sn.apply(this,arguments)});fn[j.create]=function(){return nn(C.MOBILE)};var pn,ln,dn,gn,hn=function(){function t(){var e,n,r,i,o,a,s,u,c=this;this.data=(e=L.title,n=L.wxLoginText,r=L.mobileLoginText,i=L.imageSrc,o=L.imageMode,a=L.imageStyle,s=L.wxLoginStyle,u=L.mobileLoginStyle,{API_TYPE:C,type:C.MOBILE,title:e,wxLoginText:n,mobileLoginText:r,wxLoginStyle:s,mobileLoginStyle:u,radioChecked:!1,image:{src:i,mode:o,style:a},protocolConfig:rn(H)});var f=t.prototype;Object.getOwnPropertyNames(f).filter((function(e){return"constructor"!==e})).forEach((function(e){Object.defineProperty(c,e,{writable:!0,configurable:!0,enumerable:!0,value:f[e]})}))}var n,r,i,o,a,u=t.prototype;return u.onLoad=(n=s(e.mark((function t(n){var r,i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.type&&this.setData({type:n.type}),this.hasAuthUserInfo=!1,this.specialRiskCode=n.specialRiskCode||0,this.poiid=n.poiid||"",e.t0=n.code,e.t0){e.next=9;break}return e.next=8,X();case 8:e.t0=e.sent;case 9:return this.loginCode=e.t0,this.bind="false"!==n.bind,this.redirectUrl=n.redirectUrl,this.willRedirectToBindPage="1"===n.willRedirectToBindPage,e.next=15,oe();case 15:r=e.sent,(i=r.authSetting)&&i["scope.userInfo"]&&(this.hasAuthUserInfo=!0);case 18:case"end":return e.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),u.onReady=function(){wx.setNavigationBarTitle({title:this.data.title})},u.onShow=function(){We.session&&We.session._emit(Oe.ENTRYPAGEONSHOW,We.session),this.goToBindPage=!1},u.onClickRadio=function(){this.setData({radioChecked:!this.data.radioChecked})},u.onUnload=function(){var e,t;!We.session||this.goToBindPage||this.disErrRpt||(O.errorReport&&(Zt(),null===(t=null===(e=null==We?void 0:We.session)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,new m("用户从登陆入口页回退",void 0,112))),We.session._emit(Oe.NAVIBACK,We.session))},u.lockClick=function(e,t){var n=this,r=null;1===e?(this.wxMobileLock=!0,r=setTimeout((function(){n.wxMobileLock=!1,clearTimeout(r),r=null}),t||2e3)):(this.mobileLock=!0,r=setTimeout((function(){n.mobileLock=!1,clearTimeout(r),r=null}),t||2e3))},u.getLoginCode=(r=s(e.mark((function t(){var n;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data.radioChecked){e.next=3;break}return te(W.noConfirm,"none"),e.abrupt("return");case 3:if(!this.wxMobileLock){e.next=5;break}return e.abrupt("return");case 5:return(n=We.session)&&n._emit(Oe.CLICK,C.WX_MOBILE),this.lockClick(2),e.next=10,X();case 10:this.loginCode=e.sent;case 11:case"end":return e.stop()}}),t,this)}))),function(){return r.apply(this,arguments)}),u.wxMobileLoginClick=(i=s(e.mark((function t(n){var r,i,o,a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.wxMobileLock){e.next=3;break}return e.abrupt("return");case 3:if(this.lockClick(2),r=We.session,null!=(i=n.detail).iv){e.next=11;break}return r&&r._emit(Oe.REFUSEPHONE,r),e.next=10,ee(W.refusePhoneNumberAuth);case 10:return e.abrupt("return");case 11:return r&&r._emit(Oe.ALLOWPHONE,r),e.next=14,tn("wechat").catch(Ge);case 14:return te(W.logining,"loading",60010),o=null,r&&r.data&&(o=r.data.wxUserInfoData),e.next=19,qn(i,this.loginCode,this.bind,o,r);case 19:a=e.sent,wx.hideToast(),a&&te(W.loginSuccess),e.next=29;break;case 24:if(e.prev=24,e.t0=e.catch(0),O.errorReport){e.next=28;break}throw e.t0;case 28:Qt(e.t0,"entry","wxMobile");case 29:case"end":return e.stop()}}),t,this,[[0,24]])}))),function(){return i.apply(this,arguments)}),u.mobileLoginClick=(o=s(e.mark((function t(){var n,r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data.radioChecked){e.next=3;break}return te(W.noConfirm,"none"),e.abrupt("return");case 3:if(!this.mobileLock){e.next=5;break}return e.abrupt("return");case 5:return this.lockClick(1),n=this.redirectUrl||this.willRedirectToBindPage?Yt.redirectTo:Yt.navigateTo,r={fromEntry:!0,specialRiskCode:this.specialRiskCode,cfrm:!0},this.poiid&&(r.poiid=this.poiid),this.goToBindPage=!0,e.next=12,cn(We.session,n,r).catch((function(e){if(!O.errorReport)throw e;Qt(e,"entry","onGoToMobile")}));case 12:case"end":return e.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),u.onWxLoginTap=function(){var e=this;this.data.radioChecked?(We.session&&We.session._emit(Oe.CLICK,We.session.type),wx.getUserProfile&&(this.bind?wx.getUserProfile&&wx.getUserProfile({desc:"请授权用户信息",success:function(t){t&&t.userInfo&&e.wxLoginClick({userInfo:t.userInfo}).catch((function(e){if(!O.errorReport)throw e;Qt(e,"entry","wxLoginUserProfile")}))},fail:function(){ee(W.refuseUserInfoAuth).then((function(){We.session&&We.session._emit(Oe.ENTRYPAGEREFUSEUSERINFO,We.session.type)}))}}):this.wxLoginClick({}).catch((function(e){if(!O.errorReport)throw e;Qt(e,"entry","wxLoginNoBind")})))):te(W.noConfirm,"none")},u.onGetUserInfo=function(e){if(!wx.getUserProfile){var t=e.detail;t.iv?this.wxLoginClick({userInfo:t.userInfo}).catch((function(e){if(O.errorReport)throw e;Qt(e,"entry","wxLoginUserInfo")})):ee(W.refuseUserInfoAuth).then((function(){We.session&&We.session._emit(Oe.ENTRYPAGEREFUSEUSERINFO,We.session.type)}))}},u.wxLoginClick=(a=s(e.mark((function t(n){var r,i,o,a,s,u,c;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mobileLock){e.next=2;break}return e.abrupt("return");case 2:if(this.lockClick(1),r=n.userInfo,i=void 0===r?{}:r,this.hasAuthUserInfo||We.session&&We.session._emit(Oe.ENTRYPAGEALLOWUSERINFO,We.session.type),this.goToBindPage=!0,(o=We.session)||(a=nn(C.WXV2),o=a&&a.type===C.WXV2?a:new Be(C.WXV2,xe.AUTH,6e5)),s=o.resolve){e.next=14;break}return e.next=12,ee("登陆异常，请退出该页面后重新尝试");case 12:return this.disErrRpt=!0,e.abrupt("return");case 14:return u=this.redirectUrl||this.willRedirectToBindPage?Yt.redirectTo:Yt.navigateTo,c=Object.assign(Object.assign({session:o,slient:!1,redirectUrl:this.redirectUrl,navType:u,fromEntry:!0,cfrm:!0},this.bind?{userInfo:i}:{useUserInfo:!1}),{specialRiskCode:this.specialRiskCode}),this.poiid&&(c.poiid=this.poiid),e.t0=s,e.next=20,Jn(c);case 20:e.t1=e.sent,(0,e.t0)(e.t1);case 22:case"end":return e.stop()}}),t,this)}))),function(){return a.apply(this,arguments)}),t}();(ln=pn||(pn={})).Entry="entry",ln.Bind="bind";var bn,wn,yn=new hn,mn={methods:Object.assign(Object.assign({},yn),{closeCard:function(){var e,t=We.session;t&&t.sF&&t.sF(!1),O.errorReport&&(null===(e=null==t?void 0:t.reject)||void 0===e||e.call(t,new m("用户从弹窗登陆页面退出",void 0,108))),t&&t._emit(Oe.CLOSECARD,t)},mobileLoginClick:function(){We.session&&We.session._emit(Oe.CLICK,We.session.type),yn.mobileLoginClick.call(this)}}),data:Object.assign(Object.assign({},yn.data),{webviewDir:"",showCard:!1}),lifetimes:{created:function(){var e=this;gn=this,dn=function(t,n){return e.setData({showCard:t},n)}},attached:function(){var t=this;return s(e.mark((function n(){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setData({protocolConfig:rn(H),webviewDir:I.webviewRoute});case 1:case"end":return e.stop()}}),n)})))()}},pageLifetimes:{show:function(){var e=this;gn=this,dn=function(t,n){return e.setData({showCard:t},n)},this.data.showCard&&yn.onShow.call(this)}}},vn=(bn=s(e.mark((function t(n,i,o){var a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.slice(n.indexOf("?")+1).split("&").reduce((function(e,t){var n,i=r(t.split("="),2),o=i[0],a=i[1];return Object.assign(e,((n={})[o]=a,n))}),{}),e.abrupt("return",new Promise((function(e,t){try{i(o&&o.call(gn,a)),e(!0)}catch(e){t(new m("弹窗登陆失败：swtchFunc 失败："+JSON.stringify(e),void 0,109))}})));case 2:case"end":return e.stop()}}),t)}))),function(){return bn.apply(this,arguments)}),xn=(wn=s(e.mark((function t(n,r){var i,o,a,s,u,c,f;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),void 0===r&&(r=!1),o=!0,a=n.navType===Yt.redirectTo,s=n.navType===Yt.reLaunch,u=!(!a&&!s),n instanceof Be?i=n:(i=n.session||xn[j.create](),!1===n.bind&&(o=!1)),i.data||(i.data={}),i.redirectUrl=n.redirectUrl,i.waitBack=n.waitBack,i.data.wxUserInfoData=n.wxUserInfoData,r&&(i.sF=dn),c=I.loginRoute,f=i.type===C.LOGIN?c+"?bind="+o+"&redirectUrl="+(i.redirectUrl||"")+"&willRedirectToBindPage="+u:c+"?type="+i.type+"&bind="+o+"&redirectUrl="+(i.redirectUrl||"")+"&willRedirectToBindPage="+u,n.code&&i.data.wxUserInfoData&&(f=f+"&code="+n.code),n.poiid&&(f=f+"&poiid="+n.poiid),f=f+"&specialRiskCode="+(n.specialRiskCode||0),!r||i.sF){e.next=19;break}throw new m("switchFunc is null",void 0,104);case 19:return e.next=21,r?vn(f,(function(e){return i.sF(!0,e)}),(function(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=hn.prototype.onLoad).call.apply(e,[this].concat(r)),(t=hn.prototype.onShow).call.apply(t,[this].concat(r))})):ie(f,c.substr(1),a,s);case 21:return e.next=23,new Promise((function(e,t){i.resolve=e,i.reject=t}));case 23:return e.abrupt("return",e.sent);case 24:case"end":return e.stop()}}),t)}))),function(){return wn.apply(this,arguments)});xn[j.create]=function(){return nn(C.LOGIN)};var kn,On,In,_n,Cn=function(e){return zt().then((function(){return xn(e)}))},Sn=function(){return kn},jn=function(){return On};function Pn(){return Tn.apply(this,arguments)}function Tn(){return(Tn=s(e.mark((function t(n){var r,i,o,a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.username,i=n.mobile,o=n.avatar,a=new Promise((function(e,t){kn=e,On=t})),e.next=4,ie(I.phoneRoute+"?"+(0,g.stringify)({name:r,mobile:i,avatar:o}));case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var En,Rn,Ln=function(){return In},Un=function(){return _n};function Nn(){return An.apply(this,arguments)}function An(){return(An=s(e.mark((function t(n){var r,i,o,a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.requestCode,i=""+I.waitYodaRoute,o=""+I.waitYodaRoute,a=new Promise((function(e,t){In=e,_n=t})),e.next=6,ie(I.smsVerifyRoute+"?requestCode="+r+"&success="+i+"&fail="+o);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Dn=function(){return En},Bn=function(){return Rn};function Fn(){return Kn.apply(this,arguments)}function Kn(){return(Kn=s(e.mark((function t(n){var r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e,t){En=e,Rn=t})),e.next=3,ie(I.yodaRoute+"?"+(0,g.stringify)({reqCode:n}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Mn,Wn,qn=(Mn=s(e.mark((function t(n,r,i,o){var a,s,u,c,f,p,l,d,g,h,b,w,m,v,x,k,I,_,S,j,P,T,E,R,L;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.iv,s=n.encryptedData,void 0===i&&(i=!0),void 0===o&&(o=null),e.prev=3,c={iv:a,encryptedData:s,loginCode:r,useUserInfo:i},e.next=7,kt(c);case 7:f=e.sent,p={type:C.WX_MOBILE,code:f.code,uuid:f.uuid,wxUserInfo:f.userInfo},l="wxMobileLoginV2";case 10:if(!f.isErr){e.next=58;break}d=f.error,e.t0=d.code,e.next=101190===e.t0?15:101159===e.t0?24:101157===e.t0?42:53;break;case 15:return e.next=17,Fn(null===(u=d.data)||void 0===u?void 0:u.requestCode);case 17:return g=e.sent,h=g.requestCode,b=g.responseCode,l="wxMobileLoginV2",e.next=22,kt(Object.assign(Object.assign({},c),{useUserInfo:!1,verify:{responseCode:b,requestCode:h,loginAfterFirstVerify:!0},loginCode:p.code}));case 22:return f=e.sent,e.abrupt("break",56);case 24:return w=d.data,m=w.username,v=w.mobile,x=w.avatar,k=w.userTicket,e.next=27,Pn({username:m,mobile:v,avatar:x});case 27:if("isMine"!==e.sent.action){e.next=36;break}return l="wxMobileLoginV2",e.next=33,kt(Object.assign(Object.assign({},c),{useUserInfo:!1,checkMobile:{userTicket:k,loginAfterSecondaryMobile:!0},loginCode:p.code}));case 33:f=e.sent,e.next=41;break;case 36:return l="ticketLogin",e.next=39,vt({userTicket:k});case 39:I=e.sent,f=Object.assign(Object.assign({},I),{loginInfo:I.user});case 41:return e.abrupt("break",56);case 42:return _=f.error.data,S=_.requestCode,j=_.userTicket,e.next=45,Nn({requestCode:S});case 45:return P=e.sent,T=P.responseCode,l="verifyLogin",e.next=50,mt(Object.assign(Object.assign({},c),{requestCode:S,responseCode:T,userTicket:j}));case 50:return E=e.sent,f=Object.assign(Object.assign({},E),{loginInfo:E.user}),e.abrupt("break",56);case 53:return e.next=55,ee(d.message||d.code.toString());case 55:throw new y("wxMobileLogin error",d,JSON.stringify({mobileLoginOption:c,lastCalled:l,tempInfo:p,result:f}));case 56:e.next=10;break;case 58:return R=f.loginInfo,(L=Object.assign(Object.assign({},p),R)).openIdCipher||(L.openIdCipher="test"),e.next=63,Dt(L);case 63:return e.abrupt("return",e.sent);case 66:if(e.prev=66,e.t1=e.catch(3),!O.errorReport){e.next=74;break}return e.next=71,At(e.t1);case 71:throw e.sent;case 74:return e.abrupt("return",At(e.t1));case 75:case"end":return e.stop()}}),t,null,[[3,66]])}))),function(){return Mn.apply(this,arguments)}),Vn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Jn=(Wn=s(e.mark((function t(n){var r,i,o,a,s,u,c,f,p,l,d,h,b,w,y,m,x,k,_,C,S,P,T,E,R;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),i=(r=n).bind,o=void 0===i||i,a=r.navType,s=r.slient,u=void 0===s||s,c=r.session,f=void 0===c?Jn[j.create]():c,p=r.redirectUrl,l=r.waitBack,d=Vn(n,["bind","navType","slient","session","redirectUrl","waitBack"]),null==n.slient&&n.silent,h=!1,b=!1,f.redirectUrl=p,f.waitBack=l,o&&(h=a===Yt.redirectTo,b=a===Yt.reLaunch),u||te(v.tips.logining,"loading",60010),e.prev=9,e.next=12,(u?It:Ot)(d);case 12:if(w=e.sent,y=w.isErr,m=w.code,x=w.uuid,k=w.userInfo,_=y?w.error:w.loginInfo,C=_.openId,S=_.openIdCipher,P=void 0===S?"test":S,T=_.unionId,E={code:m,uuid:x,openId:C,openIdCipher:P,unionId:T,wxUserInfo:k},f.data=Object.assign(Object.assign({},w),{loginInfo:_}),!y){e.next=30;break}if(f._state(xe.BINDING,f.data),!u&&wx.hideToast(),o){e.next=23;break}return e.abrupt("return",Object.assign(Object.assign({},E),{error:w.error}));case 23:return R=Object.assign(Object.assign({openId:C},k&&{userInfo:k}),d),e.next=26,ie(I.bindRoute+"?"+(0,g.stringify)(R),I.bindRoute.substr(1),h,b);case 26:return wx.hideToast(),e.next=29,new Promise((function(e,t){f.resolve=e,f.reject=t}));case 29:return e.abrupt("return",e.sent);case 30:return wx.hideToast(),e.next=33,Dt(Object.assign(Object.assign({},E),_));case 33:return e.abrupt("return",e.sent);case 36:if(e.prev=36,e.t0=e.catch(9),!O.errorReport){e.next=44;break}return e.next=41,At(e.t0,u);case 41:throw e.sent;case 44:At(e.t0,u);case 45:case"end":return e.stop()}}),t,null,[[9,36]])}))),function(){return Wn.apply(this,arguments)});Jn[j.create]=function(){var e=nn(C.WXV2);return e.type===C.WXV2?e:We.session=new Be(C.WXV2,xe.AUTH,6e5)};var Gn,Hn=(Gn=s(e.mark((function t(n){var r,i,o,a;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),r=n.token){e.next=5;break}return e.abrupt("return");case 5:return i=n.uuid,(o=n.session||Hn[j.create]()).waitBack=!0,a=I.changeBindPhoneRoute+"?token="+r+"&uuid="+i,e.next=11,ie(a);case 11:return e.next=13,new Promise((function(e,t){o.resolve=e,o.reject=t}));case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),t)}))),function(){return Gn.apply(this,arguments)});Hn[j.create]=function(){return qe(),nn(C.CHANGE_BIND)};var Yn,Xn,zn,$n=(Yn=s(e.mark((function t(n,r,i){var o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=O.appName),void 0===i&&(i=!1),n){e.next=17;break}return e.next=5,Kt(!1,!1);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(a=e.t0,s=a.token){e.next=14;break}return e.abrupt("return",!0);case 14:o=s;case 15:e.next=18;break;case 17:o=n;case 18:return e.next=20,Le(ze("logout"),{bypass:!0,method:"POST",type:"form",data:{token:o,appName:r,unbind_openid:i}}).then((function(e){return zt().catch(Ge).then((function(){return e.result}))})).catch((function(e){return zt().catch(Ge).then((function(){return!1}))}));case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),t)}))),function(){return Yn.apply(this,arguments)}),Qn=function(e,t){return void 0===t&&(t=O.appName),Le(ze("islogout"),{bypass:!0,method:"POST",type:"form",data:{userId:e,appName:t}}).then((function(e){if(e.error)throw new y(ze("islogout"),e.error);return e.result})).catch((function(e){}))},Zn=(Xn=s(e.mark((function t(){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.persistKey){e.next=3;break}return e.next=3,Q(O.persistKey).catch(Ge);case 3:return e.next=5,ee(W.unlockAccount);case 5:case"end":return e.stop()}}),t)}))),function(){return Xn.apply(this,arguments)}),er=(zn=s(e.mark((function t(n){return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xn(n,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),t)}))),function(){return zn.apply(this,arguments)});er[j.create]=function(){return nn(C.LOGIN)};var tr,nr=function(e){return zt().then((function(){return er(e)}))},rr={data:{webViewSrc:""},onLoad:function(t){var n=this;return s(e.mark((function r(){var i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="";try{i=decodeURIComponent(t.src)}catch(e){i=H.protocolList[0].url}n.setData({webViewSrc:i});case 4:case"end":return e.stop()}}),r)})))()},onShow:function(){},onUnload:function(){}},ir="http://verify.inf.dev.meituan.com",or="https://verify.meituan.com",ar="dev"===x.env?ir:or,sr=function(){return"dev"===pe()?ir:"test"===pe()?"http://verify.inf.test.meituan.com":"staging"===pe()?"https://verify-test.meituan.com":or},ur=function(){return sr()+"/v2/ext_api/page_data"},cr=function(e){return sr()+"/v2/ext_api/"+e+"/info"},fr=function(e){return sr()+"/v2/ext_api/"+e+"/verify"},pr=function(){var e=sr();getApp().globalData||(getApp().globalData={}),getApp().globalData.yodaUrl=e},lr=void 0,dr=function(){try{return lr||O.wxIdsKey&&wx.getStorageSync(O.wxIdsKey)||null}catch(e){return null}},gr=(tr=s(e.mark((function t(){var n,r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lr){e.next=2;break}return e.abrupt("return",lr);case 2:if(!O.wxIdsKey){e.next=8;break}return e.next=5,z(O.wxIdsKey).catch(Ge);case 5:if(!(n=e.sent)){e.next=8;break}return e.abrupt("return",lr=n);case 8:return e.next=10,Tt();case 10:if(r=e.sent,!((null==(t=r)?void 0:t.openid)&&(null==t?void 0:t.unionid)&&(null==t?void 0:t.openidCipher))){e.next=16;break}if(!O.wxIdsKey){e.next=15;break}return e.next=15,$(O.wxIdsKey,{openId:r.openid,unionId:r.unionid,openIdCipher:r.openidCipher}).catch(Ge);case 15:return e.abrupt("return",lr={openId:r.openid,unionId:r.unionid,openIdCipher:r.openidCipher});case 16:throw new m("getwxIds 返回的数据格式不对: "+JSON.stringify(r),void 0,120);case 17:case"end":return e.stop()}var t}),t)}))),function(){return tr.apply(this,arguments)});var hr,br,wr=void 0,yr=function(){try{return wr||O.wxInfoKey&&wx.getStorageSync(O.wxInfoKey)||null}catch(e){return null}},mr=(hr=s(e.mark((function t(n){var r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),!("number"==typeof n&&n<=0)){e.next=3;break}throw new m("getWxInfo 的参数check必须大于0",void 0,121);case 3:if(!wr){e.next=5;break}return e.abrupt("return",wr);case 5:if(!O.wxInfoKey){e.next=12;break}return e.next=8,z(O.wxInfoKey).catch(Ge);case 8:if(!(r=e.sent)){e.next=12;break}if(!(!1===n||"number"==typeof n&&24*n*3600*1e3>=Date.now()-r.fetchTime)){e.next=12;break}return e.abrupt("return",r);case 12:return e.next=14,kr();case 14:return e.abrupt("return",wr=e.sent);case 15:case"end":return e.stop()}}),t)}))),function(){return hr.apply(this,arguments)}),vr=(br=s(e.mark((function t(n){var r,i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.avatarUrl||n.nickName){e.next=2;break}throw new m("updateWxInfo 传入的参数不对: "+JSON.stringify(n),void 0,122);case 2:return e.next=4,Et(n);case 4:if(!xr(r=e.sent)){e.next=11;break}if(i=Date.now(),!O.wxInfoKey){e.next=10;break}return e.next=10,$(O.wxInfoKey,Object.assign(Object.assign({},r),{fetchTime:i})).catch(Ge);case 10:return e.abrupt("return",wr=Object.assign(Object.assign({},r),{fetchTime:i}));case 11:throw new m("updateWxAppData返回的数据格式不对："+JSON.stringify(r),void 0,123);case 12:case"end":return e.stop()}}),t)}))),function(){return br.apply(this,arguments)});function xr(e){return(null==e?void 0:e.openid)&&(null==e?void 0:e.openidCipher)&&(null==e?void 0:e.unionid)}function kr(){return Or.apply(this,arguments)}function Or(){return(Or=s(e.mark((function t(){var n,r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt();case 2:if(!xr(n=e.sent)){e.next=9;break}if(r=Date.now(),!O.wxInfoKey){e.next=8;break}return e.next=8,$(O.wxInfoKey,Object.assign(Object.assign({},n),{fetchTime:r})).catch(Ge);case 8:return e.abrupt("return",Object.assign(Object.assign({},n),{fetchTime:r}));case 9:throw new m("getWxAppData返回的数据格式不对: "+JSON.stringify(n),void 0,124);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Ir,_r=void 0,Cr=function(){try{return _r||O.mtInfoKey&&wx.getStorageSync(O.mtInfoKey)||null}catch(e){return null}},Sr=(Ir=s(e.mark((function t(n,r){var i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=!0),!_r){e.next=3;break}return e.abrupt("return",_r);case 3:if(!O.mtInfoKey){e.next=19;break}return e.next=6,z(O.mtInfoKey).catch(Ge);case 6:if(!(i=e.sent)){e.next=19;break}if(!(!1===r||"number"==typeof r&&24*r*3600*1e3>Date.now()-i.fetchTime)){e.next=12;break}return e.abrupt("return",i);case 12:if("number"!=typeof r||void 0!==n){e.next=14;break}return e.abrupt("return",null);case 14:if(n){e.next=16;break}throw new m("getMtInfo 将要从后端获取数据，但token未传",void 0,115);case 16:return e.next=18,jr(n);case 18:return e.abrupt("return",_r=e.sent);case 19:if(void 0!==n){e.next=23;break}e.t0=null,e.next=26;break;case 23:return e.next=25,jr(n);case 25:e.t0=_r=e.sent;case 26:return e.abrupt("return",e.t0);case 27:case"end":return e.stop()}}),t)}))),function(){return Ir.apply(this,arguments)});function jr(){return Pr.apply(this,arguments)}function Pr(){return(Pr=s(e.mark((function t(n){var r,i;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lt(n);case 2:if(!Tr(r=e.sent)){e.next=9;break}if(i=Date.now(),!O.mtInfoKey){e.next=8;break}return e.next=8,$(O.mtInfoKey,Object.assign(Object.assign({},r),{fetchTime:i})).catch(Ge);case 8:return e.abrupt("return",Object.assign(Object.assign({},r),{fetchTime:i}));case 9:throw new m("getMtUserInfo返回的数据格式不对: "+JSON.stringify(r),void 0,116);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Tr(e){return(null==e?void 0:e.username)&&(null==e?void 0:e.id)}var Er,Rr,Lr,Ur,Nr,Ar,Dr=(Er=s(e.mark((function t(n,r){var i,o,a,s;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.username,o=r.avatar,n&&(i||o)){e.next=3;break}throw new m("updateMtInfo 参数传递错误",void 0,117);case 3:return e.next=5,Ut(n,{username:i,avatar:o});case 5:if(!Tr(a=e.sent)){e.next=12;break}if(s=Date.now(),!O.mtInfoKey){e.next=11;break}return e.next=11,$(O.mtInfoKey,Object.assign(Object.assign({},a),{fetchTime:s})).catch(Ge);case 11:return e.abrupt("return",_r=Object.assign(Object.assign({},a),{fetchTime:s}));case 12:throw new m("updateMtUserInfo 返回的数据格式不对: "+JSON.stringify(a)+" ",void 0,118);case 13:case"end":return e.stop()}}),t)}))),function(){return Er.apply(this,arguments)}),Br=function(e){return Le(ur(),{method:"POST",data:{requestCode:e},type:"form"}).then((function(t){var n=t.status,r=t.error;if(0===n&&r)throw new y(ur(),r,JSON.stringify({requestCode:e}));return t}))},Fr=function(e,t){var n=Object.assign(t,{});return 4===n.id&&(n.moduleEnable=!0),Le(cr(e),{method:"POST",data:n,type:"form"})},Kr=function(e,t){if(40===t.id){t.voicecode=t.smscode;try{delete t.smscode}catch(e){}}var n=Object.assign(t,{}),r=fr(e);return Le(r,{method:"POST",data:n,type:"form"}).then((function(e){var t=e.status,i=e.error;if(0===t&&i)throw new y(r,i,JSON.stringify(n));return e}))},Mr=require("./zb.js"),Wr=(Rr=s(e.mark((function t(n){var r,i,o,a,s,u,c,f,p;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.risk_platform,i=n.risk_partner,o=n.risk_app,a=n.token,s=n.uuid,u=n.sdkVersion,c=n.version_name,f={risk_platform:r,risk_partner:i,risk_app:o,version_name:c,sdkVersion:u},e.t0=a,e.next=5,je(s);case 5:return e.t1=e.sent,e.next=8,Ee();case 8:return e.t2=e.sent,p={token:e.t0,uuid:e.t1,wechatFingerprint:e.t2},e.abrupt("return",Le(ze("smartcheck"),{method:"post",type:"form",query:f,data:p}).then((function(e){var t=e.error;if(t.data)return t.data;throw new y(ze("smartcheck"),t,JSON.stringify({query:f,data:p}))})));case 11:case"end":return e.stop()}}),t)}))),function(){return Rr.apply(this,arguments)}),qr=(Lr=s(e.mark((function t(n){var r,i,o,a,s,u,c,f,p,l,d,g;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.mobile,i=n.countryCode,o=void 0===i?86:i,a=n.token,s=n.confirm,u=void 0===s?0:s,c=n.requestCode,f=n.ticket,p=n.responseCode,l=n.uuid,e.next=3,je(l);case 3:return e.t0=e.sent,d={uuid:e.t0},g={mobile:r,countryCode:o,token:a,confirm:u,ticket:f},c&&(g.requestCode=c),c&&(g.responseCode=p),e.abrupt("return",Le(ze("sendnewcode"),{method:"post",type:"form",query:d,data:g}).then((function(e){var t=e.error;if(t.data)return t.data;throw new y(ze("sendnewcode"),t,JSON.stringify({query:d,data:g}))})));case 9:case"end":return e.stop()}}),t)}))),function(){return Lr.apply(this,arguments)}),Vr=(Ur=s(e.mark((function t(n){var r,i,o,a,s,u,c,f,p,l,d,g,h,b,w,m,v;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.mobile,i=n.token,o=n.requestCode,a=n.responseCode,s=n.ticket,u=n.risk_platform,c=n.risk_partner,f=n.risk_app,p=n.version_name,l=n.sdkVersion,d=n.uuid,g=n.token_id,h=void 0===g?"":g,b=n.device_type,w=n.device_os,e.next=3,je(d);case 3:return e.t0=e.sent,e.t1=u,e.t2=c,e.t3=f,e.t4=p,e.t5=l,e.t6=h,m={uuid:e.t0,risk_platform:e.t1,risk_partner:e.t2,risk_app:e.t3,version_name:e.t4,sdkVersion:e.t5,token_id:e.t6},e.t7=r,e.t8=o,e.t9=i,e.t10=s,e.next=17,Ee();case 17:return e.t11=e.sent,e.t12=b,e.t13=w,v={mobile:e.t7,requestCode:e.t8,token:e.t9,ticket:e.t10,wechatFingerprint:e.t11,device_type:e.t12,device_os:e.t13},a&&(v.responseCode=a),e.abrupt("return",Le(ze("verifynew"),{method:"post",type:"form",query:m,data:v}).then((function(e){var t=e.data,n=e.error;if(t)return t;throw new y(ze("sendnewcode"),n,JSON.stringify({query:m,data:v}))})));case 23:case"end":return e.stop()}}),t)}))),function(){return Ur.apply(this,arguments)}),Jr=(Nr=s(e.mark((function t(n,r){var i,o,a,s,u,c,f,p;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.code,e.next=3,X(i);case 3:return o=e.sent,e.next=6,ae({withCredentials:!0});case 6:return a=e.sent,s=a.rawData,u=a.signature,c=a.iv,f=a.encryptedData,e.next=13,Le(ze("updatewxuserinfo"),{method:"POST",type:"form",data:{appName:n,code:o,iv:c,encryptedData:f,rawData:s,signature:u}});case 13:if(!(p=e.sent).uniqueid){e.next=16;break}return e.abrupt("return",p);case 16:throw new y(ze("updatewxuserinfo"),p.error);case 17:case"end":return e.stop()}}),t)}))),function(){return Nr.apply(this,arguments)}),Gr=function(e){return Jr(O.appName,e||{})},Hr=(Ar=s(e.mark((function t(n){var r;return e.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le(ze("getwxuserinfo"),{method:"GET",data:Object.assign(Object.assign({},n),{thirdType:"weixin"})});case 2:if(!(r=e.sent).uniqueid){e.next=5;break}return e.abrupt("return",r);case 5:throw new y(ze("getwxuserinfo"),r.error);case 6:case"end":return e.stop()}}),t)}))),function(){return Ar.apply(this,arguments)})},769:function(e){e.exports={route:"/login",env:"",api:"",promise:null,showModal:{confirmColor:"#3cc51f",confirmText:"确定"},appConfig:{appName:"group",risk_app:-1,risk_platform:0,risk_partner:0,risk_smsTemplateId:0,risk_smsPrefixId:0,persistKey:"logindata",version_name:"",_errorReport:!1,onPageErr:null,get errorReport(){return this._errorReport},set errorReport(e){this._errorReport=e},get wxIdsKey(){return this.persistKey&&"loginsdk-"+this.persistKey+"-wxIds"},set wxIdsKey(e){},get wxInfoKey(){return this.persistKey&&"loginsdk-"+this.persistKey+"-wxInfo"},set wxInfoKey(e){},get mtInfoKey(){return this.persistKey&&"loginsdk-"+this.persistKey+"-mtInfo"},set mtInfoKey(e){}},entryPageOption:{title:"登录",imageSrc:"https://p0.meituan.net/travelcube/d8ebb44535845a44e183929eaba1cb0724896.png",imageMode:"aspectFit",wxLoginText:"微信用户一键登录",wxLoginStyle:"background-image: -webkit-linear-gradient(left top, #FFD000, #FFBD00); color: #222;border:none",mobileLoginText:"手机号码登录/注册",mobileLoginStyle:"color:#5e729a"},bindPageOption:{title:"绑定手机",sendCodeActiveStyle:"color: #FE8C00",loginActiveStyle:"background-image: -webkit-linear-gradient(left top, #FFD000, #FFBD00); color: #222",loginText:"登录",voiceTipText:"账号风险提示：我们检测到您的账户有风险，会向您发送语音验证码，请在接听后将验证码输入完成账号验证",voiceTipStyle:"color: red"},authrizePageOption:{tipText:"请完成微信授权以继续使用",btn:{style:"background-image: -webkit-linear-gradient(left top, #FFD000, #FFBD00); color: #222;border:none",text:"授权微信用户信息"},imageSrc:"https://p0.meituan.net/travelcube/d8ebb44535845a44e183929eaba1cb0724896.png",imageMode:"aspectFit"},changeBindPageOption:{getNewCodeBtnText:"获取验证码",getNewCodeBtnStyle:"background-image: -webkit-linear-gradient(left top, #FFD000, #FFBD00); color: #222;border:none",sendCodeBtnText:"获取验证码",sendCodeBtnStyle:"color: #FE8C00",changeBtnText:"立即更换",changeBtnStyle:"background-image: -webkit-linear-gradient(left top, #FFD000, #FFBD00); color: #222;border:none"},tips:{smsCodeSent:"验证码已发送",logining:"登录中...",loginSuccess:"登录成功",loginParamLoss:"验证信息丢失，请重新发送验证码！",relogin:"您已登录，是否重新登录？",refuseUserInfoAuth:"您已拒绝授权用户信息，请重新点击并授权！",refusePhoneNumberAuth:"您已拒绝授权，请重新点击并授权！",verifyFailed:"验证失败",networkTimeout:"网络连接超时，请重试",illegalVerifyType:"验证方式id不合法，请重试或联系客服",illegalPhoneNumber:"手机号输入不正确，请重新输入",illegalSmsCode:"请输入正确的6位验证码",illegalAuthInfo:"获取的授权信息不正确，请重试",twiceVerifyFail:"二次验证失败，",changeBindFail:"换绑失败，请稍后重试",changeBindSucc:"换绑成功！",noConfirm:"请阅读并勾选底部协议",unlockAccount:"由于您的账号近期存在异常操作，为确保账号安全，已将账号锁定，请去美团app解锁"},protocolConfig:{show:!0,style:"color: #999",preText:"登录代表您已同意",separator:"、",protocolList:[{id:"userprotocol",url:"https://portal-portm.meituan.com/webpc/protocolmanage/userprotocol",text:"美团用户协议",style:"color: #FE8C00; display: inline-block"},{id:"privacy",url:"https://portal-portm.meituan.com/webpc/protocolmanage/privacy",text:"隐私协议",style:"color: #FE8C00; display: inline-block"}]}}},0:function(e){var t,n=(t={},[{paths:{updatewxuserinfo:"/user/thirdinfo/updateweappuserinfo",getmtuserinfo:"/user/v1/info",getwxinfo:"/user/thirdinfo/getweappuserinfo",updatewxinfo:"/user/thirdinfo/updateweappuserinfo",getwxuserinfo:"/user/thirdinfo/getwechatuserinfo",updatemtuserinfo:"/user/settings",wxmobilelogin:"/user/v2/weappgetmobilelogin",wxlogin:"/user/v2/weapplogin",wxbindapply:"/user/v2/weappbindmobileloginapply",wxbind:"/user/v2/weappbindmobilelogin",wxticketlogin:"/user/v2/weappticketlogin",wxslientlogin:"/user/v1/weappsilentlogin",smartcheck:"/user/v3/riskcheck",sendnewcode:"/user/v3/sendnew",verifynew:"/user/v4/verifynew",logout:"/thirdlogin/wechatapplogout",islogout:"/thirdlogin/isWechatAppLogout"},domain:{prod:"open.meituan.com",staging:"open.wpt.st.sankuai.com",dev:"open.wpt.dev.sankuai.com",test:"open.wpt.test.sankuai.com"}},{paths:{mobileloginapply:"/api/v3/account/mobileloginapply",mobilelogin:"/api/v3/account/mobilelogin",verifylogin:"/api/v1/account/verifylogin",ticketlogin:"/api/v1/account/ticketlogin"},domain:{prod:"passport.meituan.com",staging:"passport.wpt.st.sankuai.com",dev:"passport.wpt.dev.sankuai.com",test:"passport.wpt.test.sankuai.com"}}].forEach((function(e){Object.keys(e.domain).forEach((function(n){Object.keys(e.paths).forEach((function(r){var i;null!==(i=t[n])&&void 0!==i||(t[n]={}),t[n][r]=("prod"===n?"https://":"http://")+e.domain[n]+e.paths[r]}))}))})),t);e.exports=n},778:function(){String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e})}},o={};function a(e){if(o[e])return o[e].exports;var t=o[e]={exports:{}};return i[e](t,t.exports,a),t.exports}return a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(52)}());