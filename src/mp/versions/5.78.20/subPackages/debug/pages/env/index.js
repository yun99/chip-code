var{internal_safe_get:e,internal_get_original:t,internal_inline_style:s,getElementById:n,propsManager:a,genCompid:o,genLoopCompid:i}=require("../../gt.js"),l=Object.create,c=Object.defineProperty,r=Object.defineProperties,u=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,g=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,w=(e,t)=>{for(var s in t||(t={}))v.call(t,s)&&h(e,s,t[s]);if(d)for(var s of d(t))y.call(t,s)&&h(e,s,t[s]);return e},_=e=>c(e,"__esModule",{value:!0}),M=e=>((e,t,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of m(t))v.call(e,n)||"default"===n||c(e,n,{get:()=>t[n],enumerable:!(s=u(t,n))||s.enumerable});return e})(_(c(null!=e?l(g(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);((e,t)=>{for(var s in _(e),t)c(e,s,{get:t[s],enumerable:!0})})(exports,{default:()=>D});var b=M(require("../../gu.js")),f=M(require("../../gy.js")),E=require("../../../../er.js"),{catReq2promiseify:S}=require("../../../../gi.js"),j=getApp(),D=class extends f.default{constructor(){super(...arguments),this.$usedState=["anonymousState__temp","anonymousState__temp2","anonymousState__temp3","anonymousState__temp4","envInfo","loopArray0","titleStyle","env","isDebug","testEnvUseHttps","isProd","swimlane","appMock","dynamicEnv","dynamicProject"],this.customComponents=[]}_constructor(){this.state={isProd:!0,env:"",swimlane:"",isDebug:!0,envInfo:{groupId:4,groupName:"小象事业部",commonEnvList:[]},testEnvUseHttps:!1,appMock:"",dynamicEnv:"",dynamicProject:""},this.$$refs=[]}changeEnv(e){const{env:t,debug:s}=e.currentTarget.dataset;let{isDebug:n}=this.state;"production"===t&&(n="1"===s),j.getModule("cat").setEnv({isDevMode:"production"!==t}),this.setState({env:t,isDebug:n}),j.getModule("env").setEnv(t),j.$env.setDebug(n)}changeDynamicProject(e){e.detail.value&&this.setState({dynamicProject:e.detail.value})}changeDynamicEnv(e){e.detail.value&&this.setState({dynamicEnv:e.detail.value})}setDynamicProject(){j.getModule("env").setDynamicProject(this.state.dynamicProject||""),this.toast("设置动态化项目成功")}setDynamicEnv(){j.getModule("env").setDynamicEnv(this.state.dynamicEnv||""),this.toast("设置动态化环境成功")}changeUrl(e){j.getModule("env").setTestEnvHttps(e.detail.value),this.setState({testEnvUseHttps:e.detail.value})}changeSwimlane(e){j.getModule("cat").setEnv({isDevMode:!0}),j.getModule("env").setEnv("test"),e.detail.value?j.getModule("env").setSwimlane(e.target.dataset.swimlane):j.getModule("env").setSwimlane(""),this.setState({swimlane:e.detail.value?e.target.dataset.swimlane:""}),wx.showToast({title:"设置泳道成功"+this.state.swimlane,icon:"success",duration:2e3})}setSwimlane(){this.state.swimlane?j.getModule("env").setSwimlane(this.state.swimlane):j.getModule("env").setSwimlane(""),this.setState({swimlane:this.state.swimlane||""}),wx.showToast({title:"设置泳道成功"+this.state.swimlane,icon:"success",duration:2e3})}setAppMock(){this.state.appMock?(j.getModule("env").toggleAppMock(this.state.appMock),wx.request({url:"https://appmock.sankuai.com/mw/register?_=0__0&uid="+this.state.appMock,header:{MKUnionId:j.$uuid},success:()=>{wx.showToast({title:"设置appmock成功"+this.state.appMock,icon:"success",duration:2e3})}})):wx.showToast({title:"mis必填"})}closeAppMock(){j.getModule("env").toggleAppMock()}getOnClick(){const e=this;S({url:"https://oneclick.wpt.test.sankuai.com/api/env/list"}).then((t=>{try{const a=t.data.data.commonEnv.find((e=>22===e.groupId));if(a){const t=a.commonEnvList.filter((e=>e.cargoId&&e.envName&&-1!==e.envName.indexOf("auto"))),o=a.commonEnvList.filter((e=>e.cargoId&&e.envName&&-1===e.envName.indexOf("auto")));e.setState({envInfo:(s=w({},a),n={commonEnvList:t.concat(o)},r(s,p(n)))})}else wx.showToast({title:"找不到，优选对应的onclick组",icon:"none"})}catch(e){wx.showToast({title:"获取onclick信息出错，返回重试",icon:"none"})}var s,n}),(()=>{wx.showToast({title:"获取onclick信息出错，返回重试",icon:"none"})}))}bindKeyInput(e){this.state.swimlane=e.detail.value}bindAppMockKeyInput(e){this.state.appMock=e.detail.value}onShow(){const e=j.getModule("env").getEnv(),t=j.getModule("env").getDynamicEnv(),s=j.getModule("env").getDynamicProject(),n=j.getModule("env").getAppMock(),a=j.getModule("env").getTestEnvHttps();this.getOnClick(),this.setState({isProd:j.$isProd,isDebug:j.$env.getDebug(),env:e,dynamicEnv:t,dynamicProject:s,testEnvUseHttps:a,swimlane:j.getModule("env").getSwimlane(),appMock:n})}_createData(){this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};this.$prefix;const{env:e,isDebug:s,swimlane:n,envInfo:a,testEnvUseHttps:o,appMock:i}=this.__state,l="dev"===e,c="test"===e,r="ppe"===e,u="staging"===e,p="test"===e?a.commonEnvList.map(((s,a)=>{s={$original:t(s)};return{$loopState__temp6:"test"===e?n===s.$original.cargoId:null,$original:s.$original}})):[];return Object.assign(this.__state,{anonymousState__temp:l,anonymousState__temp2:c,anonymousState__temp3:r,anonymousState__temp4:u,loopArray0:p,titleStyle:"color:#53b348; font-weight:700;"}),this.__state}};D.$$events=[],D.$$componentPath="Users/lyp/Documents/me/meituan/git/youxuan/mall-dyapp/src/subPackages/debug/pages/env/index",E(b.createPage(D));