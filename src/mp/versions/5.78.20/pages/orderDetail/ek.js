var e=Object.create,t=Object.defineProperty,a=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,n=n=>{return((e,i,n)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of r(i))o.call(e,s)||"default"===s||t(e,s,{get:()=>i[s],enumerable:!(n=a(i,s))||n.enumerable});return e})((s=t(null!=n?e(i(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0}),t(s,"__esModule",{value:!0})),n);var s},s=n(require("../../ob.js")),l=n(require("../../p0.js"));Component({properties:{mapInfo:{type:Object,value:{},observer(e){if(s.log.info("地图map,observer",e),e){s.log.info("地图map,observer 进入判断");const t={latitude:e.addressLatitude,longitude:e.addressLongitude},a=e.riderTraces[0];this.mapData={centerLatitude:a.latitude,centerLongitude:a.longitude,"markers[1].latitude":t.latitude,"markers[1].longitude":t.longitude,"markers[0].latitude":a.latitude,"markers[0].longitude":a.longitude},this.isReady?(s.log.info("地图map this.isReady为true"),this.init()):s.log.info("地图map this.isReady为false")}}},driverInfo:{type:Object,value:{},observer(e){e&&(s.log.info("地图map,driverInfo.observer 进入判断"),this.setDriverMarkerInfo(e))}}},data:{ebableScroll:!0,scale:14,centerLatitude:null,centerLongitude:null,markers:[{id:1,latitude:null,longitude:null,title:"骑手位置"},{id:2,latitude:null,longitude:null,title:"收货地址"}],includePoints:[],controls:[],isRefreshIconLoadFail:!1},attached(){this.setUserMarkerInfo()},ready(){s.log.info("地图map 执行ready",this.data),this.isReady=!0,this.mapData?(s.log.info("地图map 有this.mapData",this.mapData),this.init()):s.log.info("地图map 无this.mapData",this.mapData)},detached(){this.isReady=!1,clearTimeout(this.timer)},methods:{init(){s.log.info("地图map 执行this.init",this.data),this.timer=setTimeout((()=>{this.setData(this.mapData,(()=>{s.log.info("地图map,observer setData完成",this.data)}))}),100)},regionchange(e){},markertap(e){},refreshMap(){this.triggerEvent("refresh",{})},setDriverMarkerInfo(e){const t=(0,l.getImageTempFilePathAsync)("https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/deliver_icon3.f6a5209.png"),a=(0,l.getImageTempFilePathAsync)("https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/driverless_icon.b6bd227.png");Promise.all([t,a]).then((t=>{var a,r;this.setData({"markers[0].iconPath":e.driverLessTransport?(null==(a=t[1])?void 0:a.tempFilePath)||"":(null==(r=t[0])?void 0:r.tempFilePath)||"","markers[0].width":(0,l.convertRpxToPx)(374),"markers[0].height":(0,l.convertRpxToPx)(156),"markers[0].title":""})})).catch((()=>{this.setData({"markers[0]":{id:1,latitude:null,longitude:null,width:(0,l.convertRpxToPx)(56),height:(0,l.convertRpxToPx)(56),iconPath:"/images/t-yx/map-default-green-dot.png",callout:{content:e.driverLessTransport?"无人车正在送货":"骑手正在送货",color:"#585D66",fontSize:(0,l.convertRpxToPx)(26),borderRadius:(0,l.convertRpxToPx)(20),borderColor:"#ffffff",bgColor:"#ffffff",padding:(0,l.convertRpxToPx)(24),textAlign:"center",display:"ALWAYS",anchorY:(0,l.convertRpxToPx)(20)}}})}))},setUserMarkerInfo(){(0,l.getImageTempFilePathAsync)("https://s3plus.meituan.net/v1/mss_1f3dca8fe8534e6fa640054bf3ad2ba6/grocery-fe-cdn/wx/images/cdn/user_165_191.905c826.png").then((e=>{this.setData({"markers[1].iconPath":e.tempFilePath||"","markers[1].width":(0,l.convertRpxToPx)(110),"markers[1].height":(0,l.convertRpxToPx)(126),"markers[1].title":""})})).catch((()=>{this.setData({"markers[1]":{id:2,latitude:null,longitude:null,width:(0,l.convertRpxToPx)(56),height:(0,l.convertRpxToPx)(56),iconPath:"/images/t-yx/map-default-red-dot.png",callout:{content:"收货地址",color:"#585D66",fontSize:(0,l.convertRpxToPx)(26),borderRadius:(0,l.convertRpxToPx)(20),borderColor:"#ffffff",bgColor:"#ffffff",padding:(0,l.convertRpxToPx)(24),textAlign:"center",display:"ALWAYS",anchorY:(0,l.convertRpxToPx)(20)}}})}))},onRefreshIconLoadFail(){this.setData({isRefreshIconLoadFail:!0})}}});