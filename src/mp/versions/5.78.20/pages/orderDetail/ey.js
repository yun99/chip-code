var e=Object.create,t=Object.defineProperty,a=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,s=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,n=n=>{return((e,s,n)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let c of r(s))o.call(e,c)||"default"===c||t(e,c,{get:()=>s[c],enumerable:!(n=a(s,c))||n.enumerable});return e})((c=t(null!=n?e(s(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0}),t(c,"__esModule",{value:!0})),n);var c},c=n(require("../../jc.js")),l=n(require("./g1.js")),i=n(require("./g4.js")),u=n(require("./he.js")),d=getApp();(0,c.defineComponent)({properties:{orderId:{type:String,value:""},orderInfo:{type:Object,value:{}},skus:{type:Object,value:{}},orderStatus:{type:Number,value:null},showCancelOrder:{type:Boolean},switchBar:{type:Boolean},orderReverseReasons:{type:Array,value:[]},tempSelectedFirstReason:{type:Object,value:{}},tempSelectedFirstCode:{type:String,value:""},switchLabelChecked:{type:Boolean,value:!1},isSwitchLabelShow:{type:Boolean,value:!0},switchLabelFrom:{type:String,value:l.FROM.REFUND_APPLY}},methods:{onPopupClose(){const e=d.page();this.setData({showCancelOrder:!1}),e&&e.setData({cancelOrderReasonPopup:!1})},onSelectFirstReason(e){const{selectFirstReason:t}=e.currentTarget.dataset;this.handleSwitchLabelChecked(),this.setData({tempSelectedFirstReason:t})},onSwitchLabelChange(e){const{switchVal:t}=e.detail;this.setData({switchLabelChecked:t}),d.$lxLog.mc("b_youxuan_hbs2kdku_mc",{order_id:this.data.orderId,order_st:this.data.orderStatus,button_type:t?1:0}),(0,i.getSingleInstance)().set(t)},handleSwitchLabelChecked(e=!0){const{isSwitchLabelShow:t}=this.data,a=(0,i.getSingleInstance)().get();t&&e!==this.data.switchLabelChecked&&a&&this.setData({switchLabelChecked:e})},handleReasonOk(){return e=this,t=null,a=function*(){const{orderId:e}=this.data,{tempSelectedFirstReason:t}=this.data,{firstReason:a}=t,{firstCode:r}=t;if(!t.firstCode)return void d.page().toast("请选择取消原因");const s={orderId:e,firstReason:a,firstCode:r};try{yield(0,u.closeOrder)(s)}catch(t){d.page().refreshOrder(e)}const o=(0,i.getSingleInstance)().get();d.$lxLog.mc("b_youxuan_jp29rtuh_mc",{order_id:this.data.orderId,order_st:this.data.orderStatus,button_type:o?1:0}),o&&this.data.switchBar&&this.operateCart(),this.onPopupClose(),d.page().refreshOrder(e)},new Promise(((r,s)=>{var o=e=>{try{c(a.next(e))}catch(e){s(e)}},n=e=>{try{c(a.throw(e))}catch(e){s(e)}},c=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,n);c((a=a.apply(e,t)).next())}));var e,t,a},operateCart(){const e=[],t=[];for(let a=0;a<=this.data.skus.length-1;a++)e.push(this.data.skus[a].skuId),t.push(this.data.skus[a].count);let a={};const r=[];for(let a=0;a<=e.length-1;a++){const s={skuId:e[a],count:t[a]};r.push(s)}a={opTargets:r};const s="REFUNDAPPLY";return d.$cart.operateCart({requestSource:s,cartOpType:"INCREASE",cartOpSource:"REFUNDAPPLY",forceRefresh:!0,opTarget:a})},mvHandler(e){const{bid:t="",lxParams:a={}}=e.detail;d.$lxLog.mv(t,a)}}});