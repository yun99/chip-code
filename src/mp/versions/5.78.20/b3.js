var e,t,r=Object.create,n=Object.defineProperty,s=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,c=(e=require("./u6.js"),((e,t,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let a of u(t))o.call(e,a)||"default"===a||n(e,a,{get:()=>t[a],enumerable:!(r=s(t,a))||r.enumerable});return e})((t=n(null!=e?r(a(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0}),n(t,"__esModule",{value:!0})),e)),{CAT_SEC_CATEGORY:i}=require("./iu.js"),l=getApp(),y=null;function p(){return y||(y=wx.getStorageSync("_"))}function f(e){y=e,wx.setStorage({key:"_",data:e,success(){}})}function g(e,t){const r=getApp();r&&r.$cat.reportError(i.STORAGE_OFF_LIMIT(`key为'${e}'的storage存储超过1MB\n内容为: \n${JSON.stringify(t)}\n`)),r&&r.$cat.reportAllErrorRightNow()}function m(e){let t=p();"object"!=typeof t&&(t={keys:[]}),t.keys=t.keys||[];const r=t.keys.indexOf(e);-1!==r&&t.keys.splice(r,1);try{f(t),null==wx||wx.removeStorageSync(e)}catch(e){}}function x(e){if(e){let t=wx.getStorageSync(e);if(t&&t.expires){if(t.timestamp+1e3*t.expires<new Date)return m(e),"";t=t.value}return t}return((p()||{}).keys||[]).reduce(((e,t)=>(e[t]=x(t),e)),{})}function O(e,t,r){const n=r&&r.expires||7776e3,s=r&&r.count||-1,u=p()||{},a=r&&r.timestamp||+new Date,o=r&&r.currentCount||0;if(u.keys=u.keys||[],null===e)wx.clearStorage(),u.keys=[];else{if(!e)return l;-1===u.keys.indexOf(e)&&u.keys.push(e),n&&(t={value:t,expires:n,timestamp:a,count:s,currentCount:o});try{(0,c.sizeOf)(JSON.stringify(t))>=c.M_BYTE&&g(e,t),wx.setStorage({key:e,data:t,success(){},fail(e){}})}catch(e){return l}}u.timestamp=+new Date;try{(0,c.sizeOf)(JSON.stringify(u))>=c.M_BYTE&&g("_",u),f(u)}catch(e){}return l}module.exports={getMeta:p,setMeta:f,getItemObj:function e(t){if(t){const e=wx.getStorageSync(t);return e&&e.expires&&e.timestamp+1e3*e.expires<new Date?(m(t),""):e}return((p()||{}).keys||[]).reduce(((t,r)=>(t[r]=e(r),t)),{})},getItem:x,setItem:O,updateItem:function(e,t){let r=wx.getStorageSync(e);return r&&r.expires?r.value=t:r=t,wx.setStorageSync(e,r),l},removeItem:m,storage:function(e,t){return 2===arguments.length?O(e,t):x(e)}};