var e=Object.create,t=Object.defineProperty,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,n=Object.getPrototypeOf,r=Object.prototype.hasOwnProperty,i=e=>t(e,"__esModule",{value:!0}),p=p=>((e,n,i)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let p of a(n))r.call(e,p)||"default"===p||t(e,p,{get:()=>n[p],enumerable:!(i=o(n,p))||i.enumerable});return e})(i(t(null!=p?e(n(p)):{},"default",p&&p.__esModule&&"default"in p?{get:()=>p.default,enumerable:!0}:{value:p,enumerable:!0})),p);((e,o)=>{for(var a in i(e),o)t(e,a,{get:o[a],enumerable:!0})})(exports,{default:()=>l});var s=p(require("./ob.js")),u=p(require("./kh.js")),c=getApp(),l=class{constructor(){this.attached=function(){this.currentPage=c.page().route||""},this.methods={onSkuStatusChange(e){this.operatePopupCart((null==e?void 0:e.detail)||{})},onReachBottom(e){},onSkuTouchStart(e){this.setData({startTouch:e.detail})},onSkuTouchEnd(e){this.setData({currentTouchNodeId:e.detail.currentTouchNodeId,skuId:e.detail.skuId})},onCheapBuyPopupShow(e){this.setData({isCheapBuyPopupShow:!0,promotionId:e.detail.promotionId||0,promotionType:e.detail.promotionType||0,promotionHandel:e.detail.promotionHandel||""});const t=c.page().route||"";u.tabPage[t]&&wx.hideTabBar({animation:!0})},onCheapBuyPopupClose(e){this.setData({isCheapBuyPopupShow:!1});const t=c.page().route||"";u.tabPage[t]&&wx.showTabBar({animation:!0})},onCommonOperateCart(e){this.operatePopupCart(e.detail)},onViewScroll(e){var t,o;const{scrollTop:a}=e.detail,n=(null==(o=null==(t=c.getModule("systemInfo"))?void 0:t.systemInfo)?void 0:o.screenHeight)||667,r=a>2*n;try{wx.createSelectorQuery().select("#basicInfo").boundingClientRect((e=>{e&&this.data.setIsShowConfrimPayment(a>e.height)})).exec(),this.checkShowViewPriceBtn()}catch(e){s.log.warn("[submitCart] #basicInfo createSelectorQuery",e)}r!==this.data.isShowReturnTopBtn&&this.setData({isShowReturnTopBtn:r})},getBackTop(){this.setData({topNum:0})},toIndex(){c.$router.goto("/pages/index/index")},toShowCouponDetail(e){this.onCouponPopupHandle()},onPullDownRefresh(){var e;this.setData({isRefreshing:!0}),null==(e=this.operatePopupCart())||e.then((()=>{this.setData({isRefreshing:!1})}))},scrollToPriceInfo(){wx.createSelectorQuery().select("#priceInfo").boundingClientRect((e=>{e&&this.setData({showViewPriceBtn:!1,topNum:e.top})})).exec()},checkShowViewPriceBtn(){const e=wx.createSelectorQuery();e.select("#cart-mid").boundingClientRect(),e.select("#priceInfo").boundingClientRect(),e.exec((([e,t])=>{let o=!1;e&&t&&(o=t.top>e.height),o!==this.data.showViewPriceBtn&&this.setData({showViewPriceBtn:o})}))},canOperateCart(){return this.data.canOperateCart&&this.data.canOperateCart()},operatePopupCart(e){return this.data.operatePopupCart&&this.data.operatePopupCart(e)},onCouponPopupHandle(){return this.data.onCouponPopupHandle&&this.data.onCouponPopupHandle()}},this.options={multipleSlots:!0},this.properties={card:{type:Array,value:[],observer(){this.checkShowViewPriceBtn()}},operatePopupCart:{type:Function},onCouponPopupHandle:{type:Function},canOperateCart:{type:Function},setIsShowConfrimPayment:{type:Function}},this.data={startTouch:{},currentTouchNodeId:"",skuId:0,isCheapBuyPopupShow:!1,promotionId:0,promotionType:0,promotionHandel:"",isShowReturnTopBtn:!1,topNum:0,isLogin:!1}}};Component(new l);