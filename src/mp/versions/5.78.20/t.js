var t,e,o=Object.create,a=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,d=(t=require("./la.js"),((t,e,o)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of i(e))s.call(t,n)||"default"===n||a(t,n,{get:()=>e[n],enumerable:!(o=r(e,n))||o.enumerable});return t})((e=a(null!=t?o(n(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0}),a(e,"__esModule",{value:!0})),t)),u=getApp();Component(new class{constructor(){this.attached=function(){this.cart=u.page().selectComponent("#cart"),this.setData({nodeId:this.__wxExparserNodeId__||String(this.__$id)})},this.methods={onSkuCountChange(t){var e,o;if(this.cart||(this.cart=u.page().selectComponent("#cart")),!this.cart.canOperateCart())return;const{skuId:a,delType:r}=(null==(e=null==t?void 0:t.currentTarget)?void 0:e.dataset)||{},{type:i,count:n}=(null==t?void 0:t.detail)||{},s={add:"INCREASE",subtract:"DECREASE",delete:"DELETE",giftDelete:"DELETE_GIFT"};if("subtract"===i&&1===n||r)r&&!this.data.canSelect&&d.default.onGiftClick({index_id:this.data.index,sale_price:(null==(o=this.data.skuItems)?void 0:o.finalPrice)||0,sku_id:a}),d.default.deletePopupShow(),u.page().confirm({message:"确定要删除该商品吗？",textCancel:"再想想",textOK:"删除",zIndex:1510,ok:()=>{d.default.deleteConfirm(),this.triggerEvent("skuStatusChange",{cartOpType:s[i]||s[r],opTarget:{opTargets:[{skuId:a,promotionId:this.data.promotionId,promotionType:this.data.promotionType}]}})},cancel:()=>{d.default.deleteCancel()}});else{const t="add"===i?"b_youxuan_u6mw9i0v_mc":"b_youxuan_kwwwhgxo_mc";u.$lxLog.mc(t,{sku_id:a}),this.triggerEvent("skuStatusChange",{cartOpType:s[i],opTarget:{opTargets:[{skuId:a,promotionId:this.data.promotionId,promotionType:this.data.promotionType}]}})}},onSkuSelectClick(t){var e;if(this.cart||(this.cart=u.page().selectComponent("#cart")),!this.cart.canOperateCart())return;const{skuId:o,selected:a}=(null==(e=null==t?void 0:t.target)?void 0:e.dataset)||{};if(void 0===o||void 0===a)return Promise.reject(`选中商品id为空，或者选中值为空，skuId：${o}，selected：${a}`);this.triggerEvent("skuStatusChange",{cartOpType:a?"INVERT":"SELECT",opTarget:{opTargets:[{skuId:o,promotionId:this.data.promotionId,promotionType:this.data.promotionType}]}})},onSkuTouchStart(t){var e;if(!this.data.canSelect||this.isDeleteFirstShow){const{index:t,skuItems:e,skuId:o}=this.data;d.default.onGiftShow({index_id:t,sale_price:(null==e?void 0:e.finalPrice)||0,sku_id:o}),this.isDeleteFirstShow=!1}if(!t.touches)return void this.triggerEvent("onSkuTouchStart",null==(e=t.detail)?void 0:e.detail);const o=t.touches[0];this.triggerEvent("onSkuTouchStart",{nodeId:this.data.nodeId,clientX:o.clientX,clientY:o.clientY})},onSkuTouchEnd(t){var e;u.page();if(!t.touches)return void this.triggerEvent("onSkuTouchEnd",null==(e=t.detail)?void 0:e.detail);const{startTouch:o,nodeId:a}=this.data;if(a!==o.nodeId)return;let r="";t.changedTouches[0].clientX<o.clientX-50&&(r=a),this.triggerEvent("onSkuTouchEnd",{currentTouchNodeId:r,skuId:t.currentTarget.dataset.skuId})},toSkuDetail(t){const{skuId:e}=t.currentTarget.dataset;d.default.onNormalCardClick(e);const o={originalPoiId:u.$poiId,skuId:e,poiIdStr:u.$poiIdStr||""},{trafficSource:a}=u.page().options;a&&(o.trafficSource=a),u.$router.goto("/pages/skuDetail/index",o)},onCardMvReport(t){const{skuId:e}=t.detail.lxParams;d.default.onNormalCardShow(e)},onPromotionLimitMvReport(t){const{skuId:e}=t.detail.lxParams,{message:o}=t.detail.lxParams;d.default.onPromotionLimitShow(e,o)},onWalkReturnMoneyInfoMvReport(){d.default.onWalkReturnMoneyInfoShow()}},this.properties={startTouch:Object,currentTouchNodeId:String,skuId:Number,skuItems:{type:Object},promotionId:{type:Number,value:0},promotionType:{type:String,value:""},canSelect:{type:Boolean,value:!0},index:{type:Number}},this.data={isSelected:!1,fontRate:u.$cart.getCartFontRate()||1},this.isDeleteFirstShow=!0}});