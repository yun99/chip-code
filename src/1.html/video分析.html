<!DOCTYPE html>
<html>
<head>
    <title>视频分析工具</title>
    <style>
        #resultTable {
            width: 100%;
            border-collapse: collapse;
        }
        #resultTable th, #resultTable td {
            border: 1px solid black;
            padding: 5px;
        }
    </style>
</head>
<body>
    <h1>视频分析工具</h1>
    <input type="file" id="videoFile" accept="video/*">
    <br><br>
    <label for="startTime">开始时间（毫秒）：</label>
    <input type="number" id="startTime" value="0">
    <br><br>
    <button onclick="startAnalysis()">开始分析</button>
    <br><br>
    <table id="resultTable">
        <thead>
            <tr>
                <th>视频帧序号</th>
                <th>当前帧时间</th>
                <th>当前帧截图</th>
            </tr>
        </thead>
        <tbody id="resultBody">
        </tbody>
    </table>

    <script>
        function startAnalysis() {
            var videoFile = document.getElementById('videoFile').files[0];
            var startTime = parseInt(document.getElementById('startTime').value);
            var resultBody = document.getElementById('resultBody');
            resultBody.innerHTML = '';

            var video = document.createElement('video');
            video.src = URL.createObjectURL(videoFile);
            video.currentTime = startTime / 1000;

            video.addEventListener('loadeddata', function() {
                var canvas = document.createElement('canvas');
                var context = canvas.getContext('2d');
                var frameIndex = 0;

                var intervalId = setInterval(function() {
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    var imageDataUrl = canvas.toDataURL();

                    var row = document.createElement('tr');
                    var indexCell = document.createElement('td');
                    indexCell.textContent = frameIndex;
                    var timeCell = document.createElement('td');
                    timeCell.textContent = video.currentTime.toFixed(2);
                    var imageCell = document.createElement('td');
                    var image = document.createElement('img');
                    image.src = imageDataUrl;
                    imageCell.appendChild(image);

                    row.appendChild(indexCell);
                    row.appendChild(timeCell);
                    row.appendChild(imageCell);
                    resultBody.appendChild(row);

                    video.currentTime += 0.04;
                    frameIndex++;

                    if (video.currentTime >= video.duration) {
                        clearInterval(intervalId);
                    }
                }, 40);
            });
        }
    </script>
</body>
</html>